!function(c){var a;c(document).ready(function(){c.support.transition=(function(){var f=document.body||document.documentElement,g=f.style,e=g.transition!==undefined||g.WebkitTransition!==undefined||g.MozTransition!==undefined||g.MsTransition!==undefined||g.OTransition!==undefined;return e})();if(c.support.transition){a="TransitionEnd";if(c.browser.webkit){a="webkitTransitionEnd"}else{if(c.browser.mozilla){a="transitionend"}else{if(c.browser.opera){a="oTransitionEnd"}}}}});var d=function(f,e){this.$element=c(f);this.options=e;this.enabled=true;this.fixTitle()};d.prototype={show:function(){var m,f,l,e,k,g;if(this.getTitle()&&this.enabled){k=this.tip();this.setContent();if(this.options.animate){k.addClass("fade")}if(c("#twipsy-holder").length==0){c("<div />").attr("id","twipsy-holder").attr("class","ccm-ui").prependTo(document.body)}k.remove().css({top:0,left:0,display:"block"}).prependTo(c("#twipsy-holder"));m=c.extend({},this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight});f=k[0].offsetWidth;l=k[0].offsetHeight;e=b.maybeCall(this.options.placement,this.$element[0]);switch(e){case"below":g={top:m.top+m.height+this.options.offset,left:m.left+m.width/2-f/2};break;case"above":g={top:m.top-l-this.options.offset,left:m.left+m.width/2-f/2};break;case"left":g={top:m.top+m.height/2-l/2,left:m.left-f-this.options.offset};break;case"right":g={top:m.top+m.height/2-l/2,left:m.left+m.width+this.options.offset};break}k.css(g).addClass(e).addClass("in")}},setContent:function(){var e=this.tip();e.find(".twipsy-inner")[this.options.html?"html":"text"](this.getTitle());e[0].className="twipsy"},hide:function(){var f=this,g=this.tip();g.removeClass("in");function e(){g.remove()}e()},fixTitle:function(){var e=this.$element;if(e.attr("title")||typeof(e.attr("data-original-title"))!="string"){e.attr("data-original-title",e.attr("title")||"").removeAttr("title")}},getTitle:function(){var g,e=this.$element,f=this.options;this.fixTitle();if(typeof f.title=="string"){g=e.attr(f.title=="title"?"data-original-title":f.title)}else{if(typeof f.title=="function"){g=f.title.call(e[0])}}g=(""+g).replace(/(^\s*|\s*$)/,"");return g||f.fallback},tip:function(){if(!this.$tip){this.$tip=c('<div class="twipsy" />').html('<div class="twipsy-arrow"></div><div class="twipsy-inner"></div>')}return this.$tip},validate:function(){if(!this.$element[0].parentNode){this.hide();this.$element=null;this.options=null}},enable:function(){this.enabled=true},disable:function(){this.enabled=false},toggleEnabled:function(){this.enabled=!this.enabled}};var b={maybeCall:function(f,e){return(typeof f=="function")?(f.call(e)):f}};c.fn.twipsy=function(e){c.fn.twipsy.initWith.call(this,e,d,"twipsy");return this};c.fn.twipsy.initWith=function(q,m,e){var p,o,k,g;if(q===true){return this.data(e)}else{if(typeof q=="string"){p=this.data(e);if(p){p[q]()}return this}}q=c.extend({},c.fn[e].defaults,q);function f(t){var s=c.data(t,e);if(!s){s=new m(t,c.fn.twipsy.elementOptions(t,q));c.data(t,e,s)}return s}function l(){var s=f(this);s.hoverState="in";if(q.delayIn==0){s.show()}else{s.fixTitle();setTimeout(function(){if(s.hoverState=="in"){s.show()}},q.delayIn)}}function n(){var s=f(this);s.hoverState="out";if(q.delayOut==0){s.hide()}else{setTimeout(function(){if(s.hoverState=="out"){s.hide()}},q.delayOut)}}if(!q.live){this.each(function(){f(this)})}if(q.trigger!="manual"){o=q.live?"live":"bind";k=q.trigger=="hover"?"mouseenter":"focus";g=q.trigger=="hover"?"mouseleave":"blur";this[o](k,l)[o](g,n)}return this};c.fn.twipsy.Twipsy=d;c.fn.twipsy.defaults={animate:true,delayIn:0,delayOut:0,fallback:"",placement:"above",html:false,live:false,offset:0,title:"title",trigger:"hover"};c.fn.twipsy.elementOptions=function(f,e){return c.metadata?c.extend({},e,c(f).metadata()):e}}(window.jQuery||window.ender);!function(b){var a=function(d,c){this.$element=b(d);this.options=c;this.enabled=true;this.fixTitle()};a.prototype=b.extend({},b.fn.twipsy.Twipsy.prototype,{setContent:function(){var c=this.tip();c.find(".title")[this.options.html?"html":"text"](this.getTitle());c.find(".content p")[this.options.html?"html":"text"](this.getContent());c[0].className="popover"},getContent:function(){var d,c=this.$element,e=this.options;if(typeof this.options.content=="string"){d=c.attr(e.content)}else{if(typeof this.options.content=="function"){d=this.options.content.call(this.$element[0])}}return d},tip:function(){if(!this.$tip){this.$tip=b('<div class="popover" />').html('<div class="arrow"></div><div class="inner"><h3 class="title"></h3><div class="content"><p></p></div></div>')}return this.$tip}});b.fn.popover=function(c){if(typeof c=="object"){c=b.extend({},b.fn.popover.defaults,c)}b.fn.twipsy.initWith.call(this,c,a,"popover");return this};b.fn.popover.defaults=b.extend({},b.fn.twipsy.defaults,{content:"data-content",placement:"right"})}(window.jQuery||window.ender);(function(b){var a=function(){var X={},c,R=65,y,T='<div class="colorpicker"><div class="colorpicker_color"><div><div></div></div></div><div class="colorpicker_hue"><div></div></div><div class="colorpicker_new_color"></div><div class="colorpicker_current_color"></div><div class="colorpicker_hex"><input type="text" class="text" maxlength="6" size="6" /></div><div class="colorpicker_rgb_r colorpicker_field"><input type="text" class="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_rgb_g colorpicker_field"><input type="text" class="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_rgb_b colorpicker_field"><input type="text" class="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_h colorpicker_field"><input type="text" class="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_s colorpicker_field"><input type="text" class="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_b colorpicker_field"><input type="text" class="text" maxlength="3" size="3" /><span></span></div><input type="button" class="colorpicker_none" name="none" value="x" /><input type="button" class="colorpicker_submit" name="save" value="Ok" /></div>',G={eventName:"click",onShow:function(){},onBeforeShow:function(){},onHide:function(){},onNone:function(){},onChange:function(){},onSubmit:function(){},color:"ff0000",livePreview:true,flat:false},N=function(Y,aa){var Z=m(Y);b(aa).data("colorpicker").fields.eq(1).val(Z.r).end().eq(2).val(Z.g).end().eq(3).val(Z.b).end()},z=function(Y,Z){b(Z).data("colorpicker").fields.eq(4).val(Y.h).end().eq(5).val(Y.s).end().eq(6).val(Y.b).end()},g=function(Y,Z){b(Z).data("colorpicker").fields.eq(0).val(V(Y)).end()},o=function(Y,Z){b(Z).data("colorpicker").selector.css("backgroundColor","#"+V({h:Y.h,s:100,b:100}));b(Z).data("colorpicker").selectorIndic.css({left:parseInt(150*Y.s/100,10),top:parseInt(150*(100-Y.b)/100,10)})},K=function(Y,Z){b(Z).data("colorpicker").hue.css("top",parseInt(150-150*Y.h/360,10))},k=function(Y,Z){b(Z).data("colorpicker").currentColor.css("backgroundColor","#"+V(Y))},J=function(Y,Z){b(Z).data("colorpicker").newColor.css("backgroundColor","#"+V(Y))},q=function(Y){var aa=Y.charCode||Y.keyCode||-1;if((aa>R&&aa<=90)||aa==32){return false}var Z=b(this).parent().parent();if(Z.data("colorpicker").livePreview===true){e.apply(this)}},e=function(Z){var aa=b(this).parent().parent(),Y;if(!aa.data("colorpicker")||!aa.data("colorpicker").fields){return}if(this.parentNode.className.indexOf("_hex")>0){aa.data("colorpicker").color=Y=p(D(this.value))}else{if(this.parentNode.className.indexOf("_hsb")>0){aa.data("colorpicker").color=Y=f({h:parseInt(aa.data("colorpicker").fields.eq(4).val(),10),s:parseInt(aa.data("colorpicker").fields.eq(5).val(),10),b:parseInt(aa.data("colorpicker").fields.eq(6).val(),10)})}else{aa.data("colorpicker").color=Y=l(P({r:parseInt(aa.data("colorpicker").fields.eq(1).val(),10),g:parseInt(aa.data("colorpicker").fields.eq(2).val(),10),b:parseInt(aa.data("colorpicker").fields.eq(3).val(),10)}))}}if(Z){N(Y,aa.get(0));g(Y,aa.get(0));z(Y,aa.get(0))}o(Y,aa.get(0));K(Y,aa.get(0));J(Y,aa.get(0));aa.data("colorpicker").onChange.apply(aa,[Y,V(Y),m(Y)])},s=function(Z){var aa=b(this).parent().parent();var Y=aa.data("colorpicker");if(Y&&Y.fields){Y.fields.parent().removeClass("colorpicker_focus")}},O=function(){R=this.parentNode.className.indexOf("_hex")>0?70:65;var Y=b(this).parent().parent().data("colorpicker");if(Y&&Y.fields){Y.fields.parent().removeClass("colorpicker_focus")}b(this).parent().addClass("colorpicker_focus")},M=function(Y){var aa=b(this).parent().find("input").focus();var Z={el:b(this).parent().addClass("colorpicker_slider"),max:this.parentNode.className.indexOf("_hsb_h")>0?360:(this.parentNode.className.indexOf("_hsb")>0?100:255),y:Y.pageY,field:aa,val:parseInt(aa.val(),10),preview:b(this).parent().parent().data("colorpicker").livePreview};b(document).bind("mouseup",Z,x);b(document).bind("mousemove",Z,Q)},Q=function(Y){Y.data.field.val(Math.max(0,Math.min(Y.data.max,parseInt(Y.data.val+Y.pageY-Y.data.y,10))));if(Y.data.preview){e.apply(Y.data.field.get(0),[true])}return false},x=function(Y){e.apply(Y.data.field.get(0),[true]);Y.data.el.removeClass("colorpicker_slider").find("input").focus();b(document).unbind("mouseup",x);b(document).unbind("mousemove",Q);return false},B=function(Y){var Z={cal:b(this).parent(),y:b(this).offset().top};Z.preview=Z.cal.data("colorpicker").livePreview;b(document).bind("mouseup",Z,v);b(document).bind("mousemove",Z,n)},n=function(Y){e.apply(Y.data.cal.data("colorpicker").fields.eq(4).val(parseInt(360*(150-Math.max(0,Math.min(150,(Y.pageY-Y.data.y))))/150,10)).get(0),[Y.data.preview]);return false},v=function(Y){N(Y.data.cal.data("colorpicker").color,Y.data.cal.get(0));g(Y.data.cal.data("colorpicker").color,Y.data.cal.get(0));b(document).unbind("mouseup",v);b(document).unbind("mousemove",n);return false},C=function(Y){var Z={cal:b(this).parent(),pos:b(this).offset()};Z.preview=Z.cal.data("colorpicker").livePreview;b(document).bind("mouseup",Z,F);b(document).bind("mousemove",Z,u)},u=function(Y){e.apply(Y.data.cal.data("colorpicker").fields.eq(6).val(parseInt(100*(150-Math.max(0,Math.min(150,(Y.pageY-Y.data.pos.top))))/150,10)).end().eq(5).val(parseInt(100*(Math.max(0,Math.min(150,(Y.pageX-Y.data.pos.left))))/150,10)).get(0),[Y.data.preview]);return false},F=function(Y){N(Y.data.cal.data("colorpicker").color,Y.data.cal.get(0));g(Y.data.cal.data("colorpicker").color,Y.data.cal.get(0));b(document).unbind("mouseup",F);b(document).unbind("mousemove",u);return false},A=function(Y){b(this).addClass("colorpicker_focus")},U=function(Y){b(this).removeClass("colorpicker_focus")},t=function(Z){var ab=b(this).parent();var Y=ab.data("colorpicker").color;ab.data("colorpicker").origColor=Y;k(Y,ab.get(0));var aa=b("#"+b(this).data("colorpickerId"));ab.data("colorpicker").onSubmit(Y,V(Y),m(Y),ab)},W=function(Y){var Z=b(this).parent();Z.data("colorpicker").onNone(Z);Z.hide()},I=function(Y){var ac=b("#"+b(this).data("colorpickerId"));ac.data("colorpicker").onBeforeShow.apply(this,[ac.get(0)]);var ad=b(this).offset();var ab=E();var aa=ad.top+this.offsetHeight;var Z=ad.left;if(aa+176>ab.t+ab.h){aa-=this.offsetHeight+176}if(Z+356>ab.l+ab.w){Z-=356}ac.css({left:Z+"px",top:aa+"px"});if(ac.data("colorpicker").onShow.apply(this,[ac.get(0)])!=false){ac.show()}b(document).bind("mousedown",{cal:ac},S);return false},S=function(Y){if(!L(Y.data.cal.get(0),Y.target,Y.data.cal.get(0))){if(Y.data.cal.data("colorpicker").onHide.apply(this,[Y.data.cal.get(0)])!=false){Y.data.cal.hide()}b(document).unbind("mousedown",S)}},L=function(aa,Z,Y){if(aa==Z){return true}if(aa.contains){return aa.contains(Z)}if(aa.compareDocumentPosition){return !!(aa.compareDocumentPosition(Z)&16)}var ab=Z.parentNode;while(ab&&ab!=Y){if(ab==aa){return true}ab=ab.parentNode}return false},E=function(){var Y=document.compatMode=="CSS1Compat";return{l:window.pageXOffset||(Y?document.documentElement.scrollLeft:document.body.scrollLeft),t:window.pageYOffset||(Y?document.documentElement.scrollTop:document.body.scrollTop),w:window.innerWidth||(Y?document.documentElement.clientWidth:document.body.clientWidth),h:window.innerHeight||(Y?document.documentElement.clientHeight:document.body.clientHeight)}},f=function(Y){return{h:Math.min(360,Math.max(0,Y.h)),s:Math.min(100,Math.max(0,Y.s)),b:Math.min(100,Math.max(0,Y.b))}},P=function(Y){return{r:Math.min(255,Math.max(0,Y.r)),g:Math.min(255,Math.max(0,Y.g)),b:Math.min(255,Math.max(0,Y.b))}},D=function(aa){var Y=6-aa.length;if(Y>0){var ab=[];for(var Z=0;Z<Y;Z++){ab.push("0")}ab.push(aa);aa=ab.join("")}return aa},d=function(Y){var Y=parseInt(((Y.indexOf("#")>-1)?Y.substring(1):Y),16);return{r:Y>>16,g:(Y&65280)>>8,b:(Y&255)}},p=function(Y){return l(d(Y))},l=function(Z){var Y={};Y.b=Math.max(Math.max(Z.r,Z.g),Z.b);Y.s=(Y.b<=0)?0:Math.round(100*(Y.b-Math.min(Math.min(Z.r,Z.g),Z.b))/Y.b);Y.b=Math.round((Y.b/255)*100);if((Z.r==Z.g)&&(Z.g==Z.b)){Y.h=0}else{if(Z.r>=Z.g&&Z.g>=Z.b){Y.h=60*(Z.g-Z.b)/(Z.r-Z.b)}else{if(Z.g>=Z.r&&Z.r>=Z.b){Y.h=60+60*(Z.g-Z.r)/(Z.g-Z.b)}else{if(Z.g>=Z.b&&Z.b>=Z.r){Y.h=120+60*(Z.b-Z.r)/(Z.g-Z.r)}else{if(Z.b>=Z.g&&Z.g>=Z.r){Y.h=180+60*(Z.b-Z.g)/(Z.b-Z.r)}else{if(Z.b>=Z.r&&Z.r>=Z.g){Y.h=240+60*(Z.r-Z.g)/(Z.b-Z.g)}else{if(Z.r>=Z.b&&Z.b>=Z.g){Y.h=300+60*(Z.r-Z.b)/(Z.r-Z.g)}else{Y.h=0}}}}}}}Y.h=Math.round(Y.h);return Y},m=function(Y){var aa={};var ae=Math.round(Y.h);var ad=Math.round(Y.s*255/100);var Z=Math.round(Y.b*255/100);if(ad==0){aa.r=aa.g=aa.b=Z}else{var af=Z;var ac=(255-ad)*Z/255;var ab=(af-ac)*(ae%60)/60;if(ae==360){ae=0}if(ae<60){aa.r=af;aa.b=ac;aa.g=ac+ab}else{if(ae<120){aa.g=af;aa.b=ac;aa.r=af-ab}else{if(ae<180){aa.g=af;aa.r=ac;aa.b=ac+ab}else{if(ae<240){aa.b=af;aa.r=ac;aa.g=af-ab}else{if(ae<300){aa.b=af;aa.g=ac;aa.r=ac+ab}else{if(ae<360){aa.r=af;aa.g=ac;aa.b=af-ab}else{aa.r=0;aa.g=0;aa.b=0}}}}}}}return{r:Math.round(aa.r),g:Math.round(aa.g),b:Math.round(aa.b)}},H=function(Y){var Z=[Y.r.toString(16),Y.g.toString(16),Y.b.toString(16)];b.each(Z,function(aa,ab){if(ab.length==1){Z[aa]="0"+ab}});return Z.join("")},V=function(Y){return H(m(Y))};return{init:function(Y){Y=b.extend({},G,Y||{});if(typeof Y.color=="string"){Y.color=p(Y.color)}else{if(Y.color.r!=undefined&&Y.color.g!=undefined&&Y.color.b!=undefined){Y.color=l(Y.color)}else{if(Y.color.h!=undefined&&Y.color.s!=undefined&&Y.color.b!=undefined){Y.color=f(Y.color)}else{return this}}}Y.origColor=Y.color;return this.each(function(){if(!b(this).data("colorpickerId")){var aa="collorpicker_"+parseInt(Math.random()*1000);b(this).data("colorpickerId",aa);var Z=b(T).attr("id",aa);if(Y.flat){Z.appendTo(this).show()}else{Z.appendTo(document.body)}Y.fields=Z.find("input").bind("keydown",q).bind("change",e).bind("blur",s).bind("focus",O);Z.find("span").bind("mousedown",M);Y.selector=Z.find("div.colorpicker_color").bind("mousedown",C);Y.selectorIndic=Y.selector.find("div div");Y.hue=Z.find("div.colorpicker_hue div");Z.find("div.colorpicker_hue").bind("mousedown",B);Y.newColor=Z.find("div.colorpicker_new_color");Y.currentColor=Z.find("div.colorpicker_current_color");Z.data("colorpicker",Y);Z.find("input.colorpicker_none").bind("click",W);Z.find("input.colorpicker_submit").bind("click",t);N(Y.color,Z.get(0));z(Y.color,Z.get(0));g(Y.color,Z.get(0));K(Y.color,Z.get(0));o(Y.color,Z.get(0));k(Y.color,Z.get(0));J(Y.color,Z.get(0));if(Y.flat){Z.css({position:"relative",display:"block"})}else{b(this).bind(Y.eventName,I)}}})},showPicker:function(){return this.each(function(){if(b(this).data("colorpickerId")){I.apply(this)}})},hidePicker:function(){return this.each(function(){if(b(this).data("colorpickerId")){b("#"+b(this).data("colorpickerId")).hide()}})},setColor:function(Y){if(typeof Y=="string"){Y=p(Y)}else{if(Y.r!=undefined&&Y.g!=undefined&&Y.b!=undefined){Y=l(Y)}else{if(Y.h!=undefined&&Y.s!=undefined&&Y.b!=undefined){Y=f(Y)}else{return this}}}return this.each(function(){if(b(this).data("colorpickerId")){var Z=b("#"+b(this).data("colorpickerId"));Z.data("colorpicker").color=Y;Z.data("colorpicker").origColor=Y;N(Y,Z.get(0));z(Y,Z.get(0));g(Y,Z.get(0));K(Y,Z.get(0));o(Y,Z.get(0));k(Y,Z.get(0));J(Y,Z.get(0))}})}}}();b.fn.extend({ColorPicker:a.init,ColorPickerHide:a.hide,ColorPickerShow:a.show,ColorPickerSetColor:a.setColor})})(jQuery);(function(a){a.fn.hoverIntent=function(n,m){var o={sensitivity:7,interval:100,timeout:0};o=a.extend(o,m?{over:n,out:m}:n);var q,p,k,d;var e=function(f){q=f.pageX;p=f.pageY};var c=function(g,f){f.hoverIntent_t=clearTimeout(f.hoverIntent_t);if((Math.abs(k-q)+Math.abs(d-p))<o.sensitivity){a(f).unbind("mousemove",e);f.hoverIntent_s=1;return o.over.apply(f,[g])}else{k=q;d=p;f.hoverIntent_t=setTimeout(function(){c(g,f)},o.interval)}};var l=function(g,f){f.hoverIntent_t=clearTimeout(f.hoverIntent_t);f.hoverIntent_s=0;return o.out.apply(f,[g])};var b=function(s){var g=jQuery.extend({},s);var f=this;if(f.hoverIntent_t){f.hoverIntent_t=clearTimeout(f.hoverIntent_t)}if(s.type=="mouseenter"){k=g.pageX;d=g.pageY;a(f).bind("mousemove",e);if(f.hoverIntent_s!=1){f.hoverIntent_t=setTimeout(function(){c(g,f)},o.interval)}}else{a(f).unbind("mousemove",e);if(f.hoverIntent_s==1){f.hoverIntent_t=setTimeout(function(){l(g,f)},o.timeout)}}};return this.bind("mouseenter",b).bind("mouseleave",b)}})(jQuery);(function(d){var a=null;var c="blocktypes";var b=null;d.fn.liveUpdate=function(f,e){return this.each(function(){new d.liveUpdate(this,f,e)})};d.liveUpdate=function(k,g,f){this.field=d(k);this.list=d("#"+g);this.lutype="blocktypes";if(typeof(f)!="undefined"){this.lutype=f}if(this.list.length>0){this.init()}};d.liveUpdate.prototype={init:function(){var e=this;this.setupCache();this.field.parents("form").submit(function(){return false});this.field.keyup(function(){e.filter()});e.filter()},filter:function(){if(this.field.val()!=b){if(d.trim(this.field.val())==""){if(this.lutype=="blocktypes"){this.list.children("li").addClass("ccm-block-type-available");this.list.children("li").removeClass("ccm-block-type-selected")}else{if(this.lutype=="attributes"){this.list.children("li").addClass("ccm-attribute-available");this.list.children("li").removeClass("ccm-attribute-selected")}else{if(this.lutype=="stacks"){this.list.children("li").addClass("ccm-stack-available");this.list.children("li").removeClass("ccm-stack-selected")}else{if(this.lutype=="intelligent-search"){if(this.list.is(":visible")){this.list.hide()}}else{this.list.children("li").show()}}}}return}if(this.lutype!="intelligent-search"||this.field.val().length>2){this.displayResults(this.getScores(this.field.val().toLowerCase()))}else{if(this.lutype=="intelligent-search"){if(this.list.is(":visible")){this.list.hide()}}}}b=this.field.val();if(b==""&&this.lutype=="intelligent-search"){if(this.list.is(":visible")){this.list.hide()}}},setupCache:function(){var e=this;this.cache=[];this.rows=[];var f=this.lutype;this.list.find("li").each(function(){if(f=="blocktypes"){e.cache.push(d(this).find("a.ccm-block-type-inner").html().toLowerCase())}else{if(f=="attributes"){var k=d(this).find("a,span").html().toLowerCase();e.cache.push(k)}else{if(f=="stacks"){var k=d(this).find("a,span").html().toLowerCase();e.cache.push(k)}else{if(f=="fileset"){e.cache.push(d(this).find("label").html().toLowerCase())}else{if(f=="intelligent-search"){var g=d(this).find("span").html();if(g){e.cache.push(g.toLowerCase())}}}}}}e.rows.push(d(this))});this.cache_length=this.cache.length},displayResults:function(g){var e=this;if(this.lutype=="blocktypes"){this.list.children("li").removeClass("ccm-block-type-available");this.list.children("li").removeClass("ccm-block-type-selected");d.each(g,function(k,l){e.rows[l[1]].addClass("ccm-block-type-available")});d(this.list.find("li.ccm-block-type-available")[0]).addClass("ccm-block-type-selected")}else{if(this.lutype=="attributes"){this.list.children("li").removeClass("ccm-attribute-available");this.list.children("li").removeClass("ccm-attribute-selected");this.list.children("li").removeClass("ccm-item-selected");d.each(g,function(k,l){e.rows[l[1]].addClass("ccm-attribute-available")});this.list.children("li.icon-select-list-header").removeClass("ccm-attribute-available");d(this.list.find("li.ccm-attribute-available")[0]).addClass("ccm-item-selected")}else{if(this.lutype=="stacks"){this.list.children("li").removeClass("ccm-stack-available");this.list.children("li").removeClass("ccm-stack-selected");this.list.children("li").removeClass("ccm-item-selected");d.each(g,function(k,l){e.rows[l[1]].addClass("ccm-stack-available")});this.list.children("li.icon-select-list-header").removeClass("ccm-stack-available");d(this.list.find("li.ccm-stack-available")[0]).addClass("ccm-item-selected")}else{if(this.lutype=="intelligent-search"){if(!this.list.is(":visible")){this.list.fadeIn(160,"easeOutExpo")}this.list.find(".ccm-intelligent-search-results-module-onsite").hide();this.list.find("li").hide();var f=0;d.each(g,function(k,l){$li=e.rows[l[1]];if(l[0]>0.7){f++;if(!$li.parent().parent().is(":visible")){$li.parent().parent().show()}$li.show()}});this.list.find("li a").removeClass("ccm-intelligent-search-result-selected");this.list.find("li:visible a:first").addClass("ccm-intelligent-search-result-selected")}else{this.list.children("li").hide();d.each(g,function(k,l){e.rows[l[1]].show()})}}}}},getScores:function(f){var k=[];for(var e=0;e<this.cache_length;e++){var g=this.cache[e].score(f);if(g>0){k.push([g,e])}}return k.sort(function(m,l){return l[0]-m[0]})}}})(jQuery);(function($){$.extend({metadata:{defaults:{type:"class",name:"metadata",cre:/({.*})/,single:"metadata"},setType:function(type,name){this.defaults.type=type;this.defaults.name=name},get:function(elem,opts){var settings=$.extend({},this.defaults,opts);if(!settings.single.length){settings.single="metadata"}var data=$.data(elem,settings.single);if(data){return data}data="{}";if(settings.type=="class"){var m=settings.cre.exec(elem.className);if(m){data=m[1]}}else{if(settings.type=="elem"){if(!elem.getElementsByTagName){return}var e=elem.getElementsByTagName(settings.name);if(e.length){data=$.trim(e[0].innerHTML)}}else{if(elem.getAttribute!=undefined){var attr=elem.getAttribute(settings.name);if(attr){data=attr}}}}if(data.indexOf("{")<0){data="{"+data+"}"}data=eval("("+data+")");$.data(elem,settings.single,data);return data}}});$.fn.metadata=function(opts){return $.metadata.get(this[0],opts)}})(jQuery);(function(b){var a=function(o,v){var l=b.extend({},b.fn.nivoSlider.defaults,v);var s={currentSlide:0,currentImage:"",totalSlides:0,randAnim:"",running:false,paused:false,stop:false};var d=b(o);d.data("nivo:vars",s);d.css("position","relative");d.addClass("nivoSlider");var e=d.children();e.each(function(){var A=b(this);var z="";if(!A.is("img")){if(A.is("a")){A.addClass("nivo-imageLink");z=A}A=A.find("img:first")}var y=A.width();if(y==0){y=A.attr("width")}var x=A.height();if(x==0){x=A.attr("height")}if(y>d.width()){d.width(y)}if(x>d.height()){d.height(x)}if(z!=""){z.css("display","none")}A.css("display","none");s.totalSlides++});if(l.startSlide>0){if(l.startSlide>=s.totalSlides){l.startSlide=s.totalSlides-1}s.currentSlide=l.startSlide}if(b(e[s.currentSlide]).is("img")){s.currentImage=b(e[s.currentSlide])}else{s.currentImage=b(e[s.currentSlide]).find("img:first")}if(b(e[s.currentSlide]).is("a")){b(e[s.currentSlide]).css("display","block")}d.css("background",'url("'+s.currentImage.attr("src")+'") no-repeat');d.append(b('<div class="nivo-caption"><p></p></div>').css({display:"none",opacity:l.captionOpacity}));var t=function(x){var z=b(".nivo-caption",d);if(s.currentImage.attr("title")!=""&&s.currentImage.attr("title")!=undefined){var y=s.currentImage.attr("title");if(y.substr(0,1)=="#"){y=b(y).html()}if(z.css("display")=="block"){z.find("p").fadeOut(x.animSpeed,function(){b(this).html(y);b(this).fadeIn(x.animSpeed)})}else{z.find("p").html(y)}z.fadeIn(x.animSpeed)}else{z.fadeOut(x.animSpeed)}};t(l);var c=0;if(!l.manualAdvance&&e.length>1){c=setInterval(function(){u(d,e,l,false)},l.pauseTime)}if(l.directionNav){d.append('<div class="nivo-directionNav"><a class="nivo-prevNav">'+l.prevText+'</a><a class="nivo-nextNav">'+l.nextText+"</a></div>");if(l.directionNavHide){b(".nivo-directionNav",d).hide();d.hover(function(){b(".nivo-directionNav",d).show()},function(){b(".nivo-directionNav",d).hide()})}b("a.nivo-prevNav",d).live("click",function(){if(s.running){return false}clearInterval(c);c="";s.currentSlide-=2;u(d,e,l,"prev")});b("a.nivo-nextNav",d).live("click",function(){if(s.running){return false}clearInterval(c);c="";u(d,e,l,"next")})}if(l.controlNav){var p=b('<div class="nivo-controlNav"></div>');d.append(p);for(var n=0;n<e.length;n++){if(l.controlNavThumbs){var f=e.eq(n);if(!f.is("img")){f=f.find("img:first")}if(l.controlNavThumbsFromRel){p.append('<a class="nivo-control" rel="'+n+'"><img src="'+f.attr("rel")+'" alt="" /></a>')}else{p.append('<a class="nivo-control" rel="'+n+'"><img src="'+f.attr("src").replace(l.controlNavThumbsSearch,l.controlNavThumbsReplace)+'" alt="" /></a>')}}else{p.append('<a class="nivo-control" rel="'+n+'">'+(n+1)+"</a>")}}b(".nivo-controlNav a:eq("+s.currentSlide+")",d).addClass("active");b(".nivo-controlNav a",d).live("click",function(){if(s.running){return false}if(b(this).hasClass("active")){return false}clearInterval(c);c="";d.css("background",'url("'+s.currentImage.attr("src")+'") no-repeat');s.currentSlide=b(this).attr("rel")-1;u(d,e,l,"control")})}if(l.keyboardNav){b(window).keypress(function(x){if(x.keyCode=="37"){if(s.running){return false}clearInterval(c);c="";s.currentSlide-=2;u(d,e,l,"prev")}if(x.keyCode=="39"){if(s.running){return false}clearInterval(c);c="";u(d,e,l,"next")}})}if(l.pauseOnHover){d.hover(function(){s.paused=true;clearInterval(c);c=""},function(){s.paused=false;if(c==""&&!l.manualAdvance){c=setInterval(function(){u(d,e,l,false)},l.pauseTime)}})}d.bind("nivo:animFinished",function(){s.running=false;b(e).each(function(){if(b(this).is("a")){b(this).css("display","none")}});if(b(e[s.currentSlide]).is("a")){b(e[s.currentSlide]).css("display","block")}if(c==""&&!s.paused&&!l.manualAdvance){c=setInterval(function(){u(d,e,l,false)},l.pauseTime)}l.afterChange.call(this)});var g=function(z,y,B){for(var x=0;x<y.slices;x++){var A=Math.round(z.width()/y.slices);if(x==y.slices-1){z.append(b('<div class="nivo-slice"></div>').css({left:(A*x)+"px",width:(z.width()-(A*x))+"px",height:"0px",opacity:"0",background:'url("'+B.currentImage.attr("src")+'") no-repeat -'+((A+(x*A))-A)+"px 0%"}))}else{z.append(b('<div class="nivo-slice"></div>').css({left:(A*x)+"px",width:A+"px",height:"0px",opacity:"0",background:'url("'+B.currentImage.attr("src")+'") no-repeat -'+((A+(x*A))-A)+"px 0%"}))}}};var k=function(z,x,C){var y=Math.round(z.width()/x.boxCols);var D=Math.round(z.height()/x.boxRows);for(var A=0;A<x.boxRows;A++){for(var B=0;B<x.boxCols;B++){if(B==x.boxCols-1){z.append(b('<div class="nivo-box"></div>').css({opacity:0,left:(y*B)+"px",top:(D*A)+"px",width:(z.width()-(y*B))+"px",height:D+"px",background:'url("'+C.currentImage.attr("src")+'") no-repeat -'+((y+(B*y))-y)+"px -"+((D+(A*D))-D)+"px"}))}else{z.append(b('<div class="nivo-box"></div>').css({opacity:0,left:(y*B)+"px",top:(D*A)+"px",width:y+"px",height:D+"px",background:'url("'+C.currentImage.attr("src")+'") no-repeat -'+((y+(B*y))-y)+"px -"+((D+(A*D))-D)+"px"}))}}}};var u=function(K,J,N,G){var I=K.data("nivo:vars");if(I&&(I.currentSlide==I.totalSlides-1)){N.lastSlide.call(this)}if((!I||I.stop)&&!G){return false}N.beforeChange.call(this);if(!G){K.css("background",'url("'+I.currentImage.attr("src")+'") no-repeat')}else{if(G=="prev"){K.css("background",'url("'+I.currentImage.attr("src")+'") no-repeat')}if(G=="next"){K.css("background",'url("'+I.currentImage.attr("src")+'") no-repeat')}}I.currentSlide++;if(I.currentSlide==I.totalSlides){I.currentSlide=0;N.slideshowEnd.call(this)}if(I.currentSlide<0){I.currentSlide=(I.totalSlides-1)}if(b(J[I.currentSlide]).is("img")){I.currentImage=b(J[I.currentSlide])}else{I.currentImage=b(J[I.currentSlide]).find("img:first")}if(N.controlNav){b(".nivo-controlNav a",K).removeClass("active");b(".nivo-controlNav a:eq("+I.currentSlide+")",K).addClass("active")}t(N);b(".nivo-slice",K).remove();b(".nivo-box",K).remove();if(N.effect=="random"){var P=new Array("sliceDownRight","sliceDownLeft","sliceUpRight","sliceUpLeft","sliceUpDown","sliceUpDownLeft","fold","fade","boxRandom","boxRain","boxRainReverse","boxRainGrow","boxRainGrowReverse");I.randAnim=P[Math.floor(Math.random()*(P.length+1))];if(I.randAnim==undefined){I.randAnim="fade"}}if(N.effect.indexOf(",")!=-1){var P=N.effect.split(",");I.randAnim=P[Math.floor(Math.random()*(P.length))];if(I.randAnim==undefined){I.randAnim="fade"}}I.running=true;if(N.effect=="sliceDown"||N.effect=="sliceDownRight"||I.randAnim=="sliceDownRight"||N.effect=="sliceDownLeft"||I.randAnim=="sliceDownLeft"){g(K,N,I);var O=0;var L=0;var x=b(".nivo-slice",K);if(N.effect=="sliceDownLeft"||I.randAnim=="sliceDownLeft"){x=b(".nivo-slice",K)._reverse()}x.each(function(){var Q=b(this);Q.css({top:"0px"});if(L==N.slices-1){setTimeout(function(){Q.animate({height:"100%",opacity:"1.0"},N.animSpeed,"",function(){K.trigger("nivo:animFinished")})},(100+O))}else{setTimeout(function(){Q.animate({height:"100%",opacity:"1.0"},N.animSpeed)},(100+O))}O+=50;L++})}else{if(N.effect=="sliceUp"||N.effect=="sliceUpRight"||I.randAnim=="sliceUpRight"||N.effect=="sliceUpLeft"||I.randAnim=="sliceUpLeft"){g(K,N,I);var O=0;var L=0;var x=b(".nivo-slice",K);if(N.effect=="sliceUpLeft"||I.randAnim=="sliceUpLeft"){x=b(".nivo-slice",K)._reverse()}x.each(function(){var Q=b(this);Q.css({bottom:"0px"});if(L==N.slices-1){setTimeout(function(){Q.animate({height:"100%",opacity:"1.0"},N.animSpeed,"",function(){K.trigger("nivo:animFinished")})},(100+O))}else{setTimeout(function(){Q.animate({height:"100%",opacity:"1.0"},N.animSpeed)},(100+O))}O+=50;L++})}else{if(N.effect=="sliceUpDown"||N.effect=="sliceUpDownRight"||I.randAnim=="sliceUpDown"||N.effect=="sliceUpDownLeft"||I.randAnim=="sliceUpDownLeft"){g(K,N,I);var O=0;var L=0;var E=0;var x=b(".nivo-slice",K);if(N.effect=="sliceUpDownLeft"||I.randAnim=="sliceUpDownLeft"){x=b(".nivo-slice",K)._reverse()}x.each(function(){var Q=b(this);if(L==0){Q.css("top","0px");L++}else{Q.css("bottom","0px");L=0}if(E==N.slices-1){setTimeout(function(){Q.animate({height:"100%",opacity:"1.0"},N.animSpeed,"",function(){K.trigger("nivo:animFinished")})},(100+O))}else{setTimeout(function(){Q.animate({height:"100%",opacity:"1.0"},N.animSpeed)},(100+O))}O+=50;E++})}else{if(N.effect=="fold"||I.randAnim=="fold"){g(K,N,I);var O=0;var L=0;b(".nivo-slice",K).each(function(){var Q=b(this);var R=Q.width();Q.css({top:"0px",height:"100%",width:"0px"});if(L==N.slices-1){setTimeout(function(){Q.animate({width:R,opacity:"1.0"},N.animSpeed,"",function(){K.trigger("nivo:animFinished")})},(100+O))}else{setTimeout(function(){Q.animate({width:R,opacity:"1.0"},N.animSpeed)},(100+O))}O+=50;L++})}else{if(N.effect=="fade"||I.randAnim=="fade"){g(K,N,I);var C=b(".nivo-slice:first",K);C.css({height:"100%",width:K.width()+"px"});C.animate({opacity:"1.0"},(N.animSpeed*2),"",function(){K.trigger("nivo:animFinished")})}else{if(N.effect=="slideInRight"||I.randAnim=="slideInRight"){g(K,N,I);var C=b(".nivo-slice:first",K);C.css({height:"100%",width:"0px",opacity:"1"});C.animate({width:K.width()+"px"},(N.animSpeed*2),"",function(){K.trigger("nivo:animFinished")})}else{if(N.effect=="slideInLeft"||I.randAnim=="slideInLeft"){g(K,N,I);var C=b(".nivo-slice:first",K);C.css({height:"100%",width:"0px",opacity:"1",left:"",right:"0px"});C.animate({width:K.width()+"px"},(N.animSpeed*2),"",function(){C.css({left:"0px",right:""});K.trigger("nivo:animFinished")})}else{if(N.effect=="boxRandom"||I.randAnim=="boxRandom"){k(K,N,I);var M=N.boxCols*N.boxRows;var L=0;var O=0;var z=q(b(".nivo-box",K));z.each(function(){var Q=b(this);if(L==M-1){setTimeout(function(){Q.animate({opacity:"1"},N.animSpeed,"",function(){K.trigger("nivo:animFinished")})},(100+O))}else{setTimeout(function(){Q.animate({opacity:"1"},N.animSpeed)},(100+O))}O+=20;L++})}else{if(N.effect=="boxRain"||I.randAnim=="boxRain"||N.effect=="boxRainReverse"||I.randAnim=="boxRainReverse"||N.effect=="boxRainGrow"||I.randAnim=="boxRainGrow"||N.effect=="boxRainGrowReverse"||I.randAnim=="boxRainGrowReverse"){k(K,N,I);var M=N.boxCols*N.boxRows;var L=0;var O=0;var B=0;var H=0;var F=new Array();F[B]=new Array();var z=b(".nivo-box",K);if(N.effect=="boxRainReverse"||I.randAnim=="boxRainReverse"||N.effect=="boxRainGrowReverse"||I.randAnim=="boxRainGrowReverse"){z=b(".nivo-box",K)._reverse()}z.each(function(){F[B][H]=b(this);H++;if(H==N.boxCols){B++;H=0;F[B]=new Array()}});for(var D=0;D<(N.boxCols*2);D++){var y=D;for(var A=0;A<N.boxRows;A++){if(y>=0&&y<N.boxCols){(function(W,R,V,S,X){var U=b(F[W][R]);var Q=U.width();var T=U.height();if(N.effect=="boxRainGrow"||I.randAnim=="boxRainGrow"||N.effect=="boxRainGrowReverse"||I.randAnim=="boxRainGrowReverse"){U.width(0).height(0)}if(S==X-1){setTimeout(function(){U.animate({opacity:"1",width:Q,height:T},N.animSpeed/1.3,"",function(){K.trigger("nivo:animFinished")})},(100+V))}else{setTimeout(function(){U.animate({opacity:"1",width:Q,height:T},N.animSpeed/1.3)},(100+V))}})(A,y,O,L,M);L++}y--}O+=100}}}}}}}}}}};var q=function(z){for(var A,y,B=z.length;B;A=parseInt(Math.random()*B),y=z[--B],z[B]=z[A],z[A]=y){}return z};var m=function(x){if(this.console&&typeof console.log!="undefined"){console.log(x)}};this.stop=function(){if(!b(o).data("nivo:vars").stop){b(o).data("nivo:vars").stop=true;m("Stop Slider")}};this.start=function(){if(b(o).data("nivo:vars").stop){b(o).data("nivo:vars").stop=false;m("Start Slider")}};l.afterLoad.call(this);return this};b.fn.nivoSlider=function(c){return this.each(function(e,g){var d=b(this);if(d.data("nivoslider")){return d.data("nivoslider")}var f=new a(this,c);d.data("nivoslider",f)})};b.fn.nivoSlider.defaults={effect:"random",slices:15,boxCols:8,boxRows:4,animSpeed:500,pauseTime:3000,startSlide:0,directionNav:true,directionNavHide:true,controlNav:true,controlNavThumbs:false,controlNavThumbsFromRel:false,controlNavThumbsSearch:".jpg",controlNavThumbsReplace:"_thumb.jpg",keyboardNav:true,pauseOnHover:true,manualAdvance:false,captionOpacity:0.8,prevText:"Prev",nextText:"Next",beforeChange:function(){},afterChange:function(){},slideshowEnd:function(){},lastSlide:function(){},afterLoad:function(){}};b.fn._reverse=[].reverse})(jQuery);(function(){var d,e,c,a;var b=function(f,g){return function(){return f.apply(g,arguments)}};a=this;d=jQuery;d.fn.extend({chosen:function(f){if(d.browser==="msie"&&(d.browser.version==="6.0"||d.browser.version==="7.0")){return this}return d(this).each(function(g){if(!(d(this)).hasClass("chzn-done")){return new e(this,f)}})}});e=(function(){function f(g,k){this.form_field=g;this.options=k!=null?k:{};this.set_default_values();this.form_field_jq=d(this.form_field);this.is_multiple=this.form_field.multiple;this.is_rtl=this.form_field_jq.hasClass("chzn-rtl");this.default_text_default=this.form_field.multiple?"Select Some Options":"Select an Option";this.set_up_html();this.register_observers();this.form_field_jq.addClass("chzn-done")}f.prototype.set_default_values=function(){this.click_test_action=b(function(g){return this.test_active_click(g)},this);this.activate_action=b(function(g){return this.activate_field(g)},this);this.active_field=false;this.mouse_on_container=false;this.results_showing=false;this.result_highlighted=null;this.result_single_selected=null;this.allow_single_deselect=(this.options.allow_single_deselect!=null)&&this.form_field.options[0].text===""?this.options.allow_single_deselect:false;this.disable_search_threshold=this.options.disable_search_threshold||0;this.choices=0;return this.results_none_found=this.options.no_results_text||"No results match"};f.prototype.set_up_html=function(){var m,l,k,g;this.container_id=this.form_field.id.length?this.form_field.id.replace(/(:|\.)/g,"_"):this.generate_field_id();this.container_id+="_chzn";this.f_width=this.form_field_jq.outerWidth();this.default_text=this.form_field_jq.data("placeholder")?this.form_field_jq.data("placeholder"):this.default_text_default;m=d("<div />",{id:this.container_id,"class":"chzn-container"+(this.is_rtl?" chzn-rtl":""),style:"width: "+this.f_width+"px;"});if(this.is_multiple){m.html('<ul class="chzn-choices"><li class="search-field"><input type="text" value="'+this.default_text+'" class="default" autocomplete="off" style="width:25px;" /></li></ul><div class="chzn-drop" style="left:-9000px;"><ul class="chzn-results"></ul></div>')}else{m.html('<a href="javascript:void(0)" class="chzn-single"><span>'+this.default_text+'</span><div><b></b></div></a><div class="chzn-drop" style="left:-9000px;"><div class="chzn-search"><input type="text" autocomplete="off" /></div><ul class="chzn-results"></ul></div>')}this.form_field_jq.hide().after(m);this.container=d("#"+this.container_id);this.container.addClass("chzn-container-"+(this.is_multiple?"multi":"single"));if(!this.is_multiple&&this.form_field.options.length<=this.disable_search_threshold){this.container.addClass("chzn-container-single-nosearch")}this.dropdown=this.container.find("div.chzn-drop").first();l=this.container.height();k=this.f_width-c(this.dropdown);this.dropdown.css({width:k+"px",top:l+"px"});this.search_field=this.container.find("input").first();this.search_results=this.container.find("ul.chzn-results").first();this.search_field_scale();this.search_no_results=this.container.find("li.no-results").first();if(this.is_multiple){this.search_choices=this.container.find("ul.chzn-choices").first();this.search_container=this.container.find("li.search-field").first()}else{this.search_container=this.container.find("div.chzn-search").first();this.selected_item=this.container.find(".chzn-single").first();g=k-c(this.search_container)-c(this.search_field);this.search_field.css({width:g+"px"})}this.results_build();return this.set_tab_index()};f.prototype.register_observers=function(){this.container.mousedown(b(function(g){return this.container_mousedown(g)},this));this.container.mouseup(b(function(g){return this.container_mouseup(g)},this));this.container.mouseenter(b(function(g){return this.mouse_enter(g)},this));this.container.mouseleave(b(function(g){return this.mouse_leave(g)},this));this.search_results.mouseup(b(function(g){return this.search_results_mouseup(g)},this));this.search_results.mouseover(b(function(g){return this.search_results_mouseover(g)},this));this.search_results.mouseout(b(function(g){return this.search_results_mouseout(g)},this));this.form_field_jq.bind("liszt:updated",b(function(g){return this.results_update_field(g)},this));this.search_field.blur(b(function(g){return this.input_blur(g)},this));this.search_field.keyup(b(function(g){return this.keyup_checker(g)},this));this.search_field.keydown(b(function(g){return this.keydown_checker(g)},this));if(this.is_multiple){this.search_choices.click(b(function(g){return this.choices_click(g)},this));return this.search_field.focus(b(function(g){return this.input_focus(g)},this))}};f.prototype.search_field_disabled=function(){this.is_disabled=this.form_field_jq.attr("disabled");if(this.is_disabled){this.container.addClass("chzn-disabled");this.search_field.attr("disabled",true);if(!this.is_multiple){this.selected_item.unbind("focus",this.activate_action)}return this.close_field()}else{this.container.removeClass("chzn-disabled");this.search_field.attr("disabled",false);if(!this.is_multiple){return this.selected_item.bind("focus",this.activate_action)}}};f.prototype.container_mousedown=function(g){var k;if(!this.is_disabled){k=g!=null?(d(g.target)).hasClass("search-choice-close"):false;if(g&&g.type==="mousedown"){g.stopPropagation()}if(!this.pending_destroy_click&&!k){if(!this.active_field){if(this.is_multiple){this.search_field.val("")}d(document).click(this.click_test_action);this.results_show()}else{if(!this.is_multiple&&g&&(d(g.target)===this.selected_item||d(g.target).parents("a.chzn-single").length)){g.preventDefault();this.results_toggle()}}return this.activate_field()}else{return this.pending_destroy_click=false}}};f.prototype.container_mouseup=function(g){if(g.target.nodeName==="ABBR"){return this.results_reset(g)}};f.prototype.mouse_enter=function(){return this.mouse_on_container=true};f.prototype.mouse_leave=function(){return this.mouse_on_container=false};f.prototype.input_focus=function(g){if(!this.active_field){return setTimeout((b(function(){return this.container_mousedown()},this)),50)}};f.prototype.input_blur=function(g){if(!this.mouse_on_container){this.active_field=false;return setTimeout((b(function(){return this.blur_test()},this)),100)}};f.prototype.blur_test=function(g){if(!this.active_field&&this.container.hasClass("chzn-container-active")){return this.close_field()}};f.prototype.close_field=function(){d(document).unbind("click",this.click_test_action);if(!this.is_multiple){this.selected_item.attr("tabindex",this.search_field.attr("tabindex"));this.search_field.attr("tabindex",-1)}this.active_field=false;this.results_hide();this.container.removeClass("chzn-container-active");this.winnow_results_clear();this.clear_backstroke();this.show_search_field_default();return this.search_field_scale()};f.prototype.activate_field=function(){if(!this.is_multiple&&!this.active_field){this.search_field.attr("tabindex",this.selected_item.attr("tabindex"));this.selected_item.attr("tabindex",-1)}this.container.addClass("chzn-container-active");this.active_field=true;this.search_field.val(this.search_field.val());return this.search_field.focus()};f.prototype.test_active_click=function(g){if(d(g.target).parents("#"+this.container_id).length){return this.active_field=true}else{return this.close_field()}};f.prototype.results_build=function(){var l,o,k,n,g,m;k=new Date();this.parsing=true;this.results_data=a.SelectParser.select_to_array(this.form_field);if(this.is_multiple&&this.choices>0){this.search_choices.find("li.search-choice").remove();this.choices=0}else{if(!this.is_multiple){this.selected_item.find("span").text(this.default_text)}}l="";m=this.results_data;for(n=0,g=m.length;n<g;n++){o=m[n];if(o.group){l+=this.result_add_group(o)}else{if(!o.empty){l+=this.result_add_option(o);if(o.selected&&this.is_multiple){this.choice_build(o)}else{if(o.selected&&!this.is_multiple){this.selected_item.find("span").text(o.text);if(this.allow_single_deselect){this.selected_item.find("span").first().after('<abbr class="search-choice-close"></abbr>')}}}}}}this.search_field_disabled();this.show_search_field_default();this.search_field_scale();this.search_results.html(l);return this.parsing=false};f.prototype.result_add_group=function(g){if(!g.disabled){g.dom_id=this.container_id+"_g_"+g.array_index;return'<li id="'+g.dom_id+'" class="group-result">'+d("<div />").text(g.label).html()+"</li>"}else{return""}};f.prototype.result_add_option=function(l){var g,k;if(!l.disabled){l.dom_id=this.container_id+"_o_"+l.array_index;g=l.selected&&this.is_multiple?[]:["active-result"];if(l.selected){g.push("result-selected")}if(l.group_array_index!=null){g.push("group-option")}if(l.classes!==""){g.push(l.classes)}k=l.style.cssText!==""?' style="'+l.style+'"':"";return'<li id="'+l.dom_id+'" class="'+g.join(" ")+'"'+k+">"+l.html+"</li>"}else{return""}};f.prototype.results_update_field=function(){this.result_clear_highlight();this.result_single_selected=null;return this.results_build()};f.prototype.result_do_highlight=function(k){var o,n,l,m,g;if(k.length){this.result_clear_highlight();this.result_highlight=k;this.result_highlight.addClass("highlighted");l=parseInt(this.search_results.css("maxHeight"),10);g=this.search_results.scrollTop();m=l+g;n=this.result_highlight.position().top+this.search_results.scrollTop();o=n+this.result_highlight.outerHeight();if(o>=m){return this.search_results.scrollTop((o-l)>0?o-l:0)}else{if(n<g){return this.search_results.scrollTop(n)}}}};f.prototype.result_clear_highlight=function(){if(this.result_highlight){this.result_highlight.removeClass("highlighted")}return this.result_highlight=null};f.prototype.results_toggle=function(){if(this.results_showing){return this.results_hide()}else{return this.results_show()}};f.prototype.results_show=function(){var g;if(!this.is_multiple){this.selected_item.addClass("chzn-single-with-drop");if(this.result_single_selected){this.result_do_highlight(this.result_single_selected)}}g=this.is_multiple?this.container.height():this.container.height()-1;this.dropdown.css({top:g+"px",left:0});this.results_showing=true;this.search_field.focus();this.search_field.val(this.search_field.val());return this.winnow_results()};f.prototype.results_hide=function(){if(!this.is_multiple){this.selected_item.removeClass("chzn-single-with-drop")}this.result_clear_highlight();this.dropdown.css({left:"-9000px"});return this.results_showing=false};f.prototype.set_tab_index=function(k){var g;if(this.form_field_jq.attr("tabindex")){g=this.form_field_jq.attr("tabindex");this.form_field_jq.attr("tabindex",-1);if(this.is_multiple){return this.search_field.attr("tabindex",g)}else{this.selected_item.attr("tabindex",g);return this.search_field.attr("tabindex",-1)}}};f.prototype.show_search_field_default=function(){if(this.is_multiple&&this.choices<1&&!this.active_field){this.search_field.val(this.default_text);return this.search_field.addClass("default")}else{this.search_field.val("");return this.search_field.removeClass("default")}};f.prototype.search_results_mouseup=function(g){var k;k=d(g.target).hasClass("active-result")?d(g.target):d(g.target).parents(".active-result").first();if(k.length){this.result_highlight=k;return this.result_select(g)}};f.prototype.search_results_mouseover=function(g){var k;k=d(g.target).hasClass("active-result")?d(g.target):d(g.target).parents(".active-result").first();if(k){return this.result_do_highlight(k)}};f.prototype.search_results_mouseout=function(g){if(d(g.target).hasClass("active-result"||d(g.target).parents(".active-result").first())){return this.result_clear_highlight()}};f.prototype.choices_click=function(g){g.preventDefault();if(this.active_field&&!(d(g.target).hasClass("search-choice"||d(g.target).parents(".search-choice").first))&&!this.results_showing){return this.results_show()}};f.prototype.choice_build=function(l){var g,k;g=this.container_id+"_c_"+l.array_index;this.choices+=1;this.search_container.before('<li class="search-choice" id="'+g+'"><span>'+l.html+'</span><a href="javascript:void(0)" class="search-choice-close" rel="'+l.array_index+'"></a></li>');k=d("#"+g).find("a").first();return k.click(b(function(m){return this.choice_destroy_link_click(m)},this))};f.prototype.choice_destroy_link_click=function(g){g.preventDefault();if(!this.is_disabled){this.pending_destroy_click=true;return this.choice_destroy(d(g.target))}else{return g.stopPropagation}};f.prototype.choice_destroy=function(g){this.choices-=1;this.show_search_field_default();if(this.is_multiple&&this.choices>0&&this.search_field.val().length<1){this.results_hide()}this.result_deselect(g.attr("rel"));return g.parents("li").first().remove()};f.prototype.results_reset=function(g){this.form_field.options[0].selected=true;this.selected_item.find("span").text(this.default_text);this.show_search_field_default();d(g.target).remove();this.form_field_jq.trigger("change");if(this.active_field){return this.results_hide()}};f.prototype.result_select=function(k){var n,m,l,g;if(this.result_highlight){n=this.result_highlight;m=n.attr("id");this.result_clear_highlight();if(this.is_multiple){this.result_deactivate(n)}else{this.search_results.find(".result-selected").removeClass("result-selected");this.result_single_selected=n}n.addClass("result-selected");g=m.substr(m.lastIndexOf("_")+1);l=this.results_data[g];l.selected=true;this.form_field.options[l.options_index].selected=true;if(this.is_multiple){this.choice_build(l)}else{this.selected_item.find("span").first().text(l.text);if(this.allow_single_deselect){this.selected_item.find("span").first().after('<abbr class="search-choice-close"></abbr>')}}if(!(k.metaKey&&this.is_multiple)){this.results_hide()}this.search_field.val("");this.form_field_jq.trigger("change");return this.search_field_scale()}};f.prototype.result_activate=function(g){return g.addClass("active-result")};f.prototype.result_deactivate=function(g){return g.removeClass("active-result")};f.prototype.result_deselect=function(l){var g,k;k=this.results_data[l];k.selected=false;this.form_field.options[k.options_index].selected=false;g=d("#"+this.container_id+"_o_"+l);g.removeClass("result-selected").addClass("active-result").show();this.result_clear_highlight();this.winnow_results();this.form_field_jq.trigger("change");return this.search_field_scale()};f.prototype.results_search=function(g){if(this.results_showing){return this.winnow_results()}else{return this.results_show()}};f.prototype.winnow_results=function(){var B,t,m,p,y,v,s,A,l,u,z,k,o,n,x,g,q;l=new Date();this.no_results_clear();s=0;A=this.search_field.val()===this.default_text?"":d("<div/>").text(d.trim(this.search_field.val())).html();y=new RegExp("^"+A.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"i");k=new RegExp(A.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"i");q=this.results_data;for(o=0,x=q.length;o<x;o++){t=q[o];if(!t.disabled&&!t.empty){if(t.group){d("#"+t.dom_id).hide()}else{if(!(this.is_multiple&&t.selected)){B=false;v=t.dom_id;if(y.test(t.html)){B=true;s+=1}else{if(t.html.indexOf(" ")>=0||t.html.indexOf("[")===0){p=t.html.replace(/\[|\]/g,"").split(" ");if(p.length){for(n=0,g=p.length;n<g;n++){m=p[n];if(y.test(m)){B=true;s+=1}}}}}if(B){if(A.length){u=t.html.search(k);z=t.html.substr(0,u+A.length)+"</em>"+t.html.substr(u+A.length);z=z.substr(0,u)+"<em>"+z.substr(u)}else{z=t.html}if(d("#"+v).html!==z){d("#"+v).html(z)}this.result_activate(d("#"+v));if(t.group_array_index!=null){d("#"+this.results_data[t.group_array_index].dom_id).show()}}else{if(this.result_highlight&&v===this.result_highlight.attr("id")){this.result_clear_highlight()}this.result_deactivate(d("#"+v))}}}}}if(s<1&&A.length){return this.no_results(A)}else{return this.winnow_results_set_highlight()}};f.prototype.winnow_results_clear=function(){var g,m,n,l,k;this.search_field.val("");m=this.search_results.find("li");k=[];for(n=0,l=m.length;n<l;n++){g=m[n];g=d(g);k.push(g.hasClass("group-result")?g.show():!this.is_multiple||!g.hasClass("result-selected")?this.result_activate(g):void 0)}return k};f.prototype.winnow_results_set_highlight=function(){var g,k;if(!this.result_highlight){k=!this.is_multiple?this.search_results.find(".result-selected.active-result"):[];g=k.length?k.first():this.search_results.find(".active-result").first();if(g!=null){return this.result_do_highlight(g)}}};f.prototype.no_results=function(g){var k;k=d('<li class="no-results">'+this.results_none_found+' "<span></span>"</li>');k.find("span").first().html(g);return this.search_results.append(k)};f.prototype.no_results_clear=function(){return this.search_results.find(".no-results").remove()};f.prototype.keydown_arrow=function(){var k,g;if(!this.result_highlight){k=this.search_results.find("li.active-result").first();if(k){this.result_do_highlight(d(k))}}else{if(this.results_showing){g=this.result_highlight.nextAll("li.active-result").first();if(g){this.result_do_highlight(g)}}}if(!this.results_showing){return this.results_show()}};f.prototype.keyup_arrow=function(){var g;if(!this.results_showing&&!this.is_multiple){return this.results_show()}else{if(this.result_highlight){g=this.result_highlight.prevAll("li.active-result");if(g.length){return this.result_do_highlight(g.first())}else{if(this.choices>0){this.results_hide()}return this.result_clear_highlight()}}}};f.prototype.keydown_backstroke=function(){if(this.pending_backstroke){this.choice_destroy(this.pending_backstroke.find("a").first());return this.clear_backstroke()}else{this.pending_backstroke=this.search_container.siblings("li.search-choice").last();return this.pending_backstroke.addClass("search-choice-focus")}};f.prototype.clear_backstroke=function(){if(this.pending_backstroke){this.pending_backstroke.removeClass("search-choice-focus")}return this.pending_backstroke=null};f.prototype.keyup_checker=function(g){var l,k;l=(k=g.which)!=null?k:g.keyCode;this.search_field_scale();switch(l){case 8:if(this.is_multiple&&this.backstroke_length<1&&this.choices>0){return this.keydown_backstroke()}else{if(!this.pending_backstroke){this.result_clear_highlight();return this.results_search()}}break;case 13:g.preventDefault();if(this.results_showing){return this.result_select(g)}break;case 27:if(this.results_showing){return this.results_hide()}break;case 9:case 38:case 40:case 16:case 91:case 17:break;default:return this.results_search()}};f.prototype.keydown_checker=function(g){var l,k;l=(k=g.which)!=null?k:g.keyCode;this.search_field_scale();if(l!==8&&this.pending_backstroke){this.clear_backstroke()}switch(l){case 8:this.backstroke_length=this.search_field.val().length;break;case 9:this.mouse_on_container=false;break;case 13:g.preventDefault();break;case 38:g.preventDefault();this.keyup_arrow();break;case 40:this.keydown_arrow();break}};f.prototype.search_field_scale=function(){var s,g,m,k,p,q,o,l,n;if(this.is_multiple){m=0;o=0;p="position:absolute; left: -1000px; top: -1000px; display:none;";q=["font-size","font-style","font-weight","font-family","line-height","text-transform","letter-spacing"];for(l=0,n=q.length;l<n;l++){k=q[l];p+=k+":"+this.search_field.css(k)+";"}g=d("<div />",{style:p});g.text(this.search_field.val());d("body").append(g);o=g.width()+25;g.remove();if(o>this.f_width-10){o=this.f_width-10}this.search_field.css({width:o+"px"});s=this.container.height();return this.dropdown.css({top:s+"px"})}};f.prototype.generate_field_id=function(){var g;g=this.generate_random_id();this.form_field.id=g;return g};f.prototype.generate_random_id=function(){var g;g="sel"+this.generate_random_char()+this.generate_random_char()+this.generate_random_char();while(d("#"+g).length>0){g+=this.generate_random_char()}return g};f.prototype.generate_random_char=function(){var l,k,g;l="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZ";g=Math.floor(Math.random()*l.length);return k=l.substring(g,g+1)};return f})();c=function(f){var g;return g=f.outerWidth()-f.width()};a.get_side_border_padding=c}).call(this);(function(){var a;a=(function(){function b(){this.options_index=0;this.parsed=[]}b.prototype.add_node=function(c){if(c.nodeName==="OPTGROUP"){return this.add_group(c)}else{return this.add_option(c)}};b.prototype.add_group=function(l){var k,e,g,d,f,c;k=this.parsed.length;this.parsed.push({array_index:k,group:true,label:l.label,children:0,disabled:l.disabled});f=l.childNodes;c=[];for(g=0,d=f.length;g<d;g++){e=f[g];c.push(this.add_option(e,k,l.disabled))}return c};b.prototype.add_option=function(d,e,c){if(d.nodeName==="OPTION"){if(d.text!==""){if(e!=null){this.parsed[e].children+=1}this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,value:d.value,text:d.text,html:d.innerHTML,selected:d.selected,disabled:c===true?c:d.disabled,group_array_index:e,classes:d.className,style:d.style.cssText})}else{this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,empty:true})}return this.options_index+=1}};return b})();a.select_to_array=function(b){var g,f,e,c,d;f=new a();d=b.childNodes;for(e=0,c=d.length;e<c;e++){g=d[e];f.add_node(g)}return f.parsed};this.SelectParser=a}).call(this);ccm_closeDashboardPane=function(b){var c=$("#ccm-recent-page-"+CCM_CID);var a=$(b);ccm_showQuickNav(function(){var d=a.parent().parent().parent().find("h3");d.css("display","inline");$(b).closest("div.ccm-pane").fadeOut(120,"easeOutExpo");d.effect("transfer",{to:c,easing:"easeOutExpo"},600,function(){c.hide().css("visibility","visible").fadeIn(240,"easeInExpo");d.css("display","block");ccm_quickNavTimer=setTimeout(function(){ccm_hideQuickNav()},1000)})})};ccm_getDashboardBackgroundImageData=function(b,a){$.getJSON(CCM_TOOLS_PATH+"/dashboard/get_image_data",{image:b},function(d){if(d&&a){var c="<div>";c+="<strong>"+d.title+"</strong> "+ccmi18n.authoredBy+" ";if(d.link){c+='<a target="_blank" href="'+d.link+'">'+d.author+"</a>"}else{c+=d.author}$('<div id="ccm-dashboard-image-caption" class="ccm-ui"/>').html(c).appendTo(document.body).show();setTimeout(function(){$("#ccm-dashboard-image-caption").fadeOut(1000,"easeOutExpo")},5000)}})};$(function(){ccm_activateToolbar();$("#ccm-page-help,#ccm-page-navigate-pages").popover({content:function(){var d=$(this).attr("id")+"-content";return $("#"+d).html()},placement:"below",html:true,trigger:"manual"});$(".tooltip").twipsy({placement:"below"});if($("#ccm-dashboard-result-message").length>0){if($(".ccm-pane").length>0){var c=$(".ccm-pane").parent().attr("class");var a=$(".ccm-pane").parent().parent().attr("class");var b=$("#ccm-dashboard-result-message").html();$("#ccm-dashboard-result-message").html('<div class="'+a+'"><div class="'+c+'">'+b+"</div></div>").fadeIn(400)}}else{$("#ccm-dashboard-result-message").fadeIn(200)}});var ccm_totalAdvancedSearchFields=0;var ccm_alLaunchType=new Array();var ccm_alActiveAssetField="";var ccm_alProcessorTarget="";var ccm_alDebug=false;ccm_triggerSelectFile=function(e,a){if(a==null){var a=ccm_alActiveAssetField}var d=$("#"+a+"-fm-selected");var b=$("#"+a+"-fm-display");b.hide();d.show();d.load(CCM_TOOLS_PATH+"/files/selector_data?fID="+e+"&ccm_file_selected_field="+a,function(){d.attr("fID",e);d.attr("ccm-file-manager-can-view",d.children("div").attr("ccm-file-manager-can-view"));d.attr("ccm-file-manager-can-edit",d.children("div").attr("ccm-file-manager-can-edit"));d.attr("ccm-file-manager-can-admin",d.children("div").attr("ccm-file-manager-can-admin"));d.attr("ccm-file-manager-can-replace",d.children("div").attr("ccm-file-manager-can-replace"));d.attr("ccm-file-manager-instance",a);d.click(function(f){f.stopPropagation();ccm_alActivateMenu($(this),f)});if(typeof(ccm_triggerSelectFileComplete)=="function"){ccm_triggerSelectFileComplete(e,a)}});var c=$("#"+a+"-fm-value");c.attr("value",e);ccm_alSetupFileProcessor()};ccm_alGetFileData=function(b,a){$.getJSON(CCM_TOOLS_PATH+"/files/get_data.php?fID="+b,function(c){a(c)})};ccm_clearFile=function(f,a){f.stopPropagation();var d=$("#"+a+"-fm-selected");var b=$("#"+a+"-fm-display");var c=$("#"+a+"-fm-value");c.attr("value",0);d.hide();b.show()};ccm_activateFileManager=function(b,a){ccm_alSetupSelectFiles(a);$(document).click(function(c){c.stopPropagation();ccm_alSelectNone()});ccm_setupAdvancedSearch(a);if(b=="DASHBOARD"){$(".dialog-launch").dialog()}ccm_alLaunchType[a]=b;ccm_alSetupCheckboxes(a);ccm_alSetupFileProcessor();ccm_alSetupSingleUploadForm();$("form#ccm-"+a+"-advanced-search select[name=fssID]").change(function(){if(b=="DASHBOARD"){window.location.href=CCM_DISPATCHER_FILENAME+"/dashboard/files/search?fssID="+$(this).val()}else{jQuery.fn.dialog.showLoader();var c=$("div#ccm-"+a+"-overlay-wrapper input[name=dialogAction]").val()+"&refreshDialog=1&fssID="+$(this).val();$.get(c,function(d){jQuery.fn.dialog.hideLoader();$("div#ccm-"+a+"-overlay-wrapper").html(d);$("div#ccm-"+a+"-overlay-wrapper a.dialog-launch").dialog()})}});ccm_searchActivatePostFunction[a]=function(){ccm_alSetupCheckboxes(a);ccm_alSetupSelectFiles();ccm_alSetupSingleUploadForm()}};ccm_alSetupSingleUploadForm=function(){$(".ccm-file-manager-submit-single").submit(function(){$(this).attr("target",ccm_alProcessorTarget);ccm_alSubmitSingle($(this).get(0))})};ccm_activateFileSelectors=function(){$(".ccm-file-manager-launch").unbind();$(".ccm-file-manager-launch").click(function(){ccm_alLaunchSelectorFileManager($(this).parent().attr("ccm-file-manager-field"))})};ccm_alLaunchSelectorFileManager=function(a){ccm_alActiveAssetField=a;var c="";var b=$("#"+a+"-fm-display input.ccm-file-manager-filter");if(b.length){for(i=0;i<b.length;i++){c+="&"+$(b[i]).attr("name")+"="+$(b[i]).attr("value")}}ccm_launchFileManager(c)};ccm_launchFileManager=function(a){$.fn.dialog.open({width:"90%",height:"70%",appendButtons:true,modal:false,href:CCM_TOOLS_PATH+"/files/search_dialog?ocID="+CCM_CID+"&search=1"+a,title:ccmi18n_filemanager.title})};ccm_launchFileSetPicker=function(a){$.fn.dialog.open({width:500,height:160,modal:false,href:CCM_TOOLS_PATH+"/files/pick_set?oldFSID="+a,title:ccmi18n_filemanager.sets})};ccm_alSubmitSetsForm=function(a){ccm_deactivateSearchResults(a);jQuery.fn.dialog.showLoader();$("#ccm-"+a+"-add-to-set-form").ajaxSubmit(function(b){jQuery.fn.dialog.closeTop();jQuery.fn.dialog.hideLoader();$("#ccm-"+a+"-advanced-search").ajaxSubmit(function(c){$("#ccm-"+a+"-sets-search-wrapper").load(CCM_TOOLS_PATH+"/files/search_sets_reload",{searchInstance:a},function(){$(".chosen-select").chosen();ccm_parseAdvancedSearchResponse(c,a)})})})};ccm_alSubmitPasswordForm=function(a){ccm_deactivateSearchResults(a);$("#ccm-"+a+"-password-form").ajaxSubmit(function(b){jQuery.fn.dialog.closeTop();$("#ccm-"+a+"-advanced-search").ajaxSubmit(function(c){ccm_parseAdvancedSearchResponse(c,a)})})};ccm_alSubmitStorageForm=function(a){ccm_deactivateSearchResults(a);$("#ccm-"+a+"-storage-form").ajaxSubmit(function(b){jQuery.fn.dialog.closeTop();$("#ccm-"+a+"-advanced-search").ajaxSubmit(function(c){ccm_parseAdvancedSearchResponse(c,a)})})};ccm_alSubmitPermissionsForm=function(a){ccm_deactivateSearchResults(a);$("#ccm-"+a+"-permissions-form").ajaxSubmit(function(b){jQuery.fn.dialog.closeTop();$("#ccm-"+a+"-advanced-search").ajaxSubmit(function(c){ccm_parseAdvancedSearchResponse(c,a)})})};ccm_alSetupSetsForm=function(a){$("#fsAddToSearchName").liveUpdate("ccm-file-search-add-to-sets-list","fileset");$(".ccm-file-set-add-cb a").each(function(){var b=$(this);var c=b.attr("ccm-tri-state-startup");$(this).click(function(){var d=$(this).attr("ccm-tri-state-selected");var e=0;switch(d){case"0":if(c=="1"){e="1"}else{e="2"}break;case"1":e="2";break;case"2":e="0";break}$(this).attr("ccm-tri-state-selected",e);$(this).find("input").val(e);$(this).find("img").attr("src",CCM_IMAGE_PATH+"/checkbox_state_"+e+".png")})});$("#ccm-"+a+"-add-to-set-form input[name=fsNew]").click(function(){if(!$(this).prop("checked")){$("#ccm-"+a+"-add-to-set-form input[name=fsNewText]").val("")}});$("#ccm-"+a+"-add-to-set-form").submit(function(){ccm_alSubmitSetsForm(a);return false})};ccm_alSetupPasswordForm=function(){$("#ccm-file-password-form").submit(function(){ccm_alSubmitPasswordForm();return false})};ccm_alRescanFiles=function(){var b=CCM_TOOLS_PATH+"/files/rescan?";var a=arguments;for(i=0;i<a.length;i++){b+="fID[]="+a[i]+"&"}$.fn.dialog.open({title:ccmi18n_filemanager.rescan,href:b,width:350,modal:false,height:200,onClose:function(){if(a.length==1){$("#ccm-file-properties-wrapper").html("");jQuery.fn.dialog.showLoader();$("#ccm-file-properties-wrapper").load(CCM_TOOLS_PATH+"/files/properties?fID="+a[0]+"&reload=1",false,function(){jQuery.fn.dialog.hideLoader();$(this).find(".dialog-launch").dialog()})}}})};ccm_alSelectPermissionsEntity=function(a,f,b){var d=$("#ccm-file-permissions-entity-base").html();$("#ccm-file-permissions-entities-wrapper").append('<div class="ccm-file-permissions-entity">'+d+"</div>");var e=$(".ccm-file-permissions-entity");var c=e[e.length-1];$(c).find("h3 span").html(b);$(c).find("input[type=hidden]").val(a+"_"+f);$(c).find("select").each(function(){$(this).attr("name",$(this).attr("name")+"_"+a+"_"+f)});$(c).find("div.ccm-file-access-extensions input[type=checkbox]").each(function(){$(this).attr("name",$(this).attr("name")+"_"+a+"_"+f+"[]")});ccm_alActivateFilePermissionsSelector()};ccm_alActivateFilePermissionsSelector=function(){$(".ccm-file-access-add select").unbind();$(".ccm-file-access-add select").change(function(){var a=$(this).parents("div.ccm-file-permissions-entity")[0];if($(this).val()==ccmi18n_filemanager.PTYPE_CUSTOM){$(a).find("div.ccm-file-access-add-extensions").show()}else{$(a).find("div.ccm-file-access-add-extensions").hide()}});$(".ccm-file-access-file-manager select").change(function(){var a=$(this).parents("div.ccm-file-permissions-entity")[0];if($(this).val()!=ccmi18n_filemanager.PTYPE_NONE){$(a).find(".ccm-file-access-add").show();$(a).find(".ccm-file-access-edit").show();$(a).find(".ccm-file-access-admin").show()}else{$(a).find(".ccm-file-access-add").hide();$(a).find(".ccm-file-access-edit").hide();$(a).find(".ccm-file-access-admin").hide();$(a).find("div.ccm-file-access-add-extensions").hide()}});$("a.ccm-file-permissions-remove").click(function(){$(this).parent().parent().fadeOut(100,function(){$(this).remove()})});$("input[name=toggleCanAddExtension]").unbind();$("input[name=toggleCanAddExtension]").click(function(){var a=$(this).parent().parent().find("div.ccm-file-access-extensions");if($(this).prop("checked")==1){a.find("input").attr("checked",true)}else{a.find("input").attr("checked",false)}})};ccm_alSetupVersionSelector=function(){$("#ccm-file-versions-grid input[type=radio]").click(function(){$("#ccm-file-versions-grid tr").removeClass("ccm-file-versions-grid-active");var a=$(this).parent().parent();var d=a.attr("fID");var b=a.attr("fvID");var c="task=approve_version&fID="+d+"&fvID="+b;$.post(CCM_TOOLS_PATH+"/files/properties",c,function(e){a.addClass("ccm-file-versions-grid-active");a.find("td").show("highlight",{color:"#FFF9BB"})})});$(".ccm-file-versions-remove").click(function(){var a=$(this).parent().parent();var d=a.attr("fID");var b=a.attr("fvID");var c="task=delete_version&fID="+d+"&fvID="+b;$.post(CCM_TOOLS_PATH+"/files/properties",c,function(e){a.fadeOut(200,function(){a.remove()})});return false})};ccm_alDeleteFiles=function(a){$("#ccm-"+a+"-delete-form").ajaxSubmit(function(b){ccm_parseJSON(b,function(){jQuery.fn.dialog.closeTop();ccm_deactivateSearchResults(a);$("#ccm-"+a+"-advanced-search").ajaxSubmit(function(c){ccm_parseAdvancedSearchResponse(c,a)})})})};ccm_alDuplicateFiles=function(searchInstance){$("#ccm-"+searchInstance+"-duplicate-form").ajaxSubmit(function(resp){ccm_parseJSON(resp,function(){jQuery.fn.dialog.closeTop();ccm_deactivateSearchResults(searchInstance);var r=eval("("+resp+")");$("#ccm-"+searchInstance+"-advanced-search").ajaxSubmit(function(resp){ccm_parseAdvancedSearchResponse(resp,searchInstance);var highlight=new Array();for(i=0;i<r.fID.length;i++){fID=r.fID[i];ccm_uploadedFiles.push(fID);highlight.push(fID)}ccm_alRefresh(highlight,searchInstance);ccm_filesUploadedDialog(searchInstance)})})})};ccm_alSetupSelectFiles=function(){$(".ccm-file-list").unbind();$(".ccm-file-list tr.ccm-list-record").click(function(a){a.stopPropagation();ccm_alActivateMenu($(this),a)});$(".ccm-file-list img.ccm-star").click(function(a){a.stopPropagation();var b=$(a.target).parents("tr.ccm-list-record")[0].id;b=b.substring(3);ccm_starFile(a.target,b)});$(".ccm-file-list-thumbnail").hover(function(c){var f=$(this).attr("fID");var b=$("#fID"+f+"hoverThumbnail");if(b.length>0){var a=b.find("div");var d=b.position();a.css("top",d.top);a.css("left",d.left);a.show()}},function(){var c=$(this).attr("fID");var b=$("#fID"+c+"hoverThumbnail");var a=b.find("div");a.hide()})};ccm_alSetupCheckboxes=function(a){$("#ccm-"+a+"-list-cb-all").unbind();$("#ccm-"+a+"-list-cb-all").click(function(){ccm_hideMenus();if($(this).prop("checked")==true){$("#ccm-"+a+"-search-results td.ccm-file-list-cb input[type=checkbox]").attr("checked",true);$("#ccm-"+a+"-list-multiple-operations").attr("disabled",false)}else{$("#ccm-"+a+"-search-results td.ccm-file-list-cb input[type=checkbox]").attr("checked",false);$("#ccm-"+a+"-list-multiple-operations").attr("disabled",true)}});$("#ccm-"+a+"-search-results td.ccm-file-list-cb input[type=checkbox]").click(function(c){c.stopPropagation();ccm_hideMenus();ccm_alRescanMultiFileMenu(a)});$("#ccm-"+a+"-search-results td.ccm-file-list-cb").click(function(c){c.stopPropagation();ccm_hideMenus();$(this).find("input[type=checkbox]").click();ccm_alRescanMultiFileMenu(a)});if(ccm_alLaunchType[a]!="DASHBOARD"&&ccm_alLaunchType[a]!="BROWSE"){var b=ccmi18n_filemanager.select;$("#ccm-"+a+"-list-multiple-operations option:eq(0)").after('<option value="choose">'+b+"</option>")}$("#ccm-"+a+"-list-multiple-operations").change(function(){var e=$(this).val();var c=ccm_alGetSelectedFileIDs(a);switch(e){case"choose":var d=new Array();$("#ccm-"+a+"-search-results td.ccm-file-list-cb input[type=checkbox]:checked").each(function(){d.push($(this).val())});ccm_alSelectFile(d,true);break;case"delete":jQuery.fn.dialog.open({width:500,height:400,modal:false,appendButtons:true,href:CCM_TOOLS_PATH+"/files/delete?"+c+"&searchInstance="+a,title:ccmi18n_filemanager.deleteFile});break;case"duplicate":jQuery.fn.dialog.open({width:500,height:400,modal:false,href:CCM_TOOLS_PATH+"/files/duplicate?"+c+"&searchInstance="+a,title:ccmi18n_filemanager.duplicateFile});break;case"sets":jQuery.fn.dialog.open({width:500,height:400,modal:false,href:CCM_TOOLS_PATH+"/files/add_to?"+c+"&searchInstance="+a,title:ccmi18n_filemanager.sets});break;case"properties":jQuery.fn.dialog.open({width:690,height:440,modal:false,href:CCM_TOOLS_PATH+"/files/bulk_properties?"+c+"&searchInstance="+a,title:ccmi18n.properties});break;case"rescan":jQuery.fn.dialog.open({width:350,height:200,modal:false,href:CCM_TOOLS_PATH+"/files/rescan?"+c+"&searchInstance="+a,title:ccmi18n_filemanager.rescan,onClose:function(){$("#ccm-"+a+"-advanced-search").submit()}});break;case"download":window.frames[ccm_alProcessorTarget].location=CCM_TOOLS_PATH+"/files/download?"+c;break}$(this).get(0).selectedIndex=0});ccm_alSetupFileSetSearch(a)};ccm_alSetupFileSetSearch=function(a){$("#ccm-"+a+"-sets-search-wrapper select").chosen().unbind();$("#ccm-"+a+"-sets-search-wrapper select").chosen().change(function(){var b=$("#ccm-"+a+"-sets-search-wrapper option:selected");$("#ccm-"+a+"-advanced-search").submit()})};ccm_alGetSelectedFileIDs=function(a){var b="";$("#ccm-"+a+"-search-results td.ccm-file-list-cb input[type=checkbox]:checked").each(function(){b+="fID[]="+$(this).val()+"&"});return b};ccm_alRescanMultiFileMenu=function(a){if($("#ccm-"+a+"-search-results td.ccm-file-list-cb input[type=checkbox]:checked").length>0){$("#ccm-"+a+"-list-multiple-operations").attr("disabled",false)}else{$("#ccm-"+a+"-list-multiple-operations").attr("disabled",true)}};ccm_alSetupFileProcessor=function(){if(ccm_alProcessorTarget!=""){return false}var b=parseInt(new Date().getTime().toString().substring(0,10));var c;try{c=document.createElement('<iframe name="ccm-al-upload-processor'+b+'">')}catch(a){c=document.createElement("iframe")}c.id="ccm-al-upload-processor"+b;c.name="ccm-al-upload-processor"+b;c.style.border="0px";c.style.width="0px";c.style.height="0px";c.style.display="none";document.body.appendChild(c);if(ccm_alDebug){ccm_alProcessorTarget="_blank"}else{ccm_alProcessorTarget="ccm-al-upload-processor"+b}};ccm_alSubmitSingle=function(a){if($(a).find(".ccm-al-upload-single-file").val()==""){return false}else{$(a).find(".ccm-al-upload-single-submit").hide();$(a).find(".ccm-al-upload-single-loader").show()}};ccm_alResetSingle=function(){$(".ccm-al-upload-single-file").val("");$(".ccm-al-upload-single-loader").hide();$(".ccm-al-upload-single-submit").show()};var ccm_uploadedFiles=[];ccm_filesUploadedDialog=function(c){if(document.getElementById("ccm-file-upload-multiple-tab")){jQuery.fn.dialog.closeTop()}var a="";for(var b=0;b<ccm_uploadedFiles.length;b++){a=a+"&fID[]="+ccm_uploadedFiles[b]}jQuery.fn.dialog.open({width:690,height:440,modal:false,href:CCM_TOOLS_PATH+"/files/bulk_properties/?"+a+"&uploaded=true&searchInstance="+c,onClose:function(){ccm_deactivateSearchResults(c);$("#ccm-"+c+"-advanced-search").ajaxSubmit(function(d){ccm_parseAdvancedSearchResponse(d,c)})},title:ccmi18n_filemanager.uploadComplete});ccm_uploadedFiles=[]};ccm_alSetupUploadDetailsForm=function(a){$("#ccm-"+a+"-update-uploaded-details-form").submit(function(){ccm_alSubmitUploadDetailsForm(a);return false})};ccm_alSubmitUploadDetailsForm=function(searchInstance){jQuery.fn.dialog.showLoader();$("#ccm-"+searchInstance+"-update-uploaded-details-form").ajaxSubmit(function(r1){var r1a=eval("("+r1+")");var form=$("#ccm-"+searchInstance+"-advanced-search");if(form.length>0){form.ajaxSubmit(function(resp){$("#ccm-"+searchInstance+"-sets-search-wrapper").load(CCM_TOOLS_PATH+"/files/search_sets_reload",{searchInstance:searchInstance},function(){jQuery.fn.dialog.hideLoader();jQuery.fn.dialog.closeTop();ccm_parseAdvancedSearchResponse(resp,searchInstance);ccm_alHighlightFileIDArray(r1a)})})}else{jQuery.fn.dialog.hideLoader();jQuery.fn.dialog.closeTop()}})};ccm_alRefresh=function(a,c,d){var b=a;ccm_deactivateSearchResults(c);$("#ccm-"+c+"-search-results").load(CCM_TOOLS_PATH+"/files/search_results",{ccm_order_by:"fvDateAdded",ccm_order_dir:"desc",fileSelector:d,searchType:ccm_alLaunchType[c],searchInstance:c},function(){ccm_activateSearchResults(c);if(b!=false){ccm_alHighlightFileIDArray(b)}ccm_alSetupSelectFiles()})};ccm_alHighlightFileIDArray=function(b){for(i=0;i<b.length;i++){var c=$("tr[fID="+b[i]+"] td");var a=c.css("backgroundColor");c.animate({backgroundColor:"#FFF9BB"},{queue:true,duration:1000}).animate({backgroundColor:a},500)}};ccm_alSelectFile=function(b){if(typeof(ccm_chooseAsset)=="function"){var a="";if(typeof(b)=="object"){for(i=0;i<b.length;i++){a+="fID[]="+b[i]+"&"}}else{a+="fID="+b}$.getJSON(CCM_TOOLS_PATH+"/files/get_data.php?"+a,function(c){ccm_parseJSON(c,function(){for(i=0;i<c.length;i++){ccm_chooseAsset(c[i])}jQuery.fn.dialog.closeTop()})})}else{if(typeof(b)=="object"){for(i=0;i<b.length;i++){ccm_triggerSelectFile(b[i])}}else{ccm_triggerSelectFile(b)}jQuery.fn.dialog.closeTop()}};ccm_alActivateMenu=function(c,k){var f=$(c).find("div[ccm-file-manager-field]");var b="";if(f.length>0){b=f.attr("ccm-file-manager-field")}if(!b){b=ccm_alActiveAssetField}ccm_hideMenus();var m=$(c).attr("fID");var q=$(c).attr("ccm-file-manager-instance");var n=document.getElementById("ccm-al-menu"+m+q+b);if(!n){el=document.createElement("DIV");el.id="ccm-al-menu"+m+q+b;el.className="ccm-menu ccm-ui";el.style.display="block";el.style.visibility="hidden";document.body.appendChild(el);var a=$("div[ccm-file-manager-field="+b+"] input.ccm-file-manager-filter");var l="";if(a.length>0){a.each(function(){l+="&"+$(this).attr("name")+"="+$(this).attr("value")})}var p=$(c).attr("al-filepath");n=$("#ccm-al-menu"+m+q+b);n.css("position","absolute");var d='<div class="popover"><div class="arrow"></div><div class="inner"><div class="content">';d+="<ul>";if(ccm_alLaunchType[q]!="DASHBOARD"&&ccm_alLaunchType[q]!="BROWSE"){var o=(f.length>0)?"ccm_alLaunchSelectorFileManager('"+b+"')":"ccm_alSelectFile("+m+")";var g=(f.length>0)?ccmi18n_filemanager.chooseNew:ccmi18n_filemanager.select;d+='<li><a class="ccm-menu-icon ccm-icon-choose-file-menu" dialog-modal="false" dialog-width="90%" dialog-height="70%" dialog-title="'+ccmi18n_filemanager.select+'" id="menuSelectFile'+m+'" href="javascript:void(0)" onclick="'+o+'">'+g+"</a></li>"}if(f.length>0){d+='<li><a class="ccm-menu-icon ccm-icon-clear-file-menu" href="javascript:void(0)" id="menuClearFile'+m+q+b+'">'+ccmi18n_filemanager.clear+"</a></li>"}if(ccm_alLaunchType[q]!="DASHBOARD"&&ccm_alLaunchType[q]!="BROWSE"&&f.length>0){d+='<li class="ccm-menu-separator"></li>'}if($(c).attr("ccm-file-manager-can-view")=="1"){d+='<li><a class="ccm-menu-icon ccm-icon-view dialog-launch" dialog-modal="false" dialog-append-buttons="true" dialog-width="90%" dialog-height="75%" dialog-title="'+ccmi18n_filemanager.view+'" id="menuView'+m+'" href="'+CCM_TOOLS_PATH+"/files/view?fID="+m+'">'+ccmi18n_filemanager.view+"</a></li>"}else{d+='<li><a class="ccm-menu-icon ccm-icon-download-menu" href="javascript:void(0)" id="menuDownload'+m+'" onclick="window.frames[\''+ccm_alProcessorTarget+"'].location='"+CCM_TOOLS_PATH+"/files/download?fID="+m+"'\">"+ccmi18n_filemanager.download+"</a></li>"}if($(c).attr("ccm-file-manager-can-edit")=="1"){d+='<li><a class="ccm-menu-icon ccm-icon-edit-menu dialog-launch" dialog-modal="false" dialog-width="90%" dialog-height="75%" dialog-title="'+ccmi18n_filemanager.edit+'" id="menuEdit'+m+'" href="'+CCM_TOOLS_PATH+"/files/edit?searchInstance="+q+"&fID="+m+l+'">'+ccmi18n_filemanager.edit+"</a></li>"}d+='<li><a class="ccm-menu-icon ccm-icon-properties-menu dialog-launch" dialog-modal="false" dialog-width="680" dialog-height="450" dialog-title="'+ccmi18n_filemanager.properties+'" id="menuProperties'+m+'" href="'+CCM_TOOLS_PATH+"/files/properties?searchInstance="+q+"&fID="+m+'">'+ccmi18n_filemanager.properties+"</a></li>";if($(c).attr("ccm-file-manager-can-replace")=="1"){d+='<li><a class="ccm-menu-icon ccm-icon-replace dialog-launch" dialog-modal="false" dialog-width="300" dialog-height="260" dialog-title="'+ccmi18n_filemanager.replace+'" id="menuFileReplace'+m+'" href="'+CCM_TOOLS_PATH+"/files/replace?searchInstance="+q+"&fID="+m+'">'+ccmi18n_filemanager.replace+"</a></li>"}if($(c).attr("ccm-file-manager-can-duplicate")=="1"){d+='<li><a class="ccm-menu-icon ccm-icon-copy-menu" id="menuFileDuplicate'+m+'" href="javascript:void(0)" onclick="ccm_alDuplicateFile('+m+",'"+q+"')\">"+ccmi18n_filemanager.duplicate+"</a></li>"}d+='<li><a class="ccm-menu-icon ccm-icon-sets dialog-launch" dialog-modal="false" dialog-width="500" dialog-height="400" dialog-title="'+ccmi18n_filemanager.sets+'" id="menuFileSets'+m+'" href="'+CCM_TOOLS_PATH+"/files/add_to?searchInstance="+q+"&fID="+m+'">'+ccmi18n_filemanager.sets+"</a></li>";if($(c).attr("ccm-file-manager-can-admin")=="1"||$(c).attr("ccm-file-manager-can-delete")=="1"){d+='<li class="ccm-menu-separator"></li>'}if($(c).attr("ccm-file-manager-can-admin")=="1"){d+='<li><a class="ccm-menu-icon ccm-icon-access-permissions dialog-launch" dialog-modal="false" dialog-width="400" dialog-height="380" dialog-title="'+ccmi18n_filemanager.permissions+'" id="menuFilePermissions'+m+'" href="'+CCM_TOOLS_PATH+"/files/permissions?searchInstance="+q+"&fID="+m+'">'+ccmi18n_filemanager.permissions+"</a></li>"}if($(c).attr("ccm-file-manager-can-delete")=="1"){d+='<li><a class="ccm-icon-delete-menu ccm-menu-icon dialog-launch" dialog-append-buttons="true" dialog-modal="false" dialog-width="500" dialog-height="200" dialog-title="'+ccmi18n_filemanager.deleteFile+'" id="menuDeleteFile'+m+'" href="'+CCM_TOOLS_PATH+"/files/delete?searchInstance="+q+"&fID="+m+'">'+ccmi18n_filemanager.deleteFile+"</a></li>"}d+="</ul>";d+="</div></div></div>";n.append(d);$(n).find("a").bind("click.hide-menu",function(s){ccm_hideMenus();return false});$("#ccm-al-menu"+m+q+b+" a.dialog-launch").dialog();$("a#menuClearFile"+m+q+b).click(function(s){ccm_clearFile(s,b);ccm_hideMenus()})}else{n=$("#ccm-al-menu"+m+q+b)}ccm_fadeInMenu(n,k)};ccm_alSelectNone=function(){ccm_hideMenus()};var checkbox_status=false;toggleCheckboxStatus=function(a){if(checkbox_status){for(i=0;i<a.elements.length;i++){if(a.elements[i].type=="checkbox"){a.elements[i].checked=false}}checkbox_status=false}else{for(i=0;i<a.elements.length;i++){if(a.elements[i].type=="checkbox"){a.elements[i].checked=true}}checkbox_status=true}};ccm_alDuplicateFile=function(fID,searchInstance){var postStr="fID="+fID+"&searchInstance="+searchInstance;$.post(CCM_TOOLS_PATH+"/files/duplicate",postStr,function(resp){var r=eval("("+resp+")");if(r.error==1){ccmAlert.notice(ccmi18n.error,r.message);return false}var highlight=new Array();if(r.fID){highlight.push(r.fID);ccm_alRefresh(highlight,searchInstance);ccm_uploadedFiles.push(r.fID);ccm_filesUploadedDialog(searchInstance)}})};ccm_alSelectMultipleIncomingFiles=function(a){if($(a).prop("checked")){$("input.ccm-file-select-incoming").attr("checked",true)}else{$("input.ccm-file-select-incoming").attr("checked",false)}};ccm_starFile=function(a,c){var b="";if($(a).attr("src").indexOf(CCM_STAR_STATES.unstarred)!=-1){$(a).attr("src",$(a).attr("src").replace(CCM_STAR_STATES.unstarred,CCM_STAR_STATES.starred));b="star"}else{$(a).attr("src",$(a).attr("src").replace(CCM_STAR_STATES.starred,CCM_STAR_STATES.unstarred));b="unstar"}$.post(CCM_TOOLS_PATH+"/"+CCM_STAR_ACTION,{action:b,"file-id":c},function(d,e){})};(function(a){a.fn.cropzoom=function(b){return this.each(function(){var e=null;var H=null;var c=null;var d=null;var F=null;var q={width:500,height:375,bgColor:"#000",overlayColor:"#000",selector:{x:0,y:0,w:229,h:100,aspectRatio:false,centered:false,borderColor:"yellow",borderColorHover:"red",bgInfoLayer:"#FFF",infoFontSize:10,infoFontColor:"blue",showPositionsOnDrag:true,showDimetionsOnDrag:true,maxHeight:null,maxWidth:null,minHeight:null,minWidth:null,startWithOverlay:false,hideOverlayOnDragAndResize:true,onSelectorDrag:null,onSelectorDragStop:null,onSelectorResize:null,onSelectorResizeStop:null},image:{source:"",rotation:0,width:0,height:0,minZoom:10,maxZoom:150,startZoom:0,x:0,y:0,useStartZoomAsMinZoom:false,snapToContainer:false,onZoom:null,onRotate:null,onImageDrag:null},enableRotation:true,enableZoom:true,zoomSteps:1,rotationSteps:5,expose:{slidersOrientation:"vertical",zoomElement:"",rotationElement:"",elementMovement:"",movementSteps:5}};var v=a.extend(true,q,b);if(!a.isFunction(a.fn.draggable)||!a.isFunction(a.fn.resizable)||!a.isFunction(a.fn.slider)){alert("You must include ui.draggable, ui.resizable and ui.slider to use cropZoom");return}if(v.image.source==""||v.image.width==0||v.image.height==0){alert("You must set the source, witdth and height of the image element");return}e=a(this);e.empty();e.css({width:v.width,height:v.height,"background-color":v.bgColor,overflow:"hidden",position:"relative",border:"2px solid #333"});f("image",{h:v.image.height,w:v.image.width,posY:v.image.y,posX:v.image.x,scaleX:0,scaleY:0,rotation:v.image.rotation,source:v.image.source,bounds:[0,0,0,0],id:"image_to_crop_"+e[0].id});A();m();f("selector",{x:v.selector.x,y:v.selector.y,w:(v.selector.maxWidth!=null?(v.selector.w>v.selector.maxWidth?v.selector.maxWidth:v.selector.w):v.selector.w),h:(v.selector.maxHeight!=null?(v.selector.h>v.selector.maxHeight?v.selector.maxHeight:v.selector.h):v.selector.h)});if(a.browser.msie){e[0].ownerDocument.namespaces.add("v","urn:schemas-microsoft-com:vml","#default#VML");var y=document.createStyleSheet();y.addRule("v\\:image","behavior: url(#default#VML);display:inline-block");y.addRule("v\\:image","antiAlias: false;");F=a("<div />").attr("id","k").css({width:v.width,height:v.height,position:"absolute"});if(a.support.leadingWhitespace){d=document.createElement("img")}else{d=document.createElement("v:image")}d.setAttribute("src",v.image.source);d.setAttribute("gamma","0");a(d).css({position:"absolute",left:s("image").posX,top:s("image").posY,width:s("image").w,height:s("image").h});d.setAttribute("coordsize","21600,21600");d.outerHTML=d.outerHTML;var g=t();if(g=="png"||g=="gif"){d.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+v.image.source+"',sizingMethod='scale');"}F.append(d)}else{F=e[0].ownerDocument.createElementNS("http://www.w3.org/2000/svg","svg");F.setAttribute("id","k");F.setAttribute("width",v.width);F.setAttribute("height",v.height);F.setAttribute("preserveAspectRatio","none");d=e[0].ownerDocument.createElementNS("http://www.w3.org/2000/svg","image");d.setAttributeNS("http://www.w3.org/1999/xlink","href",v.image.source);d.setAttribute("width",s("image").w);d.setAttribute("height",s("image").h);d.setAttribute("preserveAspectRatio","none");a(d).attr("x",0);a(d).attr("y",0);F.appendChild(d)}e.append(F);G();a(d).draggable({refreshPositions:true,start:function(I,J){},drag:function(I,J){s("image").posY=J.position.top;s("image").posX=J.position.left;if(v.image.snapToContainer){z(J)}else{G()}if(v.image.onImageDrag!=null){v.image.onImageDrag(d)}},stop:function(I,J){if(v.image.snapToContainer){z(J)}}});l();e.find(".ui-icon-gripsmall-diagonal-se").css({background:"#FFF",border:"1px solid #000",width:8,height:8});p();if(v.selector.startWithOverlay){var u={position:{top:c.position().top,left:c.position().left}};D(u)}if(v.enableZoom){o()}if(v.enableRotation){x()}if(v.expose.elementMovement!=""){B()}function z(K){if(K.position.top>0){s("image").posY=0}if(K.position.left>0){s("image").posX=0}var I=-(s("image").h-K.helper.parent().parent().height()),J=-(s("image").w-K.helper.parent().parent().width());if(K.position.top<I){s("image").posY=I}if(K.position.left<J){s("image").posX=J}G()}function t(){var I=v.image.source.split(".");return I[I.length-1]}function A(){s("image").scaleX=(v.width/s("image").w);s("image").scaleY=(v.height/s("image").h)}function m(){if(v.image.startZoom!=0){var L=((v.image.width*Math.abs(v.image.startZoom))/100);var K=((v.image.height*Math.abs(v.image.startZoom))/100);s("image").h=K;s("image").w=L;if(s("image").posY!=0&&s("image").posX!=0){if(s("image").h>v.height){s("image").posY=Math.abs((v.height/2)-(s("image").h/2))}else{s("image").posY=((v.height/2)-(s("image").h/2))}if(s("image").w>v.width){s("image").posX=Math.abs((v.width/2)-(s("image").w/2))}else{s("image").posX=((v.width/2)-(s("image").w/2))}}}else{var J=s("image").scaleX;var I=s("image").scaleY;if(I<J){s("image").h=v.height;s("image").w=Math.round(s("image").w*I)}else{s("image").h=Math.round(s("image").h*J);s("image").w=v.width}}if(s("image").w<v.width&&s("image").h<v.height){v.image.snapToContainer=false}G()}function G(){var J="";var I="";a(function(){if(a.browser.msie){if(a.support.leadingWhitespace){J="rotate("+s("image").rotation+"deg)";a(d).css({msTransform:J,top:s("image").posY,left:s("image").posX})}else{J=s("image").rotation;a(d).css({rotation:J,top:s("image").posY,left:s("image").posX})}}else{J="rotate("+s("image").rotation+","+(s("image").posX+(s("image").w/2))+","+(s("image").posY+(s("image").h/2))+")";I=" translate("+s("image").posX+","+s("image").posY+")";J+=I;a(d).attr("transform",J)}})}function x(){var N=a("<div />").attr("id","rotationContainer").mouseover(function(){a(this).css("opacity",1)}).mouseout(function(){a(this).css("opacity",0.6)});var L=a("<div />").attr("id","rotationMin").html("0");var J=a("<div />").attr("id","rotationMax").html("360");var M=a("<div />").attr("id","rotationSlider");var I="vertical";var K=Math.abs(360-v.image.rotation);if(v.expose.slidersOrientation=="horizontal"){I="horizontal";K=v.image.rotation}M.slider({orientation:I,value:K,range:"max",min:0,max:359,step:((v.rotationSteps>360||v.rotationSteps<0)?1:v.rotationSteps),slide:function(O,P){s("image").rotation=(K==360?Math.abs(360-P.value):Math.abs(P.value));G();if(v.image.onRotate!=null){v.image.onRotate(M,s("image").rotation)}},change:function(O,P){s("image").rotation=(K==360?Math.abs(360-P.value):Math.abs(P.value));G();if(v.image.onRotate!=null){v.image.onRotate(M,s("image").rotation)}}});N.append(L);N.append(M);N.append(J);if(v.expose.rotationElement!=""){M.addClass(v.expose.slidersOrientation);N.addClass(v.expose.slidersOrientation);L.addClass(v.expose.slidersOrientation);J.addClass(v.expose.slidersOrientation);a(v.expose.rotationElement).append(N)}else{M.addClass("vertical");N.addClass("vertical");L.addClass("vertical");J.addClass("vertical");N.css({position:"absolute",top:5,left:5,opacity:0.6});e.append(N)}}function o(){var J=a("<div />").attr("id","zoomContainer").mouseover(function(){a(this).css("opacity",1)}).mouseout(function(){a(this).css("opacity",0.6)});var I=a("<div />").attr("id","zoomMin").html("<b>-</b>");var L=a("<div />").attr("id","zoomMax").html("<b>+</b>");var K=a("<div />").attr("id","zoomSlider");K.slider({orientation:(v.expose.zoomElement!=""?v.expose.slidersOrientation:"vertical"),value:(v.image.startZoom!=0?v.image.startZoom:k(s("image"))),min:(v.image.useStartZoomAsMinZoom?v.image.startZoom:v.image.minZoom),max:v.image.maxZoom,step:((v.zoomSteps>v.image.maxZoom||v.zoomSteps<0)?1:v.zoomSteps),slide:function(N,R){var S=(v.expose.slidersOrientation=="vertical"?(v.image.maxZoom-R.value):R.value);var Q=(v.image.width*Math.abs(S)/100);var T=(v.image.height*Math.abs(S)/100);if(a.browser.msie){a(d).css({width:Q+"px",height:T+"px"})}else{a(d).attr("width",Q+"px");a(d).attr("height",T+"px")}var P=(s("image").w/2)-(Q/2);var O=(s("image").h/2)-(T/2);var M=(P>0?s("image").posX+Math.abs(P):s("image").posX-Math.abs(P));var U=(O>0?s("image").posY+Math.abs(O):s("image").posY-Math.abs(O));s("image").posX=M;s("image").posY=U;s("image").w=Q;s("image").h=T;A();G();if(v.image.onZoom!=null){v.image.onZoom(d,s("image"))}}});if(v.slidersOrientation=="vertical"){J.append(L);J.append(K);J.append(I)}else{J.append(I);J.append(K);J.append(L)}if(v.expose.zoomElement!=""){I.addClass(v.expose.slidersOrientation);L.addClass(v.expose.slidersOrientation);K.addClass(v.expose.slidersOrientation);J.addClass(v.expose.slidersOrientation);a(v.expose.zoomElement).append(J)}else{I.addClass("vertical");L.addClass("vertical");K.addClass("vertical");J.addClass("vertical");J.css({position:"absolute",top:5,right:5,opacity:0.6});e.append(J)}}function k(){var I=0;if(s("image").w>s("image").h){I=v.image.maxZoom-((s("image").w*100)/v.image.width)}else{I=v.image.maxZoom-((s("image").h*100)/v.image.height)}if(v.expose.slidersOrientation=="horizontal"){I=v.image.maxZoom-I}return I}function l(){if(v.selector.centered){s("selector").y=(v.height/2)-(s("selector").h/2);s("selector").x=(v.width/2)-(s("selector").w/2)}c=a("<div />").attr("id",e[0].id+"_selector").css({width:s("selector").w,height:s("selector").h,top:s("selector").y+"px",left:s("selector").x+"px",border:"1px dashed "+v.selector.borderColor,position:"absolute",cursor:"move"}).mouseover(function(){a(this).css({border:"1px dashed "+v.selector.borderColorHover})}).mouseout(function(){a(this).css({border:"1px dashed "+v.selector.borderColor})});c.draggable({containment:"parent",iframeFix:true,refreshPositions:true,drag:function(I,J){s("selector").x=J.position.left;s("selector").y=J.position.top;D(J);n();if(v.selector.onSelectorDrag!=null){v.selector.onSelectorDrag(c,s("selector"))}},stop:function(I,J){if(v.selector.hideOverlayOnDragAndResize){C()}if(v.selector.onSelectorDragStop!=null){v.selector.onSelectorDragStop(c,s("selector"))}}});c.resizable({aspectRatio:v.selector.aspectRatio,maxHeight:v.selector.maxHeight,maxWidth:v.selector.maxWidth,minHeight:v.selector.minHeight,minWidth:v.selector.minWidth,containment:"parent",resize:function(I,J){s("selector").w=c.width();s("selector").h=c.height();D(J);n();if(v.selector.onSelectorResize!=null){v.selector.onSelectorResize(c,s("selector"))}},stop:function(I,J){if(v.selector.hideOverlayOnDragAndResize){C()}if(v.selector.onSelectorResizeStop!=null){v.selector.onSelectorResizeStop(c,s("selector"))}}});n(c);e.append(c)}function n(){var I=null;var J=false;if(c.find("#infoSelector").length>0){I=c.find("#infoSelector")}else{I=a("<div />").attr("id","infoSelector").css({position:"absolute",top:0,left:0,background:v.selector.bgInfoLayer,opacity:0.6,"font-size":v.selector.infoFontSize+"px","font-family":"Arial",color:v.selector.infoFontColor,width:"100%"})}if(v.selector.showPositionsOnDrag){I.html("X:"+Math.round(s("selector").x)+"px - Y:"+Math.round(s("selector").y)+"px");J=true}if(v.selector.showDimetionsOnDrag){if(J){I.html(I.html()+" | W:"+s("selector").w+"px - H:"+s("selector").h+"px")}else{I.html("W:"+s("selector").w+"px - H:"+s("selector").h+"px")}}c.append(I)}function p(){var I=["t","b","l","r"];a.each(I,function(){var J=a("<div />").attr("id",this).css({overflow:"hidden",background:v.overlayColor,opacity:0.6,position:"absolute","z-index":2,visibility:"visible"});e.append(J)})}function D(I){e.find("#t").css({display:"block",width:v.width,height:I.position.top,left:0,top:0});e.find("#b").css({display:"block",width:v.width,height:v.height,top:(I.position.top+c.height())+"px",left:0});e.find("#l").css({display:"block",left:0,top:I.position.top,width:I.position.left,height:c.height()});e.find("#r").css({display:"block",top:I.position.top,left:(I.position.left+c.width())+"px",width:v.width,height:c.height()+"px"})}function C(){e.find("#t").hide();e.find("#b").hide();e.find("#l").hide();e.find("#r").hide()}function f(I,J){e.data(I,J)}function s(I){return e.data(I)}function B(){var K=a("<table>                <tr>                <td></td>                <td></td>                <td></td>                </tr>                <tr>                <td></td>                <td></td>                <td></td>                </tr>                <tr>                <td></td>                <td></td>                <td></td>                </tr>                </table>");var J=[];J.push(a("<div />").addClass("mvn_no mvn"));J.push(a("<div />").addClass("mvn_n mvn"));J.push(a("<div />").addClass("mvn_ne mvn"));J.push(a("<div />").addClass("mvn_o mvn"));J.push(a("<div />").addClass("mvn_c"));J.push(a("<div />").addClass("mvn_e mvn"));J.push(a("<div />").addClass("mvn_so mvn"));J.push(a("<div />").addClass("mvn_s mvn"));J.push(a("<div />").addClass("mvn_se mvn"));for(var I=0;I<J.length;I++){J[I].mousedown(function(){E(this)}).mouseup(function(){clearTimeout(H)});K.find("td:eq("+I+")").append(J[I]);a(v.expose.elementMovement).append(K)}}function E(K){if(a(K).hasClass("mvn_no")){s("image").posX=(s("image").posX-v.expose.movementSteps);s("image").posY=(s("image").posY-v.expose.movementSteps)}else{if(a(K).hasClass("mvn_n")){s("image").posY=(s("image").posY-v.expose.movementSteps)}else{if(a(K).hasClass("mvn_ne")){s("image").posX=(s("image").posX+v.expose.movementSteps);s("image").posY=(s("image").posY-v.expose.movementSteps)}else{if(a(K).hasClass("mvn_o")){s("image").posX=(s("image").posX-v.expose.movementSteps)}else{if(a(K).hasClass("mvn_c")){s("image").posX=(v.width/2)-(s("image").w/2);s("image").posY=(v.height/2)-(s("image").h/2)}else{if(a(K).hasClass("mvn_e")){s("image").posX=(s("image").posX+v.expose.movementSteps)}else{if(a(K).hasClass("mvn_so")){s("image").posX=(s("image").posX-v.expose.movementSteps);s("image").posY=(s("image").posY+v.expose.movementSteps)}else{if(a(K).hasClass("mvn_s")){s("image").posY=(s("image").posY+v.expose.movementSteps)}else{if(a(K).hasClass("mvn_se")){s("image").posX=(s("image").posX+v.expose.movementSteps);s("image").posY=(s("image").posY+v.expose.movementSteps)}}}}}}}}}if(v.image.snapToContainer){if(s("image").posY>0){s("image").posY=0}if(s("image").posX>0){s("image").posX=0}var I=-(s("image").h-e.height());var J=-(s("image").w-e.width());if(s("image").posY<I){s("image").posY=I}if(s("image").posX<J){s("image").posX=J}}G();H=setTimeout(function(){E(K)},100)}a.fn.cropzoom.getParameters=function(J,L){var M=J.data("image");var I=J.data("selector");var K={viewPortW:J.width(),viewPortH:J.height(),imageX:M.posX,imageY:M.posY,imageRotate:M.rotation,imageW:M.w,imageH:M.h,imageSource:M.source,selectorX:I.x,selectorY:I.y,selectorW:I.w,selectorH:I.h};return a.extend(K,L)};a.fn.cropzoom.getSelf=function(){return e};a.fn.cropzoom.getOptions=function(){return v};return this})};a.fn.extend({setSelector:function(c,g,d,f,e){var b=a(this);if(e!=undefined&&e==true){b.find("#"+b[0].id+"_selector").animate({top:g,left:c,width:d,height:f},"slow")}else{b.find("#"+b[0].id+"_selector").css({top:g,left:c,width:d,height:f})}b.data("selector",{x:c,y:g,w:d,h:f})},restore:function(){var c=a(this);var b=a(this).cropzoom.getOptions();a(c).empty();a(c).data("image",{});a(c).data("selector",{});if(b.expose.zoomElement!=""){a(b.expose.zoomElement).empty()}if(b.expose.rotationElement!=""){a(b.expose.rotationElement).empty()}if(b.expose.elementMovement!=""){a(b.expose.elementMovement).empty()}c.cropzoom(b)},send:function(d,e,f,g){var b=a(this);var c="";a.ajax({url:d,type:e,data:(b.cropzoom.getParameters(b,f)),success:function(k){b.data("imageResult",k);if(g!==undefined&&g!=null){g(k)}}})}})})(jQuery);function ccmLayout(cvalID,layout_id,area,locked){this.layout_id=layout_id;this.cvalID=cvalID;this.locked=locked;this.area=area;this.init=function(){var layoutObj=this;this.layoutWrapper=$("#ccm-layout-wrapper-"+this.cvalID);this.ccmControls=this.layoutWrapper.find("#ccm-layout-controls-"+this.cvalID);this.ccmControls.get(0).layoutObj=this;this.ccmControls.mouseover(function(){layoutObj.dontUpdateTwins=0;layoutObj.highlightAreas(1)});this.ccmControls.mouseout(function(){if(!layoutObj.moving){layoutObj.highlightAreas(0)}});this.ccmControls.find(".ccm-layout-menu-button").click(function(e){layoutObj.optionsMenu(e)});this.gridSizing()};this.highlightAreas=function(show){var els=this.layoutWrapper.find(".ccm-add-block");if(show){els.addClass("ccm-layout-area-highlight")}else{els.removeClass("ccm-layout-area-highlight")}};this.optionsMenu=function(e){ccm_hideMenus();e.stopPropagation();ccm_menuActivated=true;var aobj=document.getElementById("ccm-layout-options-menu-"+this.cvalID);if(!aobj){el=document.createElement("DIV");el.id="ccm-layout-options-menu-"+this.cvalID;el.className="ccm-menu ccm-ui";el.style.display="none";document.body.appendChild(el);aobj=$(el);aobj.css("position","absolute");var html='<div class="popover"><div class="arrow"></div><div class="inner"><div class="content">';html+="<ul>";html+='<li><a onclick="ccm_hideMenus()" class="ccm-menu-icon ccm-icon-edit-menu" dialog-title="'+ccmi18n.editAreaLayout+'" dialog-modal="false" dialog-width="550" dialog-height="280" dialog-append-buttons="true" id="menuEditLayout'+this.cvalID+'" href="'+CCM_TOOLS_PATH+"/edit_area_popup.php?cID="+CCM_CID+"&arHandle="+encodeURIComponent(this.area)+"&layoutID="+this.layout_id+"&cvalID="+this.cvalID+'&atask=layout">'+ccmi18n.editAreaLayout+"</a></li>";html+='<li><a onclick="ccm_hideMenus()" href="javascript:void(0)" class="ccm-menu-icon ccm-icon-move-up" id="menuAreaLayoutMoveUp'+this.cvalID+'">'+ccmi18n.moveLayoutUp+"</a></li>";html+='<li><a onclick="ccm_hideMenus()" href="javascript:void(0)" class="ccm-menu-icon ccm-icon-move-down" id="menuAreaLayoutMoveDown'+this.cvalID+'">'+ccmi18n.moveLayoutDown+"</a></li>";var lockText=(this.locked)?ccmi18n.unlockAreaLayout:ccmi18n.lockAreaLayout;html+='<li><a onclick="ccm_hideMenus()" href="javascript:void(0)" class="ccm-menu-icon ccm-icon-lock-menu" id="menuAreaLayoutLock'+this.cvalID+'">'+lockText+"</a></li>";html+='<li><a onclick="ccm_hideMenus()" href="javascript:void(0)" class="ccm-menu-icon ccm-icon-delete-menu" dialog-append-buttons="true" id="menuAreaLayoutDelete'+this.cvalID+'">'+ccmi18n.deleteLayout+"</a></li>";html+="</ul>";html+="</div></div></div>";aobj.append(html);var aJQobj=$(aobj);var layoutObj=this;aJQobj.find("#menuEditLayout"+this.cvalID).dialog();aJQobj.find("#menuAreaLayoutMoveUp"+this.cvalID).click(function(){layoutObj.moveLayout("up")});aJQobj.find("#menuAreaLayoutMoveDown"+this.cvalID).click(function(){layoutObj.moveLayout("down")});aJQobj.find("#menuAreaLayoutLock"+this.cvalID).click(function(){layoutObj.lock()});aJQobj.find("#menuAreaLayoutDelete"+this.cvalID).click(function(){layoutObj.deleteLayoutOptions()})}else{aobj=$("#ccm-layout-options-menu-"+this.cvalID)}ccm_fadeInMenu(aobj,e)};this.moveLayout=function(direction){this.moving=1;ccm_hideHighlighter();jQuery.fn.dialog.showLoader();this.highlightAreas(1);this.servicesAjax=$.ajax({url:CCM_TOOLS_PATH+"/layout_services/?cID="+CCM_CID+"&arHandle="+encodeURIComponent(this.area)+"&layoutID="+this.layout_id+"&cvalID="+this.cvalID+"&task=move&direction="+direction,success:function(response){eval("var jObj="+response);if(parseInt(jObj.success)!=1){alert(jObj.msg)}else{ccm_mainNavDisableDirectExit();location.reload()}}})};this.lock=function(lock,twinLock){var a=$("#menuAreaLayoutLock"+this.cvalID);this.locked=!this.locked;if(this.locked){a.html(ccmi18n.unlockAreaLayout);if(this.s){this.s.slider("disable")}}else{a.find("span").html(ccmi18n.lockAreaLayout);if(this.s){this.s.slider("enable")}}var lock=(this.locked)?1:0;if(!twinLock){this.servicesAjax=$.ajax({url:CCM_TOOLS_PATH+"/layout_services/?cID="+CCM_CID+"&arHandle="+encodeURIComponent(this.area)+"&layoutID="+this.layout_id+"&task=lock&lock="+lock,success:function(response){eval("var jObj="+response);if(parseInt(jObj.success)!=1){alert(jObj.msg)}else{}}});this.getTwins();for(var i=0;i<this.layoutTwinObjs.length;i++){this.layoutTwinObjs[i].lock(lock,1)}}};this.hasBeenQuickSaved=0;this.quickSaveLayoutId=0;this.quickSave=function(){var breakPoints=this.ccmControls.find("#layout_col_break_points_"+this.cvalID).val().replace(/%/g,"");clearTimeout(this.secondSavePauseTmr);if(!this.hasBeenQuickSaved&&this.quickSaveInProgress){quickSaveLayoutObj=this;this.secondSavePauseTmr=setTimeout("quickSaveLayoutObj.quickSave()",100);return}this.quickSaveInProgress=1;var layoutObj=this;var modifyLayoutId=(this.quickSaveLayoutId)?this.quickSaveLayoutId:this.layout_id;this.quickSaveAjax=$.ajax({url:CCM_TOOLS_PATH+"/layout_services/?cID="+CCM_CID+"&arHandle="+encodeURIComponent(this.area)+"&layoutID="+modifyLayoutId+"&task=quicksave&breakpoints="+encodeURIComponent(breakPoints),success:function(response){eval("var jObj="+response);if(parseInt(jObj.success)!=1){alert(jObj.msg)}else{layoutObj.hasBeenQuickSaved=1;layoutObj.quickSaveInProgress=0;if(jObj.layoutID){layoutObj.quickSaveLayoutId=jObj.layoutID}ccm_mainNavDisableDirectExit()}}})};this.deleteLayoutOptions=function(){var hasBlocks=0;deleteLayoutObj=this;this.layoutWrapper.find(".ccm-block").each(function(i,el){if(el.style.display!="none"){hasBlocks=1}});var dialogHeight=(hasBlocks)?"135px":"70px";$.fn.dialog.open({title:ccmi18n.deleteLayoutOptsTitle,href:CCM_TOOLS_PATH+"/layout_services/?cID="+CCM_CID+"&arHandle="+encodeURIComponent(this.area)+"&layoutID="+this.layout_id+"&task=deleteOpts&hasBlocks="+hasBlocks,width:"340px",modal:false,appendButtons:true,height:dialogHeight})};this.deleteLayout=function(deleteBlocks){ccm_hideMenus();jQuery.fn.dialog.closeTop();this.layoutWrapper.slideUp(300);jQuery.fn.dialog.showLoader();var cvalID=this.cvalID;this.servicesAjax=$.ajax({url:CCM_TOOLS_PATH+"/layout_services/?cID="+CCM_CID+"&arHandle="+encodeURIComponent(this.area)+"&layoutID="+this.layout_id+"&task=delete&deleteBlocks="+parseInt(deleteBlocks),success:function(response){eval("var jObj="+response);if(parseInt(jObj.success)!=1){alert(jObj.msg);jQuery.fn.dialog.hideLoader()}else{$("#ccm-layout-wrapper-"+cvalID).remove();ccm_hideHighlighter();ccm_mainNavDisableDirectExit();if(jObj.refreshPage){window.location=window.location}else{jQuery.fn.dialog.hideLoader()}}}})};this.gridSizing=function(){this.ccmGrid=$("#ccm-layout-"+this.layout_id);var cols=parseInt(this.ccmControls.find(".layout_column_count").val());if(cols>1){var startPoints=this.ccmControls.find("#layout_col_break_points_"+this.cvalID).val().replace(/%/g,"").split("|");this.s=this.ccmControls.find(".ccm-layout-controls-slider");this.s.get(0).layoutObj=this;this.s.get(0).ccmGrid=this.ccmGrid;this.s.slider({step:1,values:startPoints,change:function(){if(this.layoutObj.dontUpdateTwins){return}this.layoutObj.resizeGrid(this.childNodes);var breakPoints=[];for(var z=0;z<this.childNodes.length;z++){breakPoints.push(parseFloat(this.childNodes[z].style.left.replace("%","")))}breakPoints.sort(function(a,b){return(a-b)});this.layoutObj.ccmControls.find(".layout_col_break_points").val(breakPoints.join("%|")+"%");this.layoutObj.quickSave();ccm_arrangeMode=0;this.layoutObj.moving=0;this.layoutObj.highlightAreas(0)},slide:function(){ccm_arrangeMode=1;this.layoutObj.moving=1;if(this.layoutObj.dontUpdateTwins){return}this.layoutObj.resizeGrid(this.childNodes)}});if(parseInt(this.ccmControls.find(".layout_locked").val())){this.s.slider("disable")}}};this.getTwins=function(){if(!this.layoutTwins){this.layoutTwins=$(".ccm-layout-controls-layoutID-"+this.layout_id).not(this.ccmControls);this.layoutTwinObjs=[];for(var q=0;q<this.layoutTwins.length;q++){this.layoutTwinObjs.push(this.layoutTwins[q].layoutObj);this.layoutTwins[q].handles=$(this.layoutTwins[q]).find(".ui-slider-handle")}}return this.layoutTwins};this.resizeGrid=function(childNodes){var positions=[];this.getTwins();for(var y=0;y<childNodes.length;y++){var pos=parseFloat(childNodes[y].style.left.replace("%",""));positions.push(pos);if(!this.dontUpdateTwins){for(var w=0;w<this.layoutTwinObjs.length;w++){this.layoutTwinObjs[w].dontUpdateTwins=1;this.layoutTwinObjs[w].s.slider("values",y,pos)}}}positions.sort(function(a,b){return(a-b)});var prevW=0;var i;for(i=0;i<positions.length;i++){var pos=positions[i];var w=pos-prevW;prevW+=w;$(".ccm-layout-"+this.layout_id+"-col-"+(i+1)).css("width",w+"%");if(!this.dontUpdateTwins){for(j=0;j<this.layoutTwins.length;j++){this.layoutTwins[j].handles[i].style.left=pos+"%"}}}$(".ccm-layout-"+this.layout_id+"-col-"+(i+1)).css("width",(100-prevW)+"%")}}var quickSaveLayoutObj;var deleteLayoutObj;var ccmLayoutEdit={init:function(){this.showPresetDeleteIcon();$("#ccmLayoutPresentIdSelector").change(function(){var b=parseInt($(this).val());var c=$("#ccmAreaLayoutForm_layoutID").val();jQuery.fn.dialog.showLoader();if(b>0){var a=$("#ccm-layout-refresh-action").val()+"&lpID="+b}else{var a=$("#ccm-layout-refresh-action").val()+"&layoutID="+c}$.get(a,function(d){$("#ccm-layout-edit-wrapper").html(d);jQuery.fn.dialog.hideLoader();ccmLayoutEdit.showPresetDeleteIcon()})});$("#layoutPresetActionNew input[name=layoutPresetAction]").click(function(){if($(this).val()=="create_new_preset"&&$(this).prop("checked")){$("input[name=layoutPresetName]").attr("disabled",false).focus()}else{$("input[name=layoutPresetName]").val("").attr("disabled",true)}});$("#layoutPresetActions input[name=layoutPresetAction]").click(function(){if($(this).val()=="create_new_preset"&&$(this).prop("checked")){$("input[name=layoutPresetNameAlt]").attr("disabled",false).focus()}else{$("input[name=layoutPresetNameAlt]").val("").attr("disabled",true)}});if($("#layoutPresetActions").length>0){$("#ccmLayoutConfigOptions input, #ccmLayoutConfigOptions select").bind("change click",function(){$("#layoutPresetActions").show();$("#layoutPresetActionNew").hide();$("#ccmLayoutConfigOptions input, #ccmLayoutConfigOptions select").unbind("change click")})}},showPresetDeleteIcon:function(){if($("#ccmLayoutPresentIdSelector").val()>0){$("#ccm-layout-delete-preset").show()}else{$("#ccm-layout-delete-preset").hide()}},deletePreset:function(){var lpID=parseInt($("#ccmLayoutPresentIdSelector").val());if(lpID>0){if(!confirm(ccmi18n.confirmLayoutPresetDelete)){return false}jQuery.fn.dialog.showLoader();var area=$("#ccmAreaLayoutForm_arHandle").val();var url=CCM_TOOLS_PATH+"/layout_services/?cID="+CCM_CID+"&arHandle="+encodeURIComponent(area)+"&task=deletePreset&lpID="+lpID;$.get(url,function(r){eval("var jObj="+r);if(parseInt(jObj.success)!=1){alert(jObj.msg)}else{$("#ccmLayoutPresentIdSelector option[value='"+lpID+"']").remove()}jQuery.fn.dialog.hideLoader()})}}};$.widget.bridge("jqdialog",$.ui.dialog);jQuery.fn.dialog=function(){if(arguments.length>0){$(this).jqdialog(arguments[0],arguments[1],arguments[2]);return}else{if($(this).is("div")){$(this).jqdialog();return}}return $(this).each(function(){$(this).unbind("click.make-dialog").bind("click.make-dialog",function(k){var d=$(this).attr("href");var f=$(this).attr("dialog-width");var a=$(this).attr("dialog-height");var l=$(this).attr("dialog-title");var c=$(this).attr("dialog-on-open");var g=$(this).attr("dialog-on-destroy");var b=$(this).attr("dialog-on-close");obj={modal:true,href:d,width:f,height:a,title:l,onOpen:c,onDestroy:g,onClose:b};jQuery.fn.dialog.open(obj);return false})})};jQuery.fn.dialog.close=function(a){a++;$("#ccm-dialog-content"+a).jqdialog("close")};jQuery.fn.dialog.open=function(obj){jQuery.fn.dialog.showLoader();if(ccm_uiLoaded){ccm_hideMenus()}var nd=$(".ui-dialog").length;nd++;$("body").append('<div id="ccm-dialog-content'+nd+'" style="display: none"></div>');if(typeof(obj.width)=="string"){if(obj.width.indexOf("%",0)>0){w=obj.width.replace("%","");w=$(window).width()*(w/100);w=w+50}else{w=parseInt(obj.width)+50}if(obj.height.indexOf("%",0)>0){h=obj.height.replace("%","");h=$(window).height()*(h/100);h=h+100}else{h=parseInt(obj.height)+100}}else{if(obj.width){w=parseInt(obj.width)+50;h=parseInt(obj.height)+100}else{w=550;h=400}}if(h>$(window).height()){h=$(window).height()}$("#ccm-dialog-content"+nd).jqdialog({modal:true,height:h,width:w,show:{effect:"fade",duration:150,easing:"easeInExpo"},escapeClose:true,title:obj.title,hide:{effect:"fade",duration:75,easing:"easeOutExpo"},open:function(){$("body").css("overflow","hidden")},beforeClose:function(){$("body").css("overflow","auto")},close:function(ev,u){$(this).jqdialog("destroy").remove();$("#ccm-dialog-content"+nd).remove();if(typeof obj.onClose!="undefined"){if((typeof obj.onClose)=="function"){obj.onClose()}else{eval(obj.onClose)}}if(typeof obj.onDestroy!="undefined"){if((typeof obj.onDestroy)=="function"){obj.onDestroy()}else{eval(obj.onDestroy)}}nd--}});if(!obj.element){$.ajax({type:"GET",url:obj.href,success:function(r){jQuery.fn.dialog.hideLoader();$("#ccm-dialog-content"+nd).html(r);$("#ccm-dialog-content"+nd+" .dialog-launch").dialog();$("#ccm-dialog-content"+nd+" .ccm-dialog-close").click(function(){jQuery.fn.dialog.closeTop()});if($("#ccm-dialog-content"+nd+" .dialog-buttons").length>0){$("#ccm-dialog-content"+nd).jqdialog("option","buttons",[{}]);$("#ccm-dialog-content"+nd+" .dialog-buttons").appendTo($("#ccm-dialog-content"+nd).parent().find(".ui-dialog-buttonpane").addClass("ccm-ui"))}if($("#ccm-dialog-content"+nd+" .dialog-help").length>0){$("#ccm-dialog-content"+nd+" .dialog-help").hide();if(ccmi18n.helpPopup){var helpText=ccmi18n.helpPopup}else{var helpText="Help"}$("#ccm-dialog-content"+nd).parent().find(".ui-dialog-titlebar").append('<span class="ccm-dialog-help"><a href="javascript:void(0)" onclick="ccm_togglePopover(event, this)" title="'+helpText+'" id="ccm-menu-help">Help</a></span>');$("#ccm-menu-help").popover({content:function(){var id=$(this).attr("id")+"-content";return $("#"+id).html()},placement:"below",html:true,trigger:"manual"})}if(typeof obj.onOpen!="undefined"){if((typeof obj.onOpen)=="function"){obj.onOpen()}else{eval(obj.onOpen)}}}})}else{jQuery.fn.dialog.hideLoader();$("#ccm-dialog-content"+nd).append($(obj.element));if($(obj.element).css("display")=="none"){$(obj.element).show()}$("#ccm-dialog-content"+nd+" .dialog-launch").dialog();$("#ccm-dialog-content"+nd+" .ccm-dialog-close").click(function(){jQuery.fn.dialog.closeTop()});if(typeof obj.onOpen!="undefined"){if((typeof obj.onOpen)=="function"){obj.onOpen()}else{eval(obj.onOpen)}}}};jQuery.fn.dialog.replaceTop=function(a){var b=$(".ui-dialog").length;$("#ccm-dialog-content"+b).html(a)};jQuery.fn.dialog.showLoader=function(g){if(typeof(imgLoader)=="undefined"||!imgLoader||!imgLoader.src){return false}if($("#ccm-dialog-loader").length<1){$("body").append("<div id='ccm-dialog-loader-wrapper' class='ccm-ui'><img id='ccm-dialog-loader' src='"+imgLoader.src+"' /></div>")}if(g!=null){$("<div />").attr("id","ccm-dialog-loader-text").html(g).prependTo($("#ccm-dialog-loader-wrapper"))}var a=$("#ccm-dialog-loader-wrapper").width();var c=$("#ccm-dialog-loader-wrapper").height();var b=$(window).width();var e=$(window).height();var d=(b-a)/2;var f=(e-c)/2;$("#ccm-dialog-loader-wrapper").css("left",d+"px").css("top",f+"px");$("#ccm-dialog-loader-wrapper").show()};jQuery.fn.dialog.hideLoader=function(){$("#ccm-dialog-loader-wrapper").hide();$("#ccm-dialog-loader-text").remove()};jQuery.fn.dialog.closeTop=function(){var a=$(".ui-dialog").length;$("#ccm-dialog-content"+a).jqdialog("close")};jQuery.fn.dialog.closeAll=function(){$(".ui-dialog-content").jqdialog("close")};var imgLoader;var ccm_dialogOpen=0;jQuery.fn.dialog.loaderImage=CCM_IMAGE_PATH+"/throbber_white_32.gif";var ccmAlert={notice:function(c,b,a){$.fn.dialog.open({href:CCM_TOOLS_PATH+"/alert",title:c,width:320,height:160,modal:false,onOpen:function(){$("#ccm-popup-alert-message").html(b)},onDestroy:a})},hud:function(b,d,a,e){if($("#ccm-notification-inner").length==0){$(document.body).append('<div id="ccm-notification" class="ccm-ui"><div id="ccm-notification-inner"></div></div>')}if(a==null){a="edit_small"}if(e==null){var c=b}else{var c="<h3>"+e+"</h3>"+b}$("#ccm-notification-inner").html('<img id="ccm-notification-icon" src="'+CCM_IMAGE_PATH+"/icons/"+a+'.png" width="16" height="16" /><div id="ccm-notification-message">'+c+"</div>");$("#ccm-notification").show();if(d>0){setTimeout(function(){$("#ccm-notification").fadeOut({easing:"easeOutExpo",duration:300})},d)}}};$(document).ready(function(){imgLoader=new Image();imgLoader.src=jQuery.fn.dialog.loaderImage});ccm_closeNewsflow=function(a){$ovl=ccm_getNewsflowOverlayWindow();$ovl.fadeOut(300,"easeOutExpo");$(".ui-widget-overlay").fadeOut(300,"easeOutExpo",function(){$(this).remove()})};ccm_setNewsflowPagingArrowHeight=function(){if($("#ccm-marketplace-detail").length>0){var a=$("#ccm-marketplace-detail")}else{var a=$("#newsflow-main")}var b=a.height();$(".newsflow-paging-previous a, .newsflow-paging-next a").css("height",b+"px");$(".newsflow-paging-previous, .newsflow-paging-next").css("height",b+"px");$(".newsflow-paging-next").show();$(".newsflow-paging-previous").show()};ccm_setNewsflowOverlayDimensions=function(){if($("#newsflow-overlay").length>0){var a=$("#newsflow-overlay").width();var c=$(window).width();var e=$(window).height();var b=650;var f=e-80;if(f>b){h=b}else{h=f}$("#newsflow-overlay").css("height",b);var d=(c-a)/2;var g=(e-h)/2;g=g+29;d=d+"px";g=g+"px";$("#newsflow-overlay").css("left",d).css("top",g)}};ccm_getNewsflowOverlayWindow=function(){if($("#ccm-dashboard-content").length>0&&$("#newsflow-main").length>0&&$("#newsflow-overlay").length==0){var a=$("#newsflow-main").parent()}else{if($("#newsflow-overlay").length>0){var a=$("#newsflow-overlay")}else{var a=$("<div />").attr("id","newsflow-overlay").attr("class","ccm-ui").css("display","none").appendTo(document.body)}}return a};ccm_showNewsflowOverlayWindow=function(b,c){if($("#ccm-dashboard-content").length>0&&$("#newsflow-main").length>0){}else{if($(".ui-widget-overlay").length<1){var a=$('<div class="ui-widget-overlay"></div>').hide().appendTo("body")}$(".ui-widget-overlay").show()}$(window).resize(function(){ccm_setNewsflowOverlayDimensions()});$ovl=ccm_getNewsflowOverlayWindow();$ovl.load(b,function(){$ovl.hide();$(".newsflow-paging-next").hide();$(".newsflow-paging-previous").hide();$ovl.html($(this).html());if(c){c()}ccm_setNewsflowOverlayDimensions();ccm_setupTrickleUpNewsflowStyles();$ovl.fadeIn("300","easeOutExpo",function(){ccm_setNewsflowPagingArrowHeight()})})};ccm_setupTrickleUpNewsflowStyles=function(){ovl=ccm_getNewsflowOverlayWindow();ovl.find(".newsflow-em1").each(function(){$(this).parent().addClass("newsflow-em1")})};ccm_showDashboardNewsflowWelcome=function(){jQuery.fn.dialog.showLoader(ccmi18n.newsflowLoading);ccm_showNewsflowOverlayWindow(CCM_DISPATCHER_FILENAME+"/dashboard/home?_ccm_dashboard_external=1",function(){jQuery.fn.dialog.hideLoader()})};ccm_showNewsflowOffsite=function(a){jQuery.fn.dialog.showLoader();ccm_showNewsflowOverlayWindow(CCM_TOOLS_PATH+"/newsflow?cID="+a,function(){jQuery.fn.dialog.hideLoader()})};ccm_showAppIntroduction=function(){ccm_showNewsflowOverlayWindow(CCM_DISPATCHER_FILENAME+"/dashboard/welcome?_ccm_dashboard_external=1")};ccm_getNewsflowByPath=function(a){jQuery.fn.dialog.showLoader();ccm_showNewsflowOverlayWindow(CCM_TOOLS_PATH+"/newsflow?cPath="+a,function(){jQuery.fn.dialog.hideLoader()})};ccm_doPageReindexing=function(){$.get(CCM_TOOLS_PATH+"/reindex_pending_pages?ccm_token="+CCM_SECURITY_TOKEN)};String.prototype.score=function(m,d){d=d||0;if(m.length==0){return 0.9}if(m.length>this.length){return 0}for(var g=m.length;g>0;g--){var o=m.substring(0,g);var k=this.indexOf(o);if(k<0){continue}if(k+m.length>this.length+d){continue}var n=this.substring(k+o.length);var f=null;if(g>=m.length){f=""}else{f=m.substring(g)}var e=n.score(f,d+k);if(e>0){var a=this.length-n.length;if(k!=0){var b=0;var l=this.charCodeAt(k-1);if(l==32||l==9){for(var b=(k-2);b>=0;b--){l=this.charCodeAt(b);a-=((l==32||l==9)?1:0.15)}}else{a-=k}}a+=e*n.length;a/=this.length;return a}}return 0};ccm_openThemeLauncher=function(){jQuery.fn.dialog.closeTop();jQuery.fn.dialog.showLoader();ccm_testMarketplaceConnection(function(){$.fn.dialog.open({title:ccmi18n.community,href:CCM_TOOLS_PATH+"/marketplace/themes",width:"905",modal:false,height:"410"})},"open_theme_launcher")};ccm_testMarketplaceConnection=function(c,a,b){if(b){mpIDStr="&mpID="+b}else{mpIDStr=""}if(!a){a=""}params={mpID:b};$.getJSON(CCM_TOOLS_PATH+"/marketplace/connect",params,function(d){if(d.isConnected){c()}else{$.fn.dialog.open({title:ccmi18n.community,href:CCM_TOOLS_PATH+"/marketplace/frame?task="+a+mpIDStr,width:"90%",modal:false,height:"70%"});return false}})};ccm_openAddonLauncher=function(){jQuery.fn.dialog.closeTop();jQuery.fn.dialog.showLoader();ccm_testMarketplaceConnection(function(){$.fn.dialog.open({title:ccmi18n.community,href:CCM_TOOLS_PATH+"/marketplace/add-ons",width:"905",modal:false,height:"410"})},"open_addon_launcher")};ccm_setupMarketplaceDialogForm=function(){$(".ccm-pane-dialog-pagination").each(function(){$(this).closest(".ui-dialog-content").dialog("option","buttons",[{}]);$(this).closest(".ui-dialog").find(".ui-dialog-buttonpane .ccm-pane-dialog-pagination").remove();$(this).appendTo($(this).closest(".ui-dialog").find(".ui-dialog-buttonpane").addClass("ccm-ui"))});$(".ccm-pane-dialog-pagination a").click(function(){jQuery.fn.dialog.showLoader();$("#ccm-marketplace-browser-form").closest(".ui-dialog-content").load($(this).attr("href"),function(){jQuery.fn.dialog.hideLoader()});return false});ccm_marketplaceBrowserInit();$("#ccm-marketplace-browser-form").ajaxForm({beforeSubmit:function(){jQuery.fn.dialog.showLoader()},success:function(a){jQuery.fn.dialog.hideLoader();$("#ccm-marketplace-browser-form").closest(".ui-dialog-content").html(a)}})};ccm_marketplaceBrowserInit=function(){$(".ccm-marketplace-item").click(function(){ccm_getMarketplaceItemDetails($(this).attr("mpID"))});$(".ccm-marketplace-item-thumbnail").mouseover(function(){var b=$(this).parent().find("div.ccm-marketplace-results-image-hover").clone().addClass("ccm-marketplace-results-image-hover-displayed").appendTo(document.body);var c=$(this).offset().top;var a=$(this).offset().left;a=a+60;b.css("top",c).css("left",a);b.show()});$(".ccm-marketplace-item-thumbnail").mouseout(function(){$(".ccm-marketplace-results-image-hover-displayed").hide().remove()})};ccm_getMarketplaceItemDetails=function(a){jQuery.fn.dialog.showLoader();$("#ccm-intelligent-search-results").hide();ccm_testMarketplaceConnection(function(){$.fn.dialog.open({title:ccmi18n.community,href:CCM_TOOLS_PATH+"/marketplace/details?mpID="+a,width:820,appendButtons:true,modal:false,height:640,onOpen:function(){$("#ccm-marketplace-item-screenshots").nivoSlider({controlNav:false,effect:"fade",pauseOnHover:false,directionNav:false})}})},"get_item_details",a)};ccm_getMarketplaceItem=function(b){var c=b.mpID;var a=b.closeTop;this.onComplete=function(){};if(b.onComplete){ccm_getMarketplaceItem.onComplete=b.onComplete}if(a){jQuery.fn.dialog.closeTop()}jQuery.fn.dialog.showLoader();params={mpID:c};$.getJSON(CCM_TOOLS_PATH+"/marketplace/connect",params,function(d){jQuery.fn.dialog.hideLoader();if(d.isConnected){if(!d.purchaseRequired){$.fn.dialog.open({title:ccmi18n.community,href:CCM_TOOLS_PATH+"/marketplace/download?install=1&mpID="+c,width:350,appendButtons:true,modal:false,height:240})}else{$.fn.dialog.open({title:ccmi18n.communityCheckout,iframe:true,href:CCM_TOOLS_PATH+"/marketplace/checkout?mpID="+c,width:"560px",modal:false,height:"400px"})}}else{$.fn.dialog.open({title:ccmi18n.community,href:CCM_TOOLS_PATH+"/marketplace/frame?task=get&mpID="+c,width:"90%",modal:false,height:"70%"})}})};var ccm_searchActivatePostFunction=new Array();ccm_setupAdvancedSearchFields=function(a){ccm_totalAdvancedSearchFields=$(".ccm-search-request-field-set").length;$("#ccm-"+a+"-search-add-option").unbind();$("#ccm-"+a+"-search-add-option").click(function(){ccm_totalAdvancedSearchFields++;if($("#ccm-search-fields-wrapper").length>0){$("#ccm-search-fields-wrapper").append('<div class="ccm-search-field" id="ccm-'+a+"-search-field-set"+ccm_totalAdvancedSearchFields+'">'+$("#ccm-search-field-base").html()+"</div>")}else{$("#ccm-"+a+"-search-advanced-fields").append('<tr class="ccm-search-field" id="ccm-'+a+"-search-field-set"+ccm_totalAdvancedSearchFields+'">'+$("#ccm-search-field-base").html()+"</tr>")}ccm_activateAdvancedSearchFields(a,ccm_totalAdvancedSearchFields)});var b=1;$(".ccm-search-request-field-set").each(function(){ccm_activateAdvancedSearchFields(a,b);b++})};ccm_setupAdvancedSearch=function(a){ccm_setupAdvancedSearchFields(a);$("#ccm-"+a+"-advanced-search").ajaxForm({beforeSubmit:function(){ccm_deactivateSearchResults(a)},success:function(b){ccm_parseAdvancedSearchResponse(b,a)}});ccm_setupInPagePaginationAndSorting(a);ccm_setupSortableColumnSelection(a)};ccm_parseAdvancedSearchResponse=function(c,a){var b=$("#ccm-"+a+"-search-results");if(b.length==0||a==null){b=$("#ccm-search-results")}b.html(c);ccm_activateSearchResults(a)};ccm_deactivateSearchResults=function(a){var b=$("#ccm-"+a+"-search-fields-submit");if(b.length==0||a==null){b=$("#ccm-search-fields-submit")}b.attr("disabled",true);var b=$("#ccm-"+a+"-search-loading");if(b.length==0||a==null){b=$("#ccm-search-loading")}b.show()};ccm_activateSearchResults=function(a){if($(".ui-dialog-content").length==0){window.scrollTo(0,0)}else{$(".ui-dialog-content").each(function(c){$(this).get(0).scrollTop=0})}$(".dialog-launch").dialog();var b=$("#ccm-"+a+"-search-loading");if(b.length==0||a==null){b=$("#ccm-search-loading")}b.hide();var b=$("#ccm-"+a+"-search-fields-submit");if(b.length==0||a==null){b=$("#ccm-search-fields-submit")}b.attr("disabled",false);ccm_setupInPagePaginationAndSorting(a);ccm_setupSortableColumnSelection(a);if(typeof(ccm_searchActivatePostFunction[a])=="function"){ccm_searchActivatePostFunction[a]()}};ccm_setupInPagePaginationAndSorting=function(a){$(".ccm-results-list th a").click(function(){ccm_deactivateSearchResults(a);var b=$("#ccm-"+a+"-search-results");if(b.length==0){b=$("#ccm-search-results")}b.load($(this).attr("href"),false,function(){ccm_activateSearchResults(a)});return false});$("div.ccm-pagination a").click(function(){ccm_deactivateSearchResults(a);var b=$("#ccm-"+a+"-search-results");if(b.length==0){b=$("#ccm-search-results")}b.load($(this).attr("href"),false,function(){ccm_activateSearchResults(a);$("div.ccm-dialog-content").attr("scrollTop",0)});return false});$(".ccm-pane-dialog-pagination").each(function(){$(this).closest(".ui-dialog-content").dialog("option","buttons",[{}]);$(this).closest(".ui-dialog").find(".ui-dialog-buttonpane .ccm-pane-dialog-pagination").remove();$(this).appendTo($(this).closest(".ui-dialog").find(".ui-dialog-buttonpane").addClass("ccm-ui"))})};ccm_setupSortableColumnSelection=function(a){$("#ccm-list-view-customize").unbind();$("#ccm-list-view-customize").click(function(){jQuery.fn.dialog.open({width:550,height:350,appendButtons:true,modal:false,href:$(this).attr("href"),title:ccmi18n.customizeSearch});return false})};ccm_checkSelectedAdvancedSearchField=function(b,a){$("#ccm-"+b+"-search-field-set"+a+" .ccm-search-option-type-date_time input").each(function(){if($(this).attr("id")=="date_from"){$(this).attr("id","date_from"+a)}else{if($(this).attr("id")=="date_to"){$(this).attr("id","date_to"+a)}}});$("#ccm-"+b+"-search-field-set"+a+" .ccm-search-option-type-date_time input").each(function(){$(this).attr("id",$(this).attr("id")+a)});$("#ccm-"+b+"-search-field-set"+a+" .ccm-search-option-type-date_time input").datepicker({showAnim:"fadeIn"});$("#ccm-"+b+"-search-field-set"+a+" .ccm-search-option-type-rating input").rating()};ccm_activateAdvancedSearchFields=function(c,b){var a=$("#ccm-"+c+"-search-field-set"+b+" select:first");a.unbind();a.change(function(){var d=$(this).find(":selected").val();$(this).parent().parent().find("input.ccm-"+c+"-selected-field").val(d);var e=$("#ccm-"+c+"-search-field-base-elements span[search-field="+d+"]");$("#ccm-"+c+"-search-field-set"+b+" .ccm-selected-field-content").html("");e.clone().appendTo("#ccm-"+c+"-search-field-set"+b+" .ccm-selected-field-content");$("#ccm-"+c+"-search-field-set"+b+" .ccm-selected-field-content .ccm-search-option").show();ccm_checkSelectedAdvancedSearchField(c,b)});$("#ccm-"+c+"-search-field-set"+b+" .ccm-search-remove-option").unbind();$("#ccm-"+c+"-search-field-set"+b+" .ccm-search-remove-option").click(function(){$(this).parents("div.ccm-search-field").remove();$(this).parents("tr.ccm-search-field").remove()});ccm_checkSelectedAdvancedSearchField(c,b)};ccm_activateEditablePropertiesGrid=function(){$("tr.ccm-attribute-editable-field").each(function(){var a=$(this);$(this).find("a").click(function(){a.find(".ccm-attribute-editable-field-text").hide();a.find(".ccm-attribute-editable-field-clear-button").hide();a.find(".ccm-attribute-editable-field-form").show();a.find(".ccm-attribute-editable-field-save-button").show()});a.find("form").submit(function(){ccm_submitEditablePropertiesGrid(a);return false});a.find(".ccm-attribute-editable-field-save-button").parent().click(function(){ccm_submitEditablePropertiesGrid(a)});a.find(".ccm-attribute-editable-field-clear-button").parent().unbind();a.find(".ccm-attribute-editable-field-clear-button").parent().click(function(){a.find("form input[name=task]").val("clear_extended_attribute");ccm_submitEditablePropertiesGrid(a);return false})})};ccm_submitEditablePropertiesGrid=function(a){a.find(".ccm-attribute-editable-field-save-button").hide();a.find(".ccm-attribute-editable-field-clear-button").hide();a.find(".ccm-attribute-editable-field-loading").show();try{tinyMCE.triggerSave(true,true)}catch(b){}a.find("form").ajaxSubmit(function(c){a.find(".ccm-attribute-editable-field-loading").hide();a.find(".ccm-attribute-editable-field-save-button").show();a.find(".ccm-attribute-editable-field-text").html(c);a.find(".ccm-attribute-editable-field-form").hide();a.find(".ccm-attribute-editable-field-save-button").hide();a.find(".ccm-attribute-editable-field-text").show();a.find(".ccm-attribute-editable-field-clear-button").show();a.find("td").show("highlight",{color:"#FFF9BB"})})};var tr_activeNode=false;if(typeof(tr_doAnim)=="undefined"){var tr_doAnim=false}var tr_parseSubnodes=true;var tr_reorderMode=false;var tr_moveCopyMode=false;showPageMenu=function(f,d){ccm_hideMenus();d.stopPropagation();var a=$("#ccm-page-menu"+f.cID);if(!a.get(0)){el=document.createElement("DIV");el.id="ccm-page-menu"+f.cID;el.className="ccm-menu ccm-ui";el.style.display="block";el.style.visibility="hidden";document.body.appendChild(el);a=$("#ccm-page-menu"+f.cID);a.css("position","absolute");var b='<div class="popover"><div class="arrow"></div><div class="inner"><div class="content">';b+="<ul>";if(f.isTrash){b+='<li><a class="ccm-menu-icon ccm-icon-delete-menu" onclick="ccm_sitemapEmptyTrash('+f.instance_id+","+f.cID+')" href="javascript:void(0)">'+ccmi18n_sitemap.emptyTrash+"</a></li>"}else{if(f.inTrash){b+='<li><a class="ccm-menu-icon ccm-icon-search-pages" onclick="ccm_previewInternalTheme('+f.cID+", false, '"+ccmi18n_sitemap.previewPage+'\')" href="javascript:void(0)">'+ccmi18n_sitemap.previewPage+"</a></li>";b+='<li class="ccm-menu-separator"></li>';b+='<li><a class="ccm-menu-icon ccm-icon-delete-menu" onclick="ccm_sitemapDeleteForever('+f.instance_id+","+f.cID+')" href="javascript:void(0)">'+ccmi18n_sitemap.deletePageForever+"</a></li>"}else{if(f.cAlias=="LINK"||f.cAlias=="POINTER"){b+='<li><a class="ccm-menu-icon ccm-icon-visit" id="menuVisit'+f.cID+'" href="javascript:void(0)" onclick="window.location.href=\''+CCM_DISPATCHER_FILENAME+"?cID="+f.cID+"'\">"+ccmi18n_sitemap.visitExternalLink+"</a></li>";if(f.cAlias=="LINK"){b+='<li><a class="ccm-menu-icon ccm-icon-edit-external-link" dialog-width="350" dialog-height="170" dialog-title="'+ccmi18n_sitemap.editExternalLink+'" dialog-modal="false" dialog-append-buttons="true" id="menuLink'+f.cID+'" href="'+CCM_TOOLS_PATH+"/edit_collection_popup.php?rel=SITEMAP&cID="+f.cID+'&ctask=edit_external">'+ccmi18n_sitemap.editExternalLink+"</a></li>"}b+='<li><a class="ccm-menu-icon ccm-icon-delete-menu" dialog-append-buttons="true" id="menuDelete'+f.cID+'" dialog-width="320" dialog-height="100" dialog-modal="false" dialog-append-buttons="true" dialog-title="'+ccmi18n_sitemap.deleteExternalLink+'" href="'+CCM_TOOLS_PATH+"/edit_collection_popup.php?rel=SITEMAP&cID="+f.cID+"&display_mode="+f.display_mode+"&instance_id="+f.instance_id+"&select_mode="+f.select_mode+'&ctask=delete_external">'+ccmi18n_sitemap.deleteExternalLink+"</a></li>"}else{if(f.canWrite=="false"){b+='<li><a class="ccm-menu-icon ccm-icon-visit" id="menuVisit'+f.cID+'" href="'+CCM_DISPATCHER_FILENAME+"?cID="+f.cID+'">'+ccmi18n_sitemap.visitPage+"</a></li>"}else{b+='<li><a class="ccm-menu-icon ccm-icon-visit" id="menuVisit'+f.cID+'" href="'+CCM_DISPATCHER_FILENAME+"?cID="+f.cID+'">'+ccmi18n_sitemap.visitPage+"</a></li>";if(f.canCompose){b+='<li><a class="ccm-menu-icon ccm-icon-edit-in-composer-menu" id="menuComposer'+f.cID+'" href="'+CCM_DISPATCHER_FILENAME+"/dashboard/composer/write/-/edit/"+f.cID+'">'+ccmi18n_sitemap.editInComposer+"</a></li>"}b+='<li class="ccm-menu-separator"></li>';b+='<li><a class="ccm-menu-icon ccm-icon-properties-menu" dialog-width="640" dialog-height="360" dialog-append-buttons="true" dialog-modal="false" dialog-title="'+ccmi18n_sitemap.pagePropertiesTitle+'" id="menuProperties'+f.cID+'" href="'+CCM_TOOLS_PATH+"/edit_collection_popup.php?rel=SITEMAP&cID="+f.cID+'&ctask=edit_metadata">'+ccmi18n_sitemap.pageProperties+"</a></li>";b+='<li><a class="ccm-menu-icon ccm-icon-speed-settings-menu" dialog-width="550" dialog-height="280" dialog-append-buttons="true" dialog-modal="false" dialog-title="'+ccmi18n_sitemap.speedSettingsTitle+'" id="menuSpeedSettings'+f.cID+'" href="'+CCM_TOOLS_PATH+"/edit_collection_popup.php?rel=SITEMAP&cID="+f.cID+'&ctask=edit_speed_settings">'+ccmi18n_sitemap.speedSettings+"</a></li>";b+='<li><a class="ccm-menu-icon ccm-icon-permissions-menu" dialog-width="640" dialog-height="330" dialog-append-buttons="true" dialog-modal="false" dialog-title="'+ccmi18n_sitemap.setPagePermissions+'" id="menuPermissions'+f.cID+'" href="'+CCM_TOOLS_PATH+"/edit_collection_popup.php?rel=SITEMAP&cID="+f.cID+'&ctask=edit_permissions">'+ccmi18n_sitemap.setPagePermissions+"</a></li>";b+='<li><a class="ccm-menu-icon ccm-icon-design-menu" dialog-width="610" dialog-append-buttons="true" dialog-height="405" dialog-modal="false" dialog-title="'+ccmi18n_sitemap.pageDesign+'" id="menuDesign'+f.cID+'" href="'+CCM_TOOLS_PATH+"/edit_collection_popup.php?rel=SITEMAP&cID="+f.cID+'&ctask=set_theme">'+ccmi18n_sitemap.pageDesign+"</a></li>";b+='<li><a class="ccm-menu-icon ccm-icon-versions-menu" dialog-width="640" dialog-height="340" dialog-modal="false" dialog-title="'+ccmi18n_sitemap.pageVersions+'" id="menuVersions'+f.cID+'" href="'+CCM_TOOLS_PATH+"/versions.php?rel=SITEMAP&cID="+f.cID+'">'+ccmi18n_sitemap.pageVersions+"</a></li>";b+='<li><a class="ccm-menu-icon ccm-icon-delete-menu" dialog-append-buttons="true" id="menuDelete'+f.cID+'" dialog-width="360" dialog-height="150" dialog-modal="false" dialog-title="'+ccmi18n_sitemap.deletePage+'" href="'+CCM_TOOLS_PATH+"/edit_collection_popup.php?rel=SITEMAP&cID="+f.cID+"&display_mode="+f.display_mode+"&instance_id="+f.instance_id+"&select_mode="+f.select_mode+'&ctask=delete">'+ccmi18n_sitemap.deletePage+"</a></li>";b+='<li class="ccm-menu-separator"></li>';if(f.display_mode=="explore"||f.display_mode=="search"){b+='<li><a class="ccm-menu-icon ccm-icon-move-copy-menu" dialog-width="640" dialog-height="340" dialog-modal="false" dialog-title="'+ccmi18n_sitemap.moveCopyPage+'" id="menuMoveCopy'+f.cID+'" href="'+CCM_TOOLS_PATH+"/sitemap_overlay?instance_id="+f.instance_id+"&display_mode="+f.display_mode+"&select_mode=move_copy_delete&cID="+f.cID+'" id="menuMoveCopy'+f.cID+'">'+ccmi18n_sitemap.moveCopyPage+"</a></li>";if(f.display_mode=="explore"){b+='<li><a class="ccm-menu-icon ccm-icon-move-up" id="menuSendToStop'+f.cID+'" href="'+CCM_DISPATCHER_FILENAME+"/dashboard/sitemap/explore?cNodeID="+f.cID+'&task=send_to_top">'+ccmi18n_sitemap.sendToTop+"</a></li>";b+='<li><a class="ccm-menu-icon ccm-icon-move-down" id="menuSendToBottom'+f.cID+'" href="'+CCM_DISPATCHER_FILENAME+"/dashboard/sitemap/explore?cNodeID="+f.cID+'&task=send_to_bottom">'+ccmi18n_sitemap.sendToBottom+"</a></li>"}if(f.cNumChildren==0){b+='<li class="ccm-menu-separator"></li>'}}if(f.cNumChildren>0){var c=CCM_DISPATCHER_FILENAME+"/dashboard/sitemap/search/?selectedSearchField[]=parent&cParentAll=1&cParentIDSearchField="+f.cID;if(f.display_mode=="full"||f.display_mode==""||f.display_mode=="explore"){b+='<li><a class="ccm-menu-icon ccm-icon-search-pages" id="menuSearch'+f.cID+'" href="'+c+'">'+ccmi18n_sitemap.searchPages+"</a></li>"}if(f.display_mode!="explore"){b+='<li><a class="ccm-menu-icon ccm-icon-flat-view" id="menuExplore'+f.cID+'" href="'+CCM_DISPATCHER_FILENAME+"/dashboard/sitemap/explore/-/"+f.cID+'">'+ccmi18n_sitemap.explorePages+"</a></li>"}b+='<li class="ccm-menu-separator"></li>'}b+='<li><a class="ccm-menu-icon ccm-icon-add-page-menu" dialog-append-buttons="true" dialog-width="645" dialog-modal="false" dialog-height="345" dialog-title="'+ccmi18n_sitemap.addPage+'" id="menuSubPage'+f.cID+'" href="'+CCM_TOOLS_PATH+"/edit_collection_popup.php?rel=SITEMAP&mode="+f.display_mode+"&cID="+f.cID+'&ctask=add">'+ccmi18n_sitemap.addPage+"</a></li>";if(f.display_mode!="search"){b+='<li><a class="ccm-menu-icon ccm-icon-add-external-link-menu" dialog-width="350" dialog-modal="false" dialog-height="170" dialog-title="'+ccmi18n_sitemap.addExternalLink+'" dialog-modal="false" dialog-append-buttons="true" id="menuLink'+f.cID+'" href="'+CCM_TOOLS_PATH+"/edit_collection_popup.php?rel=SITEMAP&cID="+f.cID+'&ctask=add_external">'+ccmi18n_sitemap.addExternalLink+"</a></li>"}}}}}b+="</ul>";b+="</div></div></div>";a.append(b);$(a).find("a").bind("click.hide-menu",function(g){ccm_hideMenus()});$("#menuProperties"+f.cID).dialog();$("#menuSpeedSettings"+f.cID).dialog();$("#menuSubPage"+f.cID).dialog();$("#menuDesign"+f.cID).dialog();$("#menuLink"+f.cID).dialog();$("#menuVersions"+f.cID).dialog();$("#menuPermissions"+f.cID).dialog();$("#menuMoveCopy"+f.cID).dialog();$("#menuDelete"+f.cID).dialog()}else{a=$("#ccm-page-menu"+f.cID)}ccm_fadeInMenu(a,d)};hideBranch=function(a){$("#tree-node"+a).hide();$("#tree-dz"+a).hide()};cancelReorder=function(){if(tr_reorderMode){tr_reorderMode=false;$("li.tree-node").draggable("destroy");if(!tr_moveCopyMode){hideSitemapMessage()}}};searchSubPages=function(a){$("#ccm-tree-search-trigger"+a).hide();if(ccm_animEffects){$("#ccm-tree-search"+a).fadeIn(200,function(){$("#ccm-tree-search"+a+" input").get(0).focus()})}else{$("#ccm-tree-search"+a).show();$("#ccm-tree-search"+a+" input").get(0).focus()}};activateReorder=function(){tr_reorderMode=true;$("li.tree-node[draggable=true]").draggable({handle:"img.handle",opacity:0.5,revert:false,helper:"clone",start:function(){$(document.body).css("overflowX","hidden")},stop:function(){$(document.body).css("overflowX","auto")}});fixResortingDroppables()};deleteBranchFade=function(a){if(ccm_animEffects){$("#tree-node"+a).fadeOut(300,function(){$("#tree-node"+a).remove()});$("#tree-dz"+a).fadeOut(300,function(){$("#tree-dz"+a).remove()})}else{deleteBranchDirect(a)}};deleteBranchDirect=function(a){$("#tree-node"+a).remove();$("#tree-dz"+a).remove()};showBranch=function(a){var b=$("#tree-node"+a);$("#tree-node"+a).show();$("#tree-dz"+a).show()};rescanDisplayOrder=function(b){setLoading(b);var c="?foo=1";var a=$("#tree-root"+b).children("li.tree-node");for(i=0;i<a.length;i++){if($(a[i]).hasClass("ui-draggable-dragging")){continue}c+="&cID[]="+$(a[i]).attr("id").substring(9)}$.getJSON(CCM_TOOLS_PATH+"/dashboard/sitemap_update.php",c,function(d){ccm_parseJSON(d,function(){});removeLoading(b)})};var SITEMAP_LAST_DIALOGUE_URL="";var ccm_sitemap_html="";parseSitemapResponse=function(b,e,f,c,d){var a=$("ul[tree-root-node-id="+c+"][sitemap-instance-id="+b+"]");a.html(d);a.slideDown(150,"easeOutExpo")};selectMoveCopyTarget=function(n,d,l,a,f){if(!f){var f=CCM_CID}var g=ccmi18n_sitemap.moveCopyPage;var b=CCM_TOOLS_PATH+"/dashboard/sitemap_drag_request.php?instance_id="+n+"&display_mode="+d+"&select_mode="+l+"&origCID="+f+"&destCID="+a;var c=350;var m=350;try{if(CCM_NODE_ACTION=="<none>"){if(CCM_TARGET_ID!=""){$("#"+CCM_TARGET_ID).val(a)}$.fn.dialog.closeTop();return}if(CCM_NODE_ACTION!=""){b=CCM_NODE_ACTION+"?destCID="+a}if(CCM_DIALOG_TITLE!=""){g=CCM_DIALOG_TITLE}if(CCM_DIALOG_HEIGHT!=""){c=CCM_DIALOG_HEIGHT}if(CCM_DIALOG_WIDTH!=""){m=CCM_DIALOG_WIDTH}}catch(k){}$.fn.dialog.open({title:g,href:b,width:m,appendButtons:true,modal:false,height:c,onClose:function(){if(typeof(CCM_TARGET_ID)!="undefined"&&CCM_TARGET_ID!=""){$("#"+CCM_TARGET_ID).val(a)}if(tr_moveCopyMode==true){deactivateMoveCopy()}}})};selectLabel=function(e,node){var cNumChildren=node.attr("tree-node-children");if(node.attr("sitemap-select-mode")=="move_copy_delete"||tr_moveCopyMode==true){var destCID=node.attr("id").substring(10);var origCID=node.attr("selected-page-id");selectMoveCopyTarget(node.attr("sitemap-instance-id"),node.attr("sitemap-display-mode"),node.attr("sitemap-select-mode"),destCID,origCID)}else{if(node.attr("sitemap-select-mode")=="select_page"){var callback=node.parents("[sitemap-wrapper=1]").attr("sitemap-select-callback");if(callback==null||callback==""||typeof(callback)=="undefined"){callback="ccm_selectSitemapNode"}eval(callback+"(node.attr('id').substring(10), unescape(node.attr('tree-node-title')));");jQuery.fn.dialog.closeTop()}else{node.addClass("tree-label-selected");if(tr_activeNode!=false){if(tr_activeNode.attr("id")!=node.attr("id")){tr_activeNode.removeClass("tree-label-selected")}}params={cID:node.attr("id").substring(10),display_mode:node.attr("sitemap-display-mode"),isTrash:node.attr("tree-node-istrash"),inTrash:node.attr("tree-node-intrash"),select_mode:node.attr("sitemap-select-mode"),instance_id:node.attr("sitemap-instance-id"),canCompose:node.attr("tree-node-cancompose"),canWrite:node.attr("tree-node-canwrite"),cNumChildren:node.attr("tree-node-children"),cAlias:node.attr("tree-node-alias")};showPageMenu(params,e);tr_activeNode=node}}};ccmSitemapHighlightPageLabel=function(a,b){var c=$("#tree-label"+a+" > span");if(c.length==0){var c=$("tr.ccm-list-record[cID="+a+"]");if(c.length>0){$("#ccm-page-advanced-search").submit()}}else{if(b!=null){c.html(b)}}c.show("highlight")};activateLabels=function(c,b,d){var a=$("ul[sitemap-instance-id="+c+"]");a.find("div.tree-label span").unbind();a.find("div.tree-label span").click(function(f){selectLabel(f,$(this).parent())});a.find("ul[tree-root-state=closed]").each(function(){var e=$(this);var f=$(this).attr("tree-root-node-id");if($(this).find("li").length>0){e.attr("tree-root-state","open");$("#tree-collapse"+f).attr("src",CCM_IMAGE_PATH+"/dashboard/minus.jpg")}});if(d=="select_page"||d=="move_copy_delete"){a.find("li.ccm-sitemap-explore-paging a").each(function(){$(this).click(function(){var e=$(this).parentsUntil("ul").parent().attr("tree-root-node-id");jQuery.fn.dialog.showLoader();$.get($(this).attr("href"),function(f){parseSitemapResponse(c,b,d,e,f);activateLabels(c,b,d);jQuery.fn.dialog.hideLoader()});return false})})}if((b=="explore"||b=="full")&&(!d)){a.find("img.handle").addClass("moveable")}if(b=="full"&&(!d)){a.find("div.tree-label").droppable({accept:".tree-node",hoverClass:"on-drop",drop:function(m,l){var n=l.draggable;var k=$(this).attr("id").substring(10);var g=$(n).attr("id").substring(9);if(k==g){return false}var f=CCM_TOOLS_PATH+"/dashboard/sitemap_drag_request.php?instance_id="+c+"&origCID="+g+"&destCID="+k;if(SITEMAP_LAST_DIALOGUE_URL==f){return false}else{SITEMAP_LAST_DIALOGUE_URL=f}$.fn.dialog.open({title:ccmi18n_sitemap.moveCopyPage,href:f,width:350,modal:false,height:350,appendButtons:true,onClose:function(){showBranch(g)}})}});a.find("li.tree-node[draggable=true]").draggable({handle:"img.handle",opacity:0.5,revert:false,helper:"clone",start:function(){$(document.body).css("overflowX","hidden")},stop:function(){$(document.body).css("overflowX","auto")}})}};moveCopyAliasNode=function(f){var g=$("#origCID").val();var a=$("#destParentID").val();var c=$("#destCID").val();var k=$("input[name=ctask]:checked").val();var m=$("input[name=instance_id]").val();var d=$("input[name=display_mode]").val();var l=$("input[name=select_mode]").val();var e=$("input[name=copyAll]:checked").val();var b=$("input[name=saveOldPagePath]:checked").val();params={origCID:g,destCID:c,ctask:k,ccm_token:CCM_SECURITY_TOKEN,copyAll:e,saveOldPagePath:b};jQuery.fn.dialog.showLoader();$.getJSON(CCM_TOOLS_PATH+"/dashboard/sitemap_drag_request.php",params,function(n){ccm_parseJSON(n,function(){jQuery.fn.dialog.closeAll();jQuery.fn.dialog.hideLoader();ccmAlert.hud(n.message,2000);if(f==true){if(typeof(CCM_LAUNCHER_SITEMAP)!="undefined"){if(CCM_LAUNCHER_SITEMAP=="explore"){window.location.href=CCM_DISPATCHER_FILENAME+"/dashboard/sitemap/explore/-/"+c;return false}if(CCM_LAUNCHER_SITEMAP=="search"){ccm_deactivateSearchResults(CCM_SEARCH_INSTANCE_ID);$("#ccm-"+CCM_SEARCH_INSTANCE_ID+"-advanced-search").ajaxSubmit(function(o){ccm_parseAdvancedSearchResponse(o,CCM_SEARCH_INSTANCE_ID)})}}else{setTimeout(function(){window.location.href=CCM_DISPATCHER_FILENAME+"?cID="+n.cID},2000);return false}}switch(k){case"COPY":case"ALIAS":showBranch(g);break;case"MOVE":deleteBranchDirect(g);break}openSub(m,a,d,l,function(){openSub(m,c,d,l)});jQuery.fn.dialog.closeTop();jQuery.fn.dialog.closeTop()})})};toggleSub=function(b,c,d,e){ccm_hideMenus();var a=$("ul[tree-root-node-id="+c+"][sitemap-instance-id="+b+"]");if(a.attr("tree-root-state")=="closed"){openSub(b,c,d,e)}else{closeSub(b,c,d,e)}};ccm_sitemapEmptyTrash=function(b,a){setLoading(a);$.getJSON(CCM_TOOLS_PATH+"/dashboard/sitemap_empty_trash.php",function(c){ccm_parseJSON(c,function(){closeSub(b,a,"full","");removeLoading(a);var d=$("ul[tree-root-node-id="+a+"][sitemap-instance-id="+b+"]").parent();d.find("img.tree-plus").remove();d.find("span.ccm-sitemap-num-subpages").remove();ccmAlert.hud(c.message,2000)})})};ccm_sitemapDeleteForever=function(b,a){setLoading(a);params={cID:a};$.getJSON(CCM_TOOLS_PATH+"/dashboard/sitemap_delete_forever.php",params,function(c){ccm_parseJSON(c,function(){deleteBranchFade(a);ccmAlert.hud(c.message,2000)})})};ccm_sitemapRestoreDeletedPage=function(b,a){setLoading(a);params={cID:a};$.getJSON(CCM_TOOLS_PATH+"/dashboard/sitemap_restore_page.php",params,function(c){ccm_parseJSON(c,function(){if(c.targetCID){deleteBranchFade(a);openSub(b,c.targetCID,"full","")}ccmAlert.hud(c.message,2000)})})};setLoading=function(b){var a=$("#tree-node"+b);a.removeClass("tree-node-"+a.attr("tree-node-type"));a.addClass("tree-node-loading")};removeLoading=function(b){var a=$("#tree-node"+b);a.removeClass("tree-node-loading");a.addClass("tree-node-"+a.attr("tree-node-type"))};openSub=function(b,d,e,f,c){setLoading(d);var a=$("#tree-root"+d);cancelReorder();ccm_sitemap_html="";$.get(CCM_TOOLS_PATH+"/dashboard/sitemap_data.php?instance_id="+b+"&node="+d+"&display_mode="+e+"&select_mode="+f+"&selectedPageID="+a.attr("selected-page-id"),function(g){parseSitemapResponse(b,"full",f,d,g);activateLabels(b,"full",f);if(f!="move_copy_delete"&&f!="select_page"){activateReorder()}setTimeout(function(){removeLoading(d);if(c!=null){c()}},200)})};closeSub=function(b,c,d,e){var a=$("ul[tree-root-node-id="+c+"][sitemap-instance-id="+b+"]");if(tr_doAnim){setLoading(c);a.slideUp(150,"easeOutExpo",function(){removeLoading(c);a.attr("tree-root-state","closed");a.html("");$("#ccm-tree-search"+c).hide();$("#tree-collapse"+c).attr("src",CCM_IMAGE_PATH+"/dashboard/plus.jpg");a.removeClass("ccm-sitemap-search-results")})}else{a.hide();a.attr("tree-root-state","closed");a.removeClass("ccm-sitemap-search-results");$("#ccm-tree-search"+c).hide();$("#tree-collapse"+c).attr("src",CCM_IMAGE_PATH+"/dashboard/plus.jpg")}if(tr_moveCopyMode==true){$("#ccm-tree-search-trigger"+cID).show()}$.get(CCM_TOOLS_PATH+"/dashboard/sitemap_data.php?instance_id="+b+"&select_mode="+e+"&display_mode="+d+"&node="+c+"&display_mode=full&ctask=close-node")};toggleMove=function(){if($("#copyThisPage").get(0)){$("#copyThisPage").get(0).disabled=true;$("#copyChildren").get(0).disabled=true;$("#saveOldPagePath").attr("disabled",false)}};toggleAlias=function(){if($("#copyThisPage").get(0)){$("#copyThisPage").get(0).disabled=true;$("#copyChildren").get(0).disabled=true;$("#saveOldPagePath").attr("checked",false);$("#saveOldPagePath").attr("disabled","disabled")}};toggleCopy=function(){if($("#copyThisPage").get(0)){$("#copyThisPage").get(0).disabled=false;$("#copyThisPage").get(0).checked=true;$("#copyChildren").get(0).disabled=false;$("#saveOldPagePath").attr("checked",false);$("#saveOldPagePath").attr("disabled","disabled")}};showSitemapMessage=function(a){$("#ccm-sitemap-message").addClass("message");$("#ccm-sitemap-message").html(a);$("#ccm-sitemap-message").fadeIn(200)};hideSitemapMessage=function(){$("#ccm-sitemap-message").hide()};function fixResortingDroppables(){if(tr_reorderMode==false){return false}var a=$(".dropzone");for(var b=0;b<a.length;b++){var c=$(a[b]).attr("id").substr(7);if(c.indexOf("-sub")>0){c=c.substr(0,(c.length-4))}addResortDroppable(c)}}function addResortDroppable(a){if($(".tree-branch"+a).length<=1){return}$("div.tree-dz"+a).droppable({accept:".tree-branch"+a,activeClass:"dropzone-ready",hoverClass:"dropzone-active",drop:function(d,c){var b=c.draggable;$(b).insertAfter(this);var f=$(b).attr("id").substring(9);$("#tree-dz"+f).insertAfter($(b));rescanDisplayOrder($(this).attr("tree-parent"))}})}ccmSitemapExploreNode=function(d,c,e,a,b){jQuery.fn.dialog.showLoader();$.get(CCM_TOOLS_PATH+"/dashboard/sitemap_data.php",{instance_id:d,display_mode:c,select_mode:e,node:a,selectedPageID:b},function(f){parseSitemapResponse(d,"explore",e,0,f);activateLabels(d,"explore",e);jQuery.fn.dialog.hideLoader();ccm_sitemap_html=""})};ccmSitemapLoad=function(e,d,f,b,a,c){if(f=="move_copy_delete"||f=="select_page"){ccmSitemapExploreNode(e,d,f,b,a)}else{if(d=="full"){activateLabels(e,d,f);if(f!="move_copy_delete"&&f!="select_page"){activateReorder()}tr_doAnim=true;tr_parseSubnodes=false;ccm_sitemap_html=""}else{if(f!="move_copy_delete"&&f!="select_page"){$("ul[sitemap-instance-id="+e+"]").sortable({cursor:"move",items:"li[draggable=true]",opacity:0.5,stop:function(l){var g=$("ul[sitemap-instance-id="+e+"]").sortable("toArray");var k="";for(i=0;i<g.length;i++){if(g[i]!=""){k+="&cID[]="+g[i].substring(9)}}$.getJSON(CCM_TOOLS_PATH+"/dashboard/sitemap_update.php",k,function(m){ccm_parseJSON(m,function(){})})}})}activateLabels(e,d,f)}}if(c){c()}};ccm_sitemapSetupSearch=function(a){ccm_setupAdvancedSearch(a);ccm_sitemapSetupSearchPages(a);ccm_searchActivatePostFunction[a]=function(){ccm_sitemapSetupSearchPages(a);ccm_sitemapSearchSetupCheckboxes(a)};ccm_sitemapSearchSetupCheckboxes(a)};ccm_sitemapSearchSetupCheckboxes=function(a){$("#ccm-"+a+"-list-cb-all").click(function(b){b.stopPropagation();if($(this).prop("checked")==true){$(".ccm-list-record td.ccm-"+a+"-list-cb input[type=checkbox]").attr("checked",true);$("#ccm-"+a+"-list-multiple-operations").attr("disabled",false)}else{$(".ccm-list-record td.ccm-"+a+"-list-cb input[type=checkbox]").attr("checked",false);$("#ccm-"+a+"-list-multiple-operations").attr("disabled",true)}});$("td.ccm-"+a+"-list-cb input[type=checkbox]").click(function(b){b.stopPropagation();if($("td.ccm-"+a+"-list-cb input[type=checkbox]:checked").length>0){$("#ccm-"+a+"-list-multiple-operations").attr("disabled",false)}else{$("#ccm-"+a+"-list-multiple-operations").attr("disabled",true)}});$("#ccm-"+a+"-list-multiple-operations").change(function(){var b=$(this).val();cIDstring="";$("td.ccm-"+a+"-list-cb input[type=checkbox]:checked").each(function(){cIDstring=cIDstring+"&cID[]="+$(this).val()});switch(b){case"delete":jQuery.fn.dialog.open({width:500,height:400,modal:false,appendButtons:true,href:CCM_TOOLS_PATH+"/pages/delete?"+cIDstring+"&searchInstance="+a,title:ccmi18n_sitemap.deletePages});break;case"design":jQuery.fn.dialog.open({width:610,height:405,modal:false,appendButtons:true,href:CCM_TOOLS_PATH+"/pages/design?"+cIDstring+"&searchInstance="+a,title:ccmi18n_sitemap.pageDesign});break;case"move_copy":jQuery.fn.dialog.open({width:640,height:340,modal:false,href:CCM_TOOLS_PATH+"/sitemap_overlay?instance_id="+a+"&select_mode=move_copy_delete&"+cIDstring,title:ccmi18n_sitemap.moveCopyPage});break;case"speed_settings":jQuery.fn.dialog.open({width:610,height:340,modal:false,appendButtons:true,href:CCM_TOOLS_PATH+"/pages/speed_settings?"+cIDstring,title:ccmi18n_sitemap.speedSettingsTitle});break;case"properties":jQuery.fn.dialog.open({width:630,height:450,modal:false,href:CCM_TOOLS_PATH+"/pages/bulk_metadata_update?"+cIDstring,title:ccmi18n_sitemap.pagePropertiesTitle});break}$(this).get(0).selectedIndex=0})};ccm_sitemapSetupSearchPages=function(instance_id){$("#ccm-"+instance_id+"-list tr").click(function(e){var node=$(this);if(node.hasClass("ccm-results-list-header")){return false}if(node.attr("sitemap-select-mode")=="select_page"){var callback=node.attr("sitemap-select-callback");if(callback==null||callback==""||typeof(callback)=="undefined"){callback="ccm_selectSitemapNode"}eval(callback+"(node.attr('cID'), unescape(node.attr('cName')));");jQuery.fn.dialog.closeTop()}else{if(node.attr("sitemap-select-mode")=="move_copy_delete"){var destCID=node.attr("cID");var origCID=node.attr("selected-page-id");selectMoveCopyTarget(node.attr("sitemap-instance-id"),node.attr("sitemap-display-mode"),node.attr("sitemap-select-mode"),destCID,origCID)}else{params={cID:node.attr("cID"),select_mode:node.attr("sitemap-select-mode"),display_mode:node.attr("sitemap-display-mode"),instance_id:node.attr("sitemap-instance-id"),isTrash:node.attr("tree-node-istrash"),inTrash:node.attr("tree-node-intrash"),canCompose:node.attr("tree-node-cancompose"),canWrite:node.attr("canWrite"),cNumChildren:node.attr("cNumChildren"),cAlias:node.attr("cAlias")};showPageMenu(params,e)}}})};ccm_sitemapSelectDisplayMode=function(e,d,f,a){var b=$("ul[sitemap-instance-id="+e+"]");b.html("");b.attr("sitemap-display-mode",d);b.attr("sitemap-select-mode",f);b.attr("sitemap-display-mode",d);if(d=="explore"){var c=1}else{var c=0}ccmSitemapLoad(e,d,f,c,a,function(){if(d=="explore"){$("div[sitemap-wrapper=1][sitemap-instance-id="+e+"]").addClass("ccm-sitemap-explore")}else{$("div[sitemap-wrapper=1][sitemap-instance-id="+e+"]").removeClass("ccm-sitemap-explore")}});$.get(CCM_TOOLS_PATH+"/dashboard/sitemap_data.php?task=save_sitemap_display_mode&display_mode="+d)};ccm_sitemapDeletePages=function(a){$("#ccm-"+a+"-delete-form").ajaxSubmit(function(b){ccm_parseJSON(b,function(){jQuery.fn.dialog.closeTop();ccm_deactivateSearchResults(a);$("#ccm-"+a+"-advanced-search").ajaxSubmit(function(c){ccm_parseAdvancedSearchResponse(c,a)})})})};ccm_sitemapUpdateDesign=function(a){$("#ccm-"+a+"-design-form").ajaxSubmit(function(b){ccm_parseJSON(b,function(){jQuery.fn.dialog.closeTop();ccm_deactivateSearchResults(a);$("#ccm-"+a+"-advanced-search").ajaxSubmit(function(c){ccm_parseAdvancedSearchResponse(c,a)})})})};$(function(){$(document).click(function(){ccm_hideMenus();$("div.tree-label").removeClass("tree-label-selected")});$("#ccm-show-all-pages-cb").click(function(){var a=$(this).get(0).checked==true?1:0;$.get(CCM_TOOLS_PATH+"/dashboard/sitemap_data.php?show_system="+a,function(b){location.reload()})})});function ccm_previewInternalTheme(a,b,c){var d=$("input[name=ctID]").val();$.fn.dialog.open({title:c,href:CCM_TOOLS_PATH+"/themes/preview?themeID="+b+"&previewCID="+a+"&ctID="+d,width:"85%",modal:false,height:"75%"})}function ccm_previewMarketplaceTheme(a,c,d,b){var e=$("input[name=ctID]").val();$.fn.dialog.open({title:d,href:CCM_TOOLS_PATH+"/themes/preview?themeCID="+c+"&previewCID="+a+"&themeHandle="+encodeURIComponent(b)+"&ctID="+e,width:"85%",modal:false,height:"75%"})}ccm_marketplaceDetailShowMore=function(){$(".ccm-marketplace-item-information-more").hide();$(".ccm-marketplace-item-information-inner").css("max-height","none")};ccm_marketplaceUpdatesShowMore=function(a){$(a).parent().hide();$(a).parent().parent().find(".ccm-marketplace-update-changelog").css("max-height","none")};ccm_enableDesignScrollers=function(){$("a.ccm-scroller-l").hover(function(){$(this).find("img").attr("src",CCM_IMAGE_PATH+"/button_scroller_l_active.png")},function(){$(this).find("img").attr("src",CCM_IMAGE_PATH+"/button_scroller_l.png")});$("a.ccm-scroller-r").hover(function(){$(this).find("img").attr("src",CCM_IMAGE_PATH+"/button_scroller_r_active.png")},function(){$(this).find("img").attr("src",CCM_IMAGE_PATH+"/button_scroller_r.png")});var a=4;var b=132;$("a.ccm-scroller-r").unbind("click");$("a.ccm-scroller-l").unbind("click");$("a.ccm-scroller-r").click(function(){var f=$(this).parent().children("div.ccm-scroller-inner").children("ul");var e=$(this).parent().attr("current-page");var d=$(this).parent().attr("current-pos");var c=$(this).parent().attr("num-pages");var g=a*b;d=parseInt(d)-g;e++;$(this).parent().attr("current-page",e);$(this).parent().attr("current-pos",d);if(e==c){$(this).hide()}if(e>1){$(this).siblings("a.ccm-scroller-l").show()}$(f).css("left",d+"px")});$("a.ccm-scroller-l").click(function(){var f=$(this).parent().children("div.ccm-scroller-inner").children("ul");var e=$(this).parent().attr("current-page");var d=$(this).parent().attr("current-pos");var c=$(this).parent().attr("num-pages");var g=a*b;d=parseInt(d)+g;e--;$(this).parent().attr("current-page",e);$(this).parent().attr("current-pos",d);if(e==1){$(this).hide()}if(e<c){$(this).siblings("a.ccm-scroller-r").show()}$(f).css("left",d+"px")});$("a.ccm-scroller-l").hide();$("a.ccm-scroller-r").each(function(){if(parseInt($(this).parent().attr("num-pages"))==1){$(this).hide()}});$("#ccm-select-page-type a").click(function(){$("#ccm-select-page-type li").each(function(){$(this).removeClass("ccm-item-selected")});$(this).parent().addClass("ccm-item-selected");$("input[name=ctID]").val($(this).attr("ccm-page-type-id"))});$("#ccm-select-theme a").click(function(){$("#ccm-select-theme li").each(function(){$(this).removeClass("ccm-item-selected")});$(this).parent().addClass("ccm-item-selected");$("input[name=plID]").val($(this).attr("ccm-theme-id"))})};var ccm_editorCurrentAuxTool=false;ccm_editorSetupImagePicker=function(){tinyMCE.activeEditor.focus();var a=tinyMCE.activeEditor.selection.getBookmark();ccm_chooseAsset=function(d){var b=tinyMCE.activeEditor;b.selection.moveToBookmark(a);var c={};tinymce.extend(c,{src:d.filePathInline,alt:d.title,width:d.width,height:d.height});b.execCommand("mceInsertContent",false,'<img id="__mce_tmp" src="javascript:;" />',{skip_undo:1});b.dom.setAttribs("__mce_tmp",c);b.dom.setAttrib("__mce_tmp","id","");b.undoManager.add()};return false};ccm_editorSetupFilePicker=function(){tinyMCE.activeEditor.focus();var a=tinyMCE.activeEditor.selection.getBookmark();ccm_chooseAsset=function(d){var b=tinyMCE.activeEditor;b.selection.moveToBookmark(a);var e=b.selection.getContent();if(e!=""){b.execCommand("mceInsertLink",false,{href:d.filePath,title:d.title,target:null,"class":null})}else{var c='<a href="'+d.filePath+'">'+d.title+"</a>";tinyMCE.execCommand("mceInsertRawHTML",false,c,true)}};return false};ccm_editorSitemapOverlay=function(){tinyMCE.activeEditor.focus();var a=tinyMCE.activeEditor.selection.getBookmark();$.fn.dialog.open({title:ccmi18n_sitemap.choosePage,href:CCM_TOOLS_PATH+"/sitemap_overlay.php?sitemap_mode=select_page&callback=ccm_editorSelectSitemapNode",width:"550",modal:false,height:"400"});ccm_editorSelectSitemapNode=function(c,b){var d=tinyMCE.activeEditor;d.selection.moveToBookmark(a);var f=d.selection.getContent();var e=CCM_BASE_URL+CCM_DISPATCHER_FILENAME+"?cID="+c;if(f!=""){d.execCommand("mceInsertLink",false,{href:e,title:b,target:null,"class":null})}else{var f='<a href="'+CCM_BASE_URL+CCM_DISPATCHER_FILENAME+"?cID="+c+'" title="'+b+'">'+b+"</a>";tinyMCE.execCommand("mceInsertRawHTML",false,f,true)}}};$(function(){if($("#ccm-toolbar").length>0){ccm_intelligentSearchActivateResults();ccm_intelligentSearchDoRemoteCalls($("#ccm-nav-intelligent-search").val())}});var ccm_quickNavTimer=false;ccm_showQuickNav=function(a){clearTimeout(ccm_quickNavTimer);if($("#ccm-quick-nav").is(":visible")){if(typeof(a)=="function"){a()}}else{$("#ccm-quick-nav").fadeIn(120,"easeOutExpo",function(){if(typeof(a)=="function"){a()}})}};ccm_hideQuickNav=function(){if(!$("#ccm-quick-nav").hasClass("ccm-quick-nav-always")){$("#ccm-quick-nav").fadeOut(120,"easeInExpo");clearTimeout(ccm_quickNavTimer)}};ccm_togglePopover=function(b,a){if($("#twipsy-holder .popover").is(":visible")){$(a).popover("hide")}else{$(a).popover("show");b.stopPropagation();$(window).bind("click.popover",function(){$(a).popover("hide");$(window).unbind("click.popover")})}};ccm_toggleQuickNav=function(a,c){var b=$("#ccm-add-to-quick-nav");if(b.hasClass("ccm-icon-favorite-selected")){b.removeClass("ccm-icon-favorite-selected").addClass("ccm-icon-favorite")}else{b.removeClass("ccm-icon-favorite").addClass("ccm-icon-favorite-selected")}ccm_showQuickNav(function(){$.getJSON(CCM_TOOLS_PATH+"/dashboard/add_to_quick_nav",{cID:a,token:c},function(d){if(d.result=="add"){$("#ccm-quick-nav-favorites").append("<li />");var e=$("#ccm-quick-nav-favorites li:last-child");e.attr("id","ccm-quick-nav-page-"+a).css("display","none");var f=b.parent().parent().parent().find("h3");f.css("display","inline");e.html(d.link).css("visibility","hidden").show();f.effect("transfer",{to:e,easing:"easeOutExpo"},600,function(){e.hide().css("visibility","visible").fadeIn(240,"easeInExpo");f.css("display","block");ccm_quickNavTimer=setTimeout(function(){ccm_hideQuickNav()},1000)})}else{$("#ccm-quick-nav-page-"+a).fadeOut(240,"easeOutExpo");ccm_quickNavTimer=setTimeout(function(){ccm_hideQuickNav()},1000)}})})};var ccm_hideToolbarMenusTimer=false;ccm_hideToolbarMenus=function(){$(".ccm-system-nav-selected").removeClass("ccm-system-nav-selected");$(".ccm-system-nav-selected").removeClass("ccm-system-nav-selected");$("#ccm-edit-overlay").fadeOut(90,"easeOutExpo");$("#ccm-dashboard-overlay").fadeOut(90,"easeOutExpo");clearTimeout(ccm_hideToolbarMenusTimer)};ccm_activateToolbar=function(){if(!$("#ccm-quick-nav").hasClass("ccm-quick-nav-always")){$("#ccm-toolbar,#ccm-quick-nav").hover(function(){ccm_showQuickNav()},function(){ccm_quickNavTimer=setTimeout(function(){ccm_hideQuickNav()},1000)});$("#ccm-quick-nav").hoverIntent(function(){ccm_hideToolbarMenus();$("#ccm-intelligent-search-results").hide()},function(){})}$("#ccm-dashboard-overlay").css("visibility","visible").hide();$("#ccm-nav-intelligent-search-wrapper").click(function(){$("#ccm-nav-intelligent-search").focus()});$("#ccm-nav-intelligent-search").focus(function(){$(".ccm-system-nav-selected").removeClass("ccm-system-nav-selected");$(this).parent().addClass("ccm-system-nav-selected");if($("#ccm-dashboard-overlay").is(":visible")){$("#ccm-dashboard-overlay").fadeOut(90,"easeOutExpo");$(window).unbind("click.dashboard-nav")}});$(".ccm-nav-edit-mode-active").click(function(){void (0);return false});$("#ccm-edit-overlay,#ccm-dashboard-overlay").mouseover(function(){clearTimeout(ccm_hideToolbarMenusTimer)});$("#ccm-nav-dashboard").hoverIntent(function(){clearTimeout(ccm_hideToolbarMenusTimer);$(".ccm-system-nav-selected").removeClass("ccm-system-nav-selected");$(this).parent().addClass("ccm-system-nav-selected");$("#ccm-nav-intelligent-search").val("");$("#ccm-intelligent-search-results").fadeOut(90,"easeOutExpo");if($("#ccm-edit-overlay").is(":visible")){$("#ccm-edit-overlay").fadeOut(90,"easeOutExpo");$(window).unbind("click.ccm-edit")}$("#ccm-dashboard-overlay").fadeIn(160,"easeOutExpo");$(window).bind("click.dashboard-nav",function(){$(".ccm-system-nav-selected").removeClass("ccm-system-nav-selected");$("#ccm-dashboard-overlay").fadeOut(90,"easeOutExpo");$(window).unbind("click.dashboard-nav")});return false},function(){});$("#ccm-nav-dashboard,#ccm-dashboard-overlay,#ccm-nav-edit,#ccm-edit-overlay").mouseout(function(){ccm_hideToolbarMenusTimer=setTimeout(function(){ccm_hideToolbarMenus()},1500)});$("#ccm-nav-intelligent-search").bind("keydown.ccm-intelligent-search",function(d){if(d.keyCode==13||d.keyCode==40||d.keyCode==38){d.preventDefault();d.stopPropagation();if(d.keyCode==13&&$("a.ccm-intelligent-search-result-selected").length>0){var a=$("a.ccm-intelligent-search-result-selected").attr("href");if(!a||a=="#"||a=="javascript:void(0)"){$("a.ccm-intelligent-search-result-selected").click()}else{window.location.href=a}}var b=$("#ccm-intelligent-search-results li:visible");var c;if(d.keyCode==40||d.keyCode==38){$.each(b,function(e,f){if($(f).children("a").hasClass("ccm-intelligent-search-result-selected")){if(d.keyCode==38){io=b[e-1]}else{io=b[e+1]}c=$(io).find("a")}});if(c&&c.length>0){$("a.ccm-intelligent-search-result-selected").removeClass();$(c).addClass("ccm-intelligent-search-result-selected")}}}});$("#ccm-nav-intelligent-search").bind("keyup.ccm-intelligent-search",function(a){ccm_intelligentSearchDoRemoteCalls($(this).val())});$("#ccm-nav-intelligent-search").blur(function(){$(this).parent().removeClass("ccm-system-nav-selected")});$("#ccm-nav-intelligent-search").liveUpdate("ccm-intelligent-search-results","intelligent-search");$("#ccm-nav-intelligent-search").bind("click",function(a){if(this.value==""){$("#ccm-intelligent-search-results").hide()}});$("#ccm-toolbar-nav-properties").dialog();$("#ccm-toolbar-add-subpage").dialog();$("#ccm-toolbar-nav-versions").dialog();$("#ccm-toolbar-nav-design").dialog();$("#ccm-toolbar-nav-permissions").dialog();$("#ccm-toolbar-nav-speed-settings").dialog();$("#ccm-toolbar-nav-move-copy").dialog();$("#ccm-toolbar-nav-delete").dialog();$("#ccm-edit-overlay,#ccm-dashboard-overlay").click(function(a){a.stopPropagation()});$("#ccm-nav-edit").hoverIntent(function(){clearTimeout(ccm_hideToolbarMenusTimer);$(".ccm-system-nav-selected").removeClass("ccm-system-nav-selected");$(this).parent().addClass("ccm-system-nav-selected");$("#ccm-nav-intelligent-search").val("");$("#ccm-intelligent-search-results").fadeOut(90,"easeOutExpo");if($("#ccm-dashboard-overlay").is(":visible")){$("#ccm-dashboard-overlay").fadeOut(90,"easeOutExpo");$(window).unbind("click.dashboard-nav")}setTimeout("$('#ccm-check-in-comments').focus();",300);$("#ccm-check-in-preview").click(function(){$("#ccm-approve-field").val("PREVIEW");$("#ccm-check-in").submit()});$("#ccm-check-in-discard").click(function(){$("#ccm-approve-field").val("DISCARD");$("#ccm-check-in").submit()});$("#ccm-check-in-publish").click(function(){$("#ccm-approve-field").val("APPROVE");$("#ccm-check-in").submit()});var a=$(this).position().left;if(a>0){a=a-20}$("#ccm-edit-overlay").css("left",a+"px");$("#ccm-edit-overlay").fadeIn(160,"easeOutExpo",function(){$(this).find("a").click(function(){ccm_toolbarCloseEditMenu()})});$(window).bind("click.ccm-edit",function(){ccm_toolbarCloseEditMenu()});return false},function(){})};var ajaxtimer=null;var ajaxquery=null;ccm_toolbarCloseEditMenu=function(){$(".ccm-system-nav-selected").removeClass("ccm-system-nav-selected");$("#ccm-edit-overlay").fadeOut(90,"easeOutExpo");$(window).unbind("click.ccm-edit")};ccm_intelligentSearchActivateResults=function(){if($("#ccm-intelligent-search-results div:visible").length==0){$("#ccm-intelligent-search-results").hide()}$("#ccm-intelligent-search-results a").hover(function(){$("a.ccm-intelligent-search-result-selected").removeClass();$(this).addClass("ccm-intelligent-search-result-selected")},function(){$(this).removeClass("ccm-intelligent-search-result-selected")})};ccm_intelligentSearchDoRemoteCalls=function(a){a=jQuery.trim(a);if(!a){return}if(a.length>2){if(a==ajaxquery){return}if(ajaxtimer){window.clearTimeout(ajaxtimer)}ajaxquery=a;ajaxtimer=window.setTimeout(function(){ajaxtimer=null;$("#ccm-intelligent-search-results-list-marketplace").parent().show();$("#ccm-intelligent-search-results-list-help").parent().show();$("#ccm-intelligent-search-results-list-your-site").parent().show();$("#ccm-intelligent-search-results-list-marketplace").parent().addClass("ccm-intelligent-search-results-module-loading");$("#ccm-intelligent-search-results-list-help").parent().addClass("ccm-intelligent-search-results-module-loading");$("#ccm-intelligent-search-results-list-your-site").parent().addClass("ccm-intelligent-search-results-module-loading");$.getJSON(CCM_TOOLS_PATH+"/marketplace/intelligent_search",{q:ajaxquery},function(d){$("#ccm-intelligent-search-results-list-marketplace").parent().removeClass("ccm-intelligent-search-results-module-loading");$("#ccm-intelligent-search-results-list-marketplace").html("");for(i=0;i<d.length;i++){var c=d[i];var b="ccm_getMarketplaceItemDetails("+c.mpID+")";$("#ccm-intelligent-search-results-list-marketplace").append('<li><a href="javascript:void(0)" onclick="'+b+'"><img src="'+c.img+'" />'+c.name+"</a></li>")}if(d.length==0){$("#ccm-intelligent-search-results-list-marketplace").parent().hide()}if($(".ccm-intelligent-search-result-selected").length==0){$("#ccm-intelligent-search-results").find("li a").removeClass("ccm-intelligent-search-result-selected");$("#ccm-intelligent-search-results li:visible a:first").addClass("ccm-intelligent-search-result-selected")}ccm_intelligentSearchActivateResults()}).error(function(){$("#ccm-intelligent-search-results-list-marketplace").parent().hide()});$.getJSON(CCM_TOOLS_PATH+"/get_remote_help",{q:ajaxquery},function(c){$("#ccm-intelligent-search-results-list-help").parent().removeClass("ccm-intelligent-search-results-module-loading");$("#ccm-intelligent-search-results-list-help").html("");for(i=0;i<c.length;i++){var b=c[i];$("#ccm-intelligent-search-results-list-help").append('<li><a href="'+b.href+'">'+b.name+"</a></li>")}if(c.length==0){$("#ccm-intelligent-search-results-list-help").parent().hide()}if($(".ccm-intelligent-search-result-selected").length==0){$("#ccm-intelligent-search-results").find("li a").removeClass("ccm-intelligent-search-result-selected");$("#ccm-intelligent-search-results li:visible a:first").addClass("ccm-intelligent-search-result-selected")}ccm_intelligentSearchActivateResults()}).error(function(){$("#ccm-intelligent-search-results-list-help").parent().hide()});$.getJSON(CCM_TOOLS_PATH+"/pages/intelligent_search",{q:ajaxquery},function(c){$("#ccm-intelligent-search-results-list-your-site").parent().removeClass("ccm-intelligent-search-results-module-loading");$("#ccm-intelligent-search-results-list-your-site").html("");for(i=0;i<c.length;i++){var b=c[i];$("#ccm-intelligent-search-results-list-your-site").append('<li><a href="'+b.href+'">'+b.name+"</a></li>")}if(c.length==0){$("#ccm-intelligent-search-results-list-your-site").parent().hide()}if($(".ccm-intelligent-search-result-selected").length==0){$("#ccm-intelligent-search-results").find("li a").removeClass("ccm-intelligent-search-result-selected");$("#ccm-intelligent-search-results li:visible a:first").addClass("ccm-intelligent-search-result-selected")}ccm_intelligentSearchActivateResults()}).error(function(){$("#ccm-intelligent-search-results-list-your-site").parent().hide()})},500)}};var ccm_arrangeMode=false;var ccm_selectedDomID=false;var ccm_isBlockError=false;var ccm_activeMenu=false;var ccm_blockError=false;ccm_menuInit=function(a){if(CCM_EDIT_MODE&&(!CCM_ARRANGE_MODE)){switch(a.type){case"BLOCK":$("#b"+a.bID+"-"+a.aID).mouseover(function(b){ccm_activate(a,"#b"+a.bID+"-"+a.aID)});break;case"AREA":$("#a"+a.aID+"controls").mouseover(function(b){ccm_activate(a,"#a"+a.aID+"controls")});break}}};ccm_showBlockMenu=function(d,c){ccm_hideMenus();c.stopPropagation();ccm_activeMenu=true;var a=document.getElementById("ccm-block-menu"+d.bID+"-"+d.aID);if(!a){el=document.createElement("DIV");el.id="ccm-block-menu"+d.bID+"-"+d.aID;el.className="ccm-menu ccm-ui";el.style.display="block";el.style.visibility="hidden";document.body.appendChild(el);a=$("#ccm-block-menu"+d.bID+"-"+d.aID);a.css("position","absolute");var b='<div class="popover"><div class="arrow"></div><div class="inner"><div class="content">';b+="<ul>";if(d.canWrite&&d.hasEditDialog){b+=(d.editInline)?'<li><a class="ccm-menu-icon ccm-icon-edit-menu" onclick="ccm_hideMenus()" id="menuEdit'+d.bID+"-"+d.aID+'" href="'+CCM_DISPATCHER_FILENAME+"?cID="+d.cID+"&bID="+d.bID+"&arHandle="+encodeURIComponent(d.arHandle)+"&btask=edit#_edit"+d.bID+'">'+ccmi18n.editBlock+"</a></li>":'<li><a class="ccm-menu-icon ccm-icon-edit-menu" onclick="ccm_hideMenus()" dialog-title="'+ccmi18n.editBlock+" "+d.btName+'" dialog-append-buttons="true" dialog-modal="false" dialog-on-close="ccm_blockWindowAfterClose()" dialog-width="'+d.width+'" dialog-height="'+d.height+'" id="menuEdit'+d.bID+"-"+d.aID+'" href="'+CCM_TOOLS_PATH+"/edit_block_popup.php?cID="+d.cID+"&bID="+d.bID+"&arHandle="+encodeURIComponent(d.arHandle)+'&btask=edit">'+ccmi18n.editBlock+"</a></li>"}if(d.canWriteStack){b+='<li><a class="ccm-menu-icon ccm-icon-edit-menu" id="menuEdit'+d.bID+"-"+d.aID+'" href="'+CCM_DISPATCHER_FILENAME+"/dashboard/blocks/stacks/-/view_details/"+d.stID+'">'+ccmi18n.editStackContents+"</a></li>";b+='<li class="header"></li>'}if(d.canCopyToScrapbook){b+='<li><a class="ccm-menu-icon ccm-icon-clipboard-menu" id="menuAddToScrapbook'+d.bID+"-"+d.aID+'" href="#" onclick="javascript:ccm_addToScrapbook('+d.cID+","+d.bID+",'"+encodeURIComponent(d.arHandle)+"');return false;\">"+ccmi18n.copyBlockToScrapbook+"</a></li>"}if(d.canArrange){b+='<li><a class="ccm-menu-icon ccm-icon-move-menu" id="menuArrange'+d.bID+"-"+d.aID+'" href="javascript:ccm_arrangeInit()">'+ccmi18n.arrangeBlock+"</a></li>"}if(d.canDelete){b+='<li><a class="ccm-menu-icon ccm-icon-delete-menu" id="menuDelete'+d.bID+"-"+d.aID+'" href="#" onclick="javascript:ccm_deleteBlock('+d.cID+","+d.bID+","+d.aID+", '"+encodeURIComponent(d.arHandle)+"', '"+d.deleteMessage+"');return false;\">"+ccmi18n.deleteBlock+"</a></li>"}if(d.canDesign||d.canWrite){b+='<li class="ccm-menu-separator"></li>'}if(d.canDesign){b+='<li><a class="ccm-menu-icon ccm-icon-design-menu" onclick="ccm_hideMenus()" dialog-modal="false" dialog-title="'+ccmi18n.changeBlockBaseStyle+'" dialog-width="475" dialog-height="500" dialog-append-buttons="true" id="menuChangeCSS'+d.bID+"-"+d.aID+'" href="'+CCM_TOOLS_PATH+"/edit_block_popup.php?cID="+d.cID+"&bID="+d.bID+"&arHandle="+encodeURIComponent(d.arHandle)+'&btask=block_css&modal=true&width=300&height=100" title="'+ccmi18n.changeBlockCSS+'">'+ccmi18n.changeBlockCSS+"</a></li>"}if(d.canWrite){b+='<li><a class="ccm-menu-icon ccm-icon-custom-template-menu" onclick="ccm_hideMenus()" dialog-append-buttons="true" 	dialog-modal="false" dialog-title="'+ccmi18n.changeBlockTemplate+'" dialog-width="300" dialog-height="275" id="menuChangeTemplate'+d.bID+"-"+d.aID+'" href="'+CCM_TOOLS_PATH+"/edit_block_popup.php?cID="+d.cID+"&bID="+d.bID+"&arHandle="+encodeURIComponent(d.arHandle)+'&btask=template&modal=true&width=300&height=275" title="'+ccmi18n.changeBlockTemplate+'">'+ccmi18n.changeBlockTemplate+"</a></li>"}if(d.canModifyGroups||d.canAliasBlockOut||d.canSetupComposer){b+='<li class="ccm-menu-separator"></li>'}if(d.canModifyGroups){b+='<li><a title="'+ccmi18n.setBlockPermissions+'" onclick="ccm_hideMenus()" class="ccm-menu-icon ccm-icon-permissions-menu" dialog-width="400" dialog-height="390" id="menuBlockGroups'+d.bID+"-"+d.aID+'" href="'+CCM_TOOLS_PATH+"/edit_block_popup.php?cID="+d.cID+"&bID="+d.bID+"&arHandle="+encodeURIComponent(d.arHandle)+'&btask=groups" dialog-append-buttons="true" dialog-title="'+ccmi18n.setBlockPermissions+'">'+ccmi18n.setBlockPermissions+"</a></li>"}if(d.canAliasBlockOut){b+='<li><a class="ccm-menu-icon ccm-icon-setup-child-pages-menu" dialog-append-buttons="true" onclick="ccm_hideMenus()" dialog-width="550" dialog-height="450" id="menuBlockAliasOut'+d.bID+"-"+d.aID+'" href="'+CCM_TOOLS_PATH+"/edit_block_popup.php?cID="+d.cID+"&bID="+d.bID+"&arHandle="+encodeURIComponent(d.arHandle)+'&btask=child_pages" dialog-title="'+ccmi18n.setBlockAlias+'">'+ccmi18n.setBlockAlias+"</a></li>"}if(d.canSetupComposer){b+='<li><a class="ccm-menu-icon ccm-icon-setup-composer-menu" dialog-append-buttons="true" onclick="ccm_hideMenus()" dialog-width="300" dialog-modal="false" dialog-height="130" id="menuBlockSetupComposer'+d.bID+"-"+d.aID+'" href="'+CCM_TOOLS_PATH+"/edit_block_popup.php?cID="+d.cID+"&bID="+d.bID+"&arHandle="+encodeURIComponent(d.arHandle)+'&btask=composer" dialog-title="'+ccmi18n.setBlockComposerSettings+'">'+ccmi18n.setBlockComposerSettings+"</a></li>"}b+="</ul>";b+="</div></div></div>";a.append(b);if(d.canWrite&&(!d.editInline)){$("a#menuEdit"+d.bID+"-"+d.aID).dialog();$("a#menuChangeTemplate"+d.bID+"-"+d.aID).dialog()}if(d.canDesign){$("a#menuChangeCSS"+d.bID+"-"+d.aID).dialog()}if(d.canAliasBlockOut){$("a#menuBlockAliasOut"+d.bID+"-"+d.aID).dialog()}if(d.canSetupComposer){$("a#menuBlockSetupComposer"+d.bID+"-"+d.aID).dialog()}if(d.canModifyGroups){$("#menuBlockGroups"+d.bID+"-"+d.aID).dialog()}}else{a=$("#ccm-block-menu"+d.bID+"-"+d.aID)}ccm_fadeInMenu(a,c)};ccm_openAreaAddBlock=function(b,c,a){if(!c){c=0}if(!a){a=CCM_CID}$.fn.dialog.open({title:ccmi18n.blockAreaMenu,href:CCM_TOOLS_PATH+"/edit_area_popup.php?cID="+a+"&atask=add&arHandle="+b+"&addOnly="+c,width:550,modal:false,height:380})};ccm_showAreaMenu=function(f,d){var c=(f.addOnly)?1:0;ccm_activeMenu=true;if(d.shiftKey){ccm_openAreaAddBlock(f.arHandle,c)}else{d.stopPropagation();var a=document.getElementById("ccm-area-menu"+f.aID);if(!a){el=document.createElement("DIV");el.id="ccm-area-menu"+f.aID;el.className="ccm-menu ccm-ui";el.style.display="block";el.style.visibility="hidden";document.body.appendChild(el);a=$("#ccm-area-menu"+f.aID);a.css("position","absolute");var b='<div class="popover"><div class="arrow"></div><div class="inner"><div class="content">';b+="<ul>";if(f.canAddBlocks){b+='<li><a onclick="ccm_hideMenus()" class="ccm-menu-icon ccm-icon-add-block-menu" dialog-title="'+ccmi18n.addBlockNew+'" dialog-modal="false" dialog-width="550" dialog-height="380" id="menuAddNewBlock'+f.aID+'" href="'+CCM_TOOLS_PATH+"/edit_area_popup.php?cID="+CCM_CID+"&arHandle="+encodeURIComponent(f.arHandle)+"&atask=add&addOnly="+c+'">'+ccmi18n.addBlockNew+"</a></li>";b+='<li><a onclick="ccm_hideMenus()" class="ccm-menu-icon ccm-icon-add-stack-menu" dialog-title="'+ccmi18n.addBlockStack+'" dialog-modal="false" dialog-width="550" dialog-height="380" id="menuAddNewStack'+f.aID+'" href="'+CCM_TOOLS_PATH+"/edit_area_popup.php?cID="+CCM_CID+"&arHandle="+encodeURIComponent(f.arHandle)+"&atask=add_from_stack&addOnly="+c+'">'+ccmi18n.addBlockStack+"</a></li>";b+='<li><a onclick="ccm_hideMenus()" class="ccm-menu-icon ccm-icon-clipboard-menu" dialog-title="'+ccmi18n.addBlockPaste+'" dialog-modal="false" dialog-width="550" dialog-height="380" id="menuAddPaste'+f.aID+'" href="'+CCM_TOOLS_PATH+"/edit_area_popup.php?cID="+CCM_CID+"&arHandle="+encodeURIComponent(f.arHandle)+"&atask=paste&addOnly="+c+'">'+ccmi18n.addBlockPaste+"</a></li>"}if(f.canAddBlocks&&(f.canDesign||f.canLayout)){b+='<li class="ccm-menu-separator"></li>'}if(f.canLayout){b+='<li><a onclick="ccm_hideMenus()" class="ccm-menu-icon ccm-icon-add-layout-menu" dialog-title="'+ccmi18n.addAreaLayout+'" dialog-modal="false" dialog-width="400" dialog-height="300" dialog-append-buttons="true" id="menuAreaLayout'+f.aID+'" href="'+CCM_TOOLS_PATH+"/edit_area_popup.php?cID="+CCM_CID+"&arHandle="+encodeURIComponent(f.arHandle)+'&atask=layout">'+ccmi18n.addAreaLayout+"</a></li>"}if(f.canDesign){b+='<li><a onclick="ccm_hideMenus()" class="ccm-menu-icon ccm-icon-design-menu" dialog-title="'+ccmi18n.changeAreaCSS+'" dialog-modal="false" dialog-append-buttons="true" dialog-width="475" dialog-height="500" id="menuAreaStyle'+f.aID+'" href="'+CCM_TOOLS_PATH+"/edit_area_popup.php?cID="+CCM_CID+"&arHandle="+encodeURIComponent(f.arHandle)+'&atask=design">'+ccmi18n.changeAreaCSS+"</a></li>"}if(f.canWrite&&f.canModifyGroups){b+='<li class="ccm-menu-separator"></li>'}if(f.canModifyGroups){b+='<li><a onclick="ccm_hideMenus()" title="'+ccmi18n.setAreaPermissions+'" dialog-append-buttons="true" dialog-modal="false" class="ccm-menu-icon ccm-icon-permissions-menu" dialog-width="580" dialog-height="420" id="menuAreaGroups'+f.aID+'" href="'+CCM_TOOLS_PATH+"/edit_area_popup.php?cID="+CCM_CID+"&arHandle="+encodeURIComponent(f.arHandle)+'&atask=groups" dialog-title="'+ccmi18n.setAreaPermissions+'">'+ccmi18n.setAreaPermissions+"</a></li>"}b+="</ul>";b+="</div></div></div>";a.append(b);if(f.canAddBlocks){$("a#menuAddNewBlock"+f.aID).dialog();$("a#menuAddNewStack"+f.aID).dialog();$("a#menuAddPaste"+f.aID).dialog()}if(f.canWrite){$("a#menuAreaStyle"+f.aID).dialog();$("a#menuAreaLayout"+f.aID).dialog()}if(f.canModifyGroups){$("a#menuAreaGroups"+f.aID).dialog()}}else{a=$("#ccm-area-menu"+f.aID)}ccm_fadeInMenu(a,d)}};ccm_hideHighlighter=function(){$("#ccm-highlighter").css("display","none");$("div.ccm-menu-hotspot-active").removeClass("ccm-menu-hotspot-active")};ccm_addError=function(a){if(!ccm_isBlockError){ccm_blockError="";ccm_blockError+="<ul>"}ccm_isBlockError=true;ccm_blockError+="<li>"+a+"</li>"};ccm_resetBlockErrors=function(){ccm_isBlockError=false;ccm_blockError=""};ccm_addToScrapbook=function(a,c,b){ccm_mainNavDisableDirectExit();ccm_hideHighlighter();$.ajax({type:"POST",url:CCM_TOOLS_PATH+"/pile_manager.php",data:"cID="+a+"&bID="+c+"&arHandle="+b+"&btask=add&scrapbookName=userScrapbook",success:function(d){ccm_hideHighlighter();ccmAlert.hud(ccmi18n.copyBlockToScrapbookMsg,2000,"add",ccmi18n.copyBlockToScrapbook)}})};ccm_deleteBlock=function(a,c,d,b,e){if(confirm(e)){ccm_mainNavDisableDirectExit();ccm_hideHighlighter();$d=$("#b"+c+"-"+d);$d.hide();ccmAlert.hud(ccmi18n.deleteBlockMsg,2000,"delete_small",ccmi18n.deleteBlock);$.ajax({type:"POST",url:CCM_DISPATCHER_FILENAME,data:"cID="+a+"&ccm_token="+CCM_SECURITY_TOKEN+"&isAjax=true&btask=remove&bID="+c+"&arHandle="+b})}};ccm_hideMenus=function(){ccm_activeMenu=false;$("div.ccm-menu").hide();$("div.ccm-menu").css("visibility","hidden");$("div.ccm-menu").show()};ccm_parseBlockResponse=function(r,currentBlockID,task){try{r=r.replace(/(<([^>]+)>)/ig,"");resp=eval("("+r+")");if(resp.error==true){var message="<ul>";for(i=0;i<resp.response.length;i++){message+="<li>"+resp.response[i]+"</li>"}message+="</ul>";ccmAlert.notice(ccmi18n.error,message)}else{ccm_blockWindowClose();if(resp.cID){cID=resp.cID}else{cID=CCM_CID}var action=CCM_TOOLS_PATH+"/edit_block_popup?cID="+cID+"&bID="+resp.bID+"&arHandle="+encodeURIComponent(resp.arHandle)+"&btask=view_edit_mode";$.get(action,function(r){if(task=="add"){if($("#a"+resp.aID+" div.ccm-area-styles-a"+resp.aID).length>0){$("#a"+resp.aID+" div.ccm-area-styles-a"+resp.aID).append(r)}else{$("#a"+resp.aID).append(r)}}else{$("#b"+currentBlockID+"-"+resp.aID).before(r).remove()}jQuery.fn.dialog.hideLoader();ccm_mainNavDisableDirectExit();if(task=="add"){ccmAlert.hud(ccmi18n.addBlockMsg,2000,"add",ccmi18n.addBlock);jQuery.fn.dialog.closeAll()}else{ccmAlert.hud(ccmi18n.updateBlockMsg,2000,"success",ccmi18n.updateBlock)}if(typeof window.ccm_parseBlockResponsePost=="function"){ccm_parseBlockResponsePost(resp)}})}}catch(e){ccmAlert.notice(ccmi18n.error,r)}};ccm_mainNavDisableDirectExit=function(a){$("#ccm-exit-edit-mode-direct").hide();if(!a){$("#ccm-exit-edit-mode-comment").show()}};ccm_setupBlockForm=function(c,b,a){c.ajaxForm({type:"POST",iframe:true,beforeSubmit:function(){ccm_hideHighlighter();$("input[name=ccm-block-form-method]").val("AJAX");jQuery.fn.dialog.showLoader();return ccm_blockFormSubmit()},success:function(d){ccm_parseBlockResponse(d,b,a)}})};ccm_activate=function(b,a){if(ccm_arrangeMode||ccm_activeMenu){return false}if(ccm_selectedDomID){$(ccm_selectedDomID).removeClass("ccm-menu-hotspot-active")}aobj=$(a);aobj.addClass("ccm-menu-hotspot-active");ccm_selectedDomID=a;offs=aobj.offset();$("#ccm-highlighter").hide();$("#ccm-highlighter").css("width",aobj.outerWidth());$("#ccm-highlighter").css("height",aobj.outerHeight());$("#ccm-highlighter").css("top",offs.top);$("#ccm-highlighter").css("left",offs.left);$("#ccm-highlighter").fadeIn(120,"easeOutExpo");$("#ccm-highlighter").mouseout(function(c){if(!ccm_activeMenu){if(!c.target){ccm_hideHighlighter()}else{if($(c.toElement).parents("div.ccm-menu").length==0){ccm_hideHighlighter()}}}});$("#ccm-highlighter").unbind("click");$("#ccm-highlighter").click(function(c){switch(b.type){case"BLOCK":ccm_showBlockMenu(b,c);break;case"AREA":ccm_showAreaMenu(b,c);break}})};ccm_editInit=function(){document.write=function(){void (0)};$(document.body).append('<div style="position: absolute; display:none" id="ccm-highlighter">&nbsp;</div>');$(document).click(function(){ccm_hideMenus()});$("div.ccm-menu a").bind("click.hide-menu",function(a){ccm_hideMenus();return false})};ccm_triggerSelectUser=function(b,c,a){alert(b);alert(c);alert(a)};ccm_setupUserSearch=function(){$(".chosen-select").chosen();$("#ccm-user-list-cb-all").click(function(){if($(this).prop("checked")==true){$(".ccm-list-record td.ccm-user-list-cb input[type=checkbox]").attr("checked",true);$("#ccm-user-list-multiple-operations").attr("disabled",false)}else{$(".ccm-list-record td.ccm-user-list-cb input[type=checkbox]").attr("checked",false);$("#ccm-user-list-multiple-operations").attr("disabled",true)}});$("td.ccm-user-list-cb input[type=checkbox]").click(function(a){if($("td.ccm-user-list-cb input[type=checkbox]:checked").length>0){$("#ccm-user-list-multiple-operations").attr("disabled",false)}else{$("#ccm-user-list-multiple-operations").attr("disabled",true)}});$("#ccm-user-list-multiple-operations").change(function(){var a=$(this).val();switch(a){case"choose":var b="";$("td.ccm-user-list-cb input[type=checkbox]:checked").each(function(){ccm_triggerSelectUser($(this).val(),$(this).attr("user-name"),$(this).attr("user-email"))});jQuery.fn.dialog.closeTop();break;case"properties":uIDstring="";$("td.ccm-user-list-cb input[type=checkbox]:checked").each(function(){uIDstring=uIDstring+"&uID[]="+$(this).val()});jQuery.fn.dialog.open({width:630,height:450,modal:false,href:CCM_TOOLS_PATH+"/users/bulk_properties?"+uIDstring,title:ccmi18n.properties});break}$(this).get(0).selectedIndex=0})};ccm_triggerSelectGroup=function(b,a){alert(b);alert(a)};ccm_setupGroupSearchPaging=function(){$("div#ccm-group-paging").each(function(){$(this).closest(".ui-dialog-content").dialog("option","buttons",[{}]);$(this).closest(".ui-dialog").find(".ui-dialog-buttonpane .ccm-pane-dialog-pagination").remove();$(this).appendTo($(this).closest(".ui-dialog").find(".ui-dialog-buttonpane").addClass("ccm-ui"))})};ccm_setupGroupSearch=function(){$("div.ccm-group a").unbind();$("div.ccm-group a").each(function(b){var a=$(this);$(this).click(function(){ccm_triggerSelectGroup(a.attr("group-id"),a.attr("group-name"));$.fn.dialog.closeTop();return false})});$("#ccm-group-search").ajaxForm({beforeSubmit:function(){$("#ccm-group-search-wrapper").html("")},success:function(a){$("#ccm-group-search-wrapper").html(a)}});ccm_setupGroupSearchPaging();$("div#ccm-group-paging a").click(function(){$("#ccm-group-search-wrapper").html("");$.ajax({type:"GET",url:$(this).attr("href"),success:function(a){$("#ccm-group-search-wrapper").html(a)}});return false})};ccm_saveArrangement=function(a){if(!a){a=CCM_CID}ccm_mainNavDisableDirectExit();var b="";$("div.ccm-area").each(function(){areaStr="&area["+$(this).attr("id").substring(1)+"][]=";bArray=$(this).sortable("toArray");for(i=0;i<bArray.length;i++){if(bArray[i]!=""&&bArray[i].substring(0,1)=="b"){var c=bArray[i].substring(1,bArray[i].indexOf("-"));var d=$("#"+bArray[i]);if(d.attr("custom-style")){c+="-"+d.attr("custom-style")}b+=areaStr+c}}});$.ajax({type:"POST",url:CCM_DISPATCHER_FILENAME,data:"cID="+a+"&ccm_token="+CCM_SECURITY_TOKEN+"&btask=ajax_do_arrange"+b,success:function(c){$("div.ccm-area").removeClass("ccm-move-mode");$("div.ccm-block-arrange").each(function(){$(this).addClass("ccm-block");$(this).removeClass("ccm-block-arrange")});ccm_arrangeMode=false;$(".ccm-main-nav-edit-option").fadeIn(300);ccmAlert.hud(ccmi18n.arrangeBlockMsg,2000,"up_down",ccmi18n.arrangeBlock)}})};ccm_arrangeInit=function(){ccm_arrangeMode=true;ccm_hideHighlighter();$("div.ccm-block").each(function(){$(this).addClass("ccm-block-arrange");$(this).removeClass("ccm-block")});$(".ccm-main-nav-edit-option").fadeOut(300,function(){$(".ccm-main-nav-arrange-option").fadeIn(300)});$("div.ccm-area").each(function(){var a=$(this).attr("cID");$(this).addClass("ccm-move-mode");$(this).sortable({items:"div.ccm-block-arrange",connectWith:$("div.ccm-area"),accept:"div.ccm-block-arrange",opacity:0.5,stop:function(){ccm_saveArrangement(a)}})})};if(typeof(ccm_selectSitemapNode)!="function"){ccm_selectSitemapNode=function(b,a){alert(b);alert(a)}}ccm_goToSitemapNode=function(b,a){window.location.href=CCM_DISPATCHER_FILENAME+"?cID="+b};ccm_fadeInMenu=function(b,d){var c=b.find("div.popover div.inner").width();var a=b.find("div.popover").height();b.hide();b.css("visibility","visible");var g=d.pageX+2;var f=d.pageY+2;if($(window).height()<d.clientY+a){f=f-a-10;g=g-(c/2);b.find("div.popover").removeClass("below");b.find("div.popover").addClass("above")}else{g=g-(c/2);f=f+10;b.find("div.popover").removeClass("above");b.find("div.popover").addClass("below")}b.css("top",f+"px");b.css("left",g+"px");b.fadeIn(60)};ccm_blockWindowClose=function(){jQuery.fn.dialog.closeTop();ccm_blockWindowAfterClose()};ccm_blockWindowAfterClose=function(){ccmValidateBlockForm=function(){return true}};ccm_blockFormSubmit=function(){if(typeof window.ccmValidateBlockForm=="function"){r=window.ccmValidateBlockForm();if(!r){jQuery.fn.dialog.hideLoader()}if(ccm_isBlockError){if(ccm_blockError){ccmAlert.notice(ccmi18n.error,ccm_blockError+"</ul>")}ccm_resetBlockErrors();return false}}return true};ccm_paneToggleOptions=function(a){var b=$(a).parent().find("div.ccm-pane-options-content");if($(a).hasClass("ccm-icon-option-closed")){$(a).removeClass("ccm-icon-option-closed").addClass("ccm-icon-option-open");b.slideDown("fast","easeOutExpo")}else{$(a).removeClass("ccm-icon-option-open").addClass("ccm-icon-option-closed");b.slideUp("fast","easeOutExpo")}};ccm_setupGridStriping=function(b){$("#"+b+" tr").removeClass();var a=0;$("#"+b+" tr").each(function(){if($(this).css("display")!="none"){if(a%2==0){$(this).addClass("ccm-row-alt")}a++}})};ccm_t=function(a){return $("input[name=ccm-string-"+a+"]").val()};var ccmCustomStyle={tabs:function(a,b){$(".ccm-styleEditPane").hide();$("#ccm-styleEditPane-"+b).show();$(a.parentNode.parentNode).find("li").removeClass("ccm-nav-active");$(a.parentNode).addClass("ccm-nav-active");return false},resetAll:function(){if(!confirm(ccmi18n.confirmCssReset)){return false}jQuery.fn.dialog.showLoader();$("#ccm-reset-style").val(1);$("#ccmCustomCssForm").get(0).submit();return true},showPresetDeleteIcon:function(){if($("select[name=cspID]").val()>0){$("#ccm-style-delete-preset").show()}else{$("#ccm-style-delete-preset").hide()}},deletePreset:function(){var b=$("select[name=cspID]").val();if(b>0){if(!confirm(ccmi18n.confirmCssPresetDelete)){return false}var a=$("#ccm-custom-style-refresh-action").val()+"&deleteCspID="+b+"&subtask=delete_custom_style_preset";jQuery.fn.dialog.showLoader();$.get(a,function(c){$("#ccm-custom-style-wrapper").html(c);jQuery.fn.dialog.hideLoader()})}},initForm:function(){if($("#cspFooterPreset").length>0){$("#ccmCustomCssFormTabs input, #ccmCustomCssFormTabs select, #ccmCustomCssFormTabs textarea").bind("change click",function(){$("#cspFooterPreset").show();$("#cspFooterNoPreset").remove();$("#ccmCustomCssFormTabs input, #ccmCustomCssFormTabs select").unbind("change click")})}$("input[name=cspPresetAction]").click(function(){if($(this).val()=="create_new_preset"&&$(this).prop("checked")){$("input[name=cspName]").attr("disabled",false).focus()}else{$("input[name=cspName]").val("").attr("disabled",true)}});ccmCustomStyle.showPresetDeleteIcon();ccmCustomStyle.lastPresetID=parseInt($("select[name=cspID]").val());$("select[name=cspID]").change(function(){var c=parseInt($(this).val());var b=parseInt($("input[name=selectedCsrID]").val());if(ccmCustomStyle.lastPresetID==c){return false}ccmCustomStyle.lastPresetID=c;jQuery.fn.dialog.showLoader();if(c>0){var a=$("#ccm-custom-style-refresh-action").val()+"&cspID="+c}else{var a=$("#ccm-custom-style-refresh-action").val()+"&csrID="+b}$.get(a,function(d){$("#ccm-custom-style-wrapper").html(d);jQuery.fn.dialog.hideLoader()})});$("#ccmCustomCssForm").submit(function(){if($("input[name=cspCreateNew]").prop("checked")==true){if($("input[name=cspName]").val()==""){$("input[name=cspName]").focus();alert(ccmi18n.errorCustomStylePresetNoName);return false}}jQuery.fn.dialog.showLoader();return true});if(!parseInt(ccmCustomStyle.lastPresetID)){setTimeout('$("#ccmCustomCssFormTabs input").attr("disabled", false).get(0).focus()',500)}},validIdCheck:function(a,c){var b=$("#"+a.value);if(b&&b.get(0)&&b.get(0).id!=c){$("#ccm-styles-invalid-id").css("display","block")}else{$("#ccm-styles-invalid-id").css("display","none")}}};